#+TITLE: SQL Relational Algebra

#+DESCRIPTION: Relational algebra offers an alternative syntax for crafting relational
#+DESCRIPTION: database queries.  I demonstrate how to use Python and Relational.py to 
#+DESCRIPTION: ces6/index.htmlreate relational database queries and translate them into SQL.
#+KEYWORDS: sql, relational algebra, python
#+STARTUP:  overview
#+PROPERTY: header-args :eval no-export :tangle no

#+DATE: [2016-09-01 Thu]

* Related                                                          :noexport:

[[wiki:index][Index]]

* Relational Algebra and SQL
The dominant language for writing relational database queries is SQL.
Unfortunately, SQL tends to get very complicated very quickly as the query's
complexity increases. Furthermore, SQL is far removed, syntactically, from much
of the theoretical basis of querying, [[https://en.wikipedia.org/wiki/Relational_algebra][relation algebra]]. For creating complicated
queries, it may be easier to prototype them in Python using modules from the
relational algebra program, [[https://ltworf.github.io/relational/][Relational]]. I forked the code on [[https://github.com/dwhoman/relational][GitHub]] and added
additional operators as well as code to interface with [[https://www.gnu.org/software/emacs/][Emacs]] [[http://orgmode.org/][Org Mode]] [[http://orgmode.org/worg/org-contrib/babel/][Babel]].
Also required to run the examples is the [[https://github.com/lerocha/chinook-database][Chinook]] database and a [[https://github.com/dwhoman/chinook-database/tree/master/ChinookDatabase/DataSources/csv][CSV version]] of
the database.
** schema                                                          :noexport:
  #+BEGIN_SRC sqlite :eval no
CREATE TABLE [Album]
(
    [AlbumId] INTEGER  NOT NULL,
    [Title] NVARCHAR(160)  NOT NULL,
    [ArtistId] INTEGER  NOT NULL,
    CONSTRAINT [PK_Album] PRIMARY KEY  ([AlbumId]),
    FOREIGN KEY ([ArtistId]) REFERENCES [Artist] ([ArtistId])
		ON DELETE NO ACTION ON UPDATE NO ACTION
);
CREATE TABLE [Artist]
(
    [ArtistId] INTEGER  NOT NULL,
    [Name] NVARCHAR(120),
    CONSTRAINT [PK_Artist] PRIMARY KEY  ([ArtistId])
);
CREATE TABLE [Customer]
(
    [CustomerId] INTEGER  NOT NULL,
    [FirstName] NVARCHAR(40)  NOT NULL,
    [LastName] NVARCHAR(20)  NOT NULL,
    [Company] NVARCHAR(80),
    [Address] NVARCHAR(70),
    [City] NVARCHAR(40),
    [State] NVARCHAR(40),
    [Country] NVARCHAR(40),
    [PostalCode] NVARCHAR(10),
    [Phone] NVARCHAR(24),
    [Fax] NVARCHAR(24),
    [Email] NVARCHAR(60)  NOT NULL,
    [SupportRepId] INTEGER,
    CONSTRAINT [PK_Customer] PRIMARY KEY  ([CustomerId]),
    FOREIGN KEY ([SupportRepId]) REFERENCES [Employee] ([EmployeeId])
		ON DELETE NO ACTION ON UPDATE NO ACTION
);
CREATE TABLE [Employee]
(
    [EmployeeId] INTEGER  NOT NULL,
    [LastName] NVARCHAR(20)  NOT NULL,
    [FirstName] NVARCHAR(20)  NOT NULL,
    [Title] NVARCHAR(30),
    [ReportsTo] INTEGER,
    [BirthDate] DATETIME,
    [HireDate] DATETIME,
    [Address] NVARCHAR(70),
    [City] NVARCHAR(40),
    [State] NVARCHAR(40),
    [Country] NVARCHAR(40),
    [PostalCode] NVARCHAR(10),
    [Phone] NVARCHAR(24),
    [Fax] NVARCHAR(24),
    [Email] NVARCHAR(60),
    CONSTRAINT [PK_Employee] PRIMARY KEY  ([EmployeeId]),
    FOREIGN KEY ([ReportsTo]) REFERENCES [Employee] ([EmployeeId])
		ON DELETE NO ACTION ON UPDATE NO ACTION
);
CREATE TABLE [Genre]
(
    [GenreId] INTEGER  NOT NULL,
    [Name] NVARCHAR(120),
    CONSTRAINT [PK_Genre] PRIMARY KEY  ([GenreId])
);
CREATE TABLE [Invoice]
(
    [InvoiceId] INTEGER  NOT NULL,
    [CustomerId] INTEGER  NOT NULL,
    [InvoiceDate] DATETIME  NOT NULL,
    [BillingAddress] NVARCHAR(70),
    [BillingCity] NVARCHAR(40),
    [BillingState] NVARCHAR(40),
    [BillingCountry] NVARCHAR(40),
    [BillingPostalCode] NVARCHAR(10),
    [Total] NUMERIC(10,2)  NOT NULL,
    CONSTRAINT [PK_Invoice] PRIMARY KEY  ([InvoiceId]),
    FOREIGN KEY ([CustomerId]) REFERENCES [Customer] ([CustomerId])
		ON DELETE NO ACTION ON UPDATE NO ACTION
);
CREATE TABLE [InvoiceLine]
(
    [InvoiceLineId] INTEGER  NOT NULL,
    [InvoiceId] INTEGER  NOT NULL,
    [TrackId] INTEGER  NOT NULL,
    [UnitPrice] NUMERIC(10,2)  NOT NULL,
    [Quantity] INTEGER  NOT NULL,
    CONSTRAINT [PK_InvoiceLine] PRIMARY KEY  ([InvoiceLineId]),
    FOREIGN KEY ([InvoiceId]) REFERENCES [Invoice] ([InvoiceId])
		ON DELETE NO ACTION ON UPDATE NO ACTION,
    FOREIGN KEY ([TrackId]) REFERENCES [Track] ([TrackId])
		ON DELETE NO ACTION ON UPDATE NO ACTION
);
CREATE TABLE [MediaType]
(
    [MediaTypeId] INTEGER  NOT NULL,
    [Name] NVARCHAR(120),
    CONSTRAINT [PK_MediaType] PRIMARY KEY  ([MediaTypeId])
);
CREATE TABLE [Playlist]
(
    [PlaylistId] INTEGER  NOT NULL,
    [Name] NVARCHAR(120),
    CONSTRAINT [PK_Playlist] PRIMARY KEY  ([PlaylistId])
);
CREATE TABLE [PlaylistTrack]
(
    [PlaylistId] INTEGER  NOT NULL,
    [TrackId] INTEGER  NOT NULL,
    CONSTRAINT [PK_PlaylistTrack] PRIMARY KEY  ([PlaylistId], [TrackId]),
    FOREIGN KEY ([PlaylistId]) REFERENCES [Playlist] ([PlaylistId])
		ON DELETE NO ACTION ON UPDATE NO ACTION,
    FOREIGN KEY ([TrackId]) REFERENCES [Track] ([TrackId])
		ON DELETE NO ACTION ON UPDATE NO ACTION
);
CREATE TABLE [Track]
(
    [TrackId] INTEGER  NOT NULL,
    [Name] NVARCHAR(200)  NOT NULL,
    [AlbumId] INTEGER,
    [MediaTypeId] INTEGER  NOT NULL,
    [GenreId] INTEGER,
    [Composer] NVARCHAR(220),
    [Milliseconds] INTEGER  NOT NULL,
    [Bytes] INTEGER,
    [UnitPrice] NUMERIC(10,2)  NOT NULL,
    CONSTRAINT [PK_Track] PRIMARY KEY  ([TrackId]),
    FOREIGN KEY ([AlbumId]) REFERENCES [Album] ([AlbumId])
		ON DELETE NO ACTION ON UPDATE NO ACTION,
    FOREIGN KEY ([GenreId]) REFERENCES [Genre] ([GenreId])
		ON DELETE NO ACTION ON UPDATE NO ACTION,
    FOREIGN KEY ([MediaTypeId]) REFERENCES [MediaType] ([MediaTypeId])
		ON DELETE NO ACTION ON UPDATE NO ACTION
);
CREATE UNIQUE INDEX [IPK_Album] ON [Album]([AlbumId]);
CREATE UNIQUE INDEX [IPK_Artist] ON [Artist]([ArtistId]);
CREATE UNIQUE INDEX [IPK_Customer] ON [Customer]([CustomerId]);
CREATE UNIQUE INDEX [IPK_Employee] ON [Employee]([EmployeeId]);
CREATE UNIQUE INDEX [IPK_Genre] ON [Genre]([GenreId]);
CREATE UNIQUE INDEX [IPK_Invoice] ON [Invoice]([InvoiceId]);
CREATE UNIQUE INDEX [IPK_InvoiceLine] ON [InvoiceLine]([InvoiceLineId]);
CREATE UNIQUE INDEX [IPK_MediaType] ON [MediaType]([MediaTypeId]);
CREATE UNIQUE INDEX [IPK_Playlist] ON [Playlist]([PlaylistId]);
CREATE UNIQUE INDEX [IPK_PlaylistTrack] ON [PlaylistTrack]([PlaylistId], [TrackId]);
CREATE UNIQUE INDEX [IPK_Track] ON [Track]([TrackId]);
CREATE INDEX [IFK_AlbumArtistId] ON [Album] ([ArtistId]);
CREATE INDEX [IFK_CustomerSupportRepId] ON [Customer] ([SupportRepId]);
CREATE INDEX [IFK_EmployeeReportsTo] ON [Employee] ([ReportsTo]);
CREATE INDEX [IFK_InvoiceCustomerId] ON [Invoice] ([CustomerId]);
CREATE INDEX [IFK_InvoiceLineInvoiceId] ON [InvoiceLine] ([InvoiceId]);
CREATE INDEX [IFK_InvoiceLineTrackId] ON [InvoiceLine] ([TrackId]);
CREATE INDEX [IFK_PlaylistTrackTrackId] ON [PlaylistTrack] ([TrackId]);
CREATE INDEX [IFK_TrackAlbumId] ON [Track] ([AlbumId]);
CREATE INDEX [IFK_TrackGenreId] ON [Track] ([GenreId]);
CREATE INDEX [IFK_TrackMediaTypeId] ON [Track] ([MediaTypeId]);
  #+END_SRC

** Interacting with Relational
   #+NAME: setup
   #+BEGIN_SRC python :eval no
import sys
sys.path.append("/home/devin/projects/relational/")
from relational.relation_org import RelationOrg
from relational.relation import Relation
root_fp = "/home/devin/notes/sql-relational-algebra/chinook/csv/"
album = Relation(root_fp + "album.csv")
artist = Relation(root_fp + "artist.csv")
customer = Relation(root_fp + "customer.csv")
employee = Relation(root_fp + "employee.csv")
genre = Relation(root_fp + "genre.csv")
invoice_line = Relation(root_fp + "invoice-line.csv")
invoice = Relation(root_fp + "invoice.csv")
media_type = Relation(root_fp + "media-type.csv")
playlist_track = Relation(root_fp + "playlist-track.csv")
playlist = Relation(root_fp + "playlist.csv")
track = Relation(root_fp + "track.csv")
# END SETUP
   #+END_SRC

   Relational provides a graphical interface, but I find it easier to interact
   with the code using Python. Relational's Relation class represents relational
   tables and their operators. In the above code, the path to the Relational
   code is added to sys.path and Relation objects are created for each CSV file.
   The first line in each CSV file are the column names. Every element in each
   file is quoted with double quotes.  The CSV data entries are parsed into four
   possible types; string, integer, float, and date, which are defined in
   rtypes.py. Relational does not have a null type. Instead, three dashes,
   ~"---"~, are used to represent null values in the CSV files. Relational treats null
   values as equal, but SQL sometimes treats them as equal and sometimes not, so
   some of the examples may need to be changed to treat null equality as
   desired. [[https://en.wikipedia.org/wiki/Null_%28SQL%29][Wikipedia]] has an extensive article on the subject.

   I am using Emacs Org mode to run these pieces of code.  Org mode supports
   [[https://en.wikipedia.org/wiki/Literate_programming][literate programming]].  One feature of literate programming is the
   pre-processor. Org mode allows you to name code blocks and reference them
   else-ware in other code blocks. The above code block is named ~setup~ and is
   referenced using ~<<setup>>~. The ~:noweb yes~ argument tells Org to do the
   replacement.

   With the module, ~relation_org~, it is possible to use Emacs Org tables as
   input to Org Babel code blocks. It provides the class ~RelationOrg~ that is
   derived from the ~Relation~ class. In Org, an input table must be given a
   unique name. The name can be given as a ~:var~ argument in the Babel code
   block. The column names must be given in the first row, and the table must not
   have any horizontal separators. The ~:var~ variables become global variables in
   the Babel code block and the table data is converted to a list of lists.

   #+BEGIN_SRC org :eval no
,#+NAME:alpha_table
| key | value |
| 1   | A     |

,#+BEGIN_SRC python :var in_table=alpha_table :noweb yes
<<setup>>
from relational.relation_org import RelationOrg
alpha = RelationOrg(in_table)
,#+END_SRC
   #+END_SRC

   In the example, the alpha_table is given the value:
   #+BEGIN_SRC python :eval no
alpha_table = [["key", "value"],["1","A"]]
   #+END_SRC

   RelationOrg's initializer can take either a list of lists or a Relation
   object. It is used to convert Org tables to Relation objects and to print out
   Relation objects as Org tables, requiring the Python module [[https://pypi.python.org/pypi/tabulate][tabulate]].

** Chinook Database
   For this post, I will be using the Chinook Database for performing
   queries. It is an open source database available for many different
   database servers, but does not include CSV files. The example Org file will
   need to be modified to correctly reference the Chinook Database, the CSV
   files, and the Relational source code.

   The Chinook database has the following entity-relationship model.
   #+ATTR_HTML: :alt Chinook database entity relationship diagram.
   [[file:sql-relational-algebra/ER-diagram.svg]]

** Relational Algebra in Python
   All relational algebra operations are Relation class methods. Each of
   these methods returns a new Relation object. Additionally, the Relation
   object has ~__eq__~, ~__str__~, ~__len__~, ~__iter__~, and ~__contains__~ methods
   defined; and furthermore, the RelationOrg class overrides the ~__str__~ method
   to return an Org table string.

   Relational is not a full fledged database system and it is slow. Internally,
   the table data is stored as a set of tuple rows, and the header is its own
   Header object type. The data is accessible through the Relation ~content~
   variable and header through the ~header~ variable.


*** Selection
    In relational algebra, the selection function selects rows. The selection
    method takes a single string of Python code that returns true or false,
    which it passes to the [[https://docs.python.org/3.5/library/functions.html#compile][compile]] Python internal and then to eval. The table's
    column names get turned into variables global to the code being
    evaluated. During processing, numeric strings get turned into numbers
    (integers or floats) and dates get turned into [[https://docs.python.org/3.5/library/datetime.html][datetime]] objects.  The
    selection method returns a new table containing only rows having the
    specified property. In this example, only rows whose ArtistId column is 1
    are returned.

    #+BEGIN_SRC python :noweb yes :exports code
<<setup>>
sel = album.selection("ArtistId == 1")
return str(RelationOrg(sel))
    #+END_SRC

    #+RESULTS:
    : |   AlbumId | Title                                 |   ArtistId |
    : |-----------+---------------------------------------+------------|
    : |         1 | For Those About To Rock We Salute You |          1 |
    : |         4 | Let There Be Rock                     |          1 |

    #+BEGIN_SRC python :noweb yes :exports code
<<setup>>
sel = employee.selection("ReportsTo == '---'")
return str(RelationOrg(sel))
    #+END_SRC

    #+RESULTS:
    : |   EmployeeId | LastName   | FirstName   | Title           | ReportsTo   | BirthDate   | HireDate   | Address             | City     | State   | Country   | PostalCode   | Phone             | Fax               | Email                  |
    : |--------------+------------+-------------+-----------------+-------------+-------------+------------+---------------------+----------+---------+-----------+--------------+-------------------+-------------------+------------------------|
    : |            1 | Adams      | Andrew      | General Manager | ---         | 1962-02-18  | 2002-08-14 | 11120 Jasper Ave NW | Edmonton | AB      | Canada    | T5K 2N1      | +1 (780) 428-9482 | +1 (780) 428-3457 | andrew@chinookcorp.com |

*** Projection
    Projection performs the same function as SQL selection. It takes one or more
    string arguments or a single list, the names of the columns to include in the return
    table.

    #+BEGIN_SRC python :noweb yes :exports code
<<setup>>
proj = genre.projection("Name")
return str(RelationOrg(proj))
    #+END_SRC

    #+RESULTS:
    #+begin_example
    | Name               |
    |--------------------|
    | Heavy Metal        |
    | TV Shows           |
    | Hip Hop/Rap        |
    | Pop                |
    | Alternative        |
    | Opera              |
    | Comedy             |
    | Jazz               |
    | Bossa Nova         |
    | Science Fiction    |
    | Sci Fi & Fantasy   |
    | Metal              |
    | Alternative & Punk |
    | Electronica/Dance  |
    | Blues              |
    | Classical          |
    | World              |
    | Reggae             |
    | R&B/Soul           |
    | Drama              |
    | Latin              |
    | Rock               |
    | Soundtrack         |
    | Rock And Roll      |
    | Easy Listening     |
    #+end_example

*** Rename
    Rename takes a dictionary argument where the keys are the current column
    names to replace and the values are the corresponding replacements, with all
    keys and values being strings. A new table is returned with renamed
    columns. You will have to use this quite often, since the joining methods
    require that their input tables have all different column names.

    #+BEGIN_SRC python :noweb yes :exports code
<<setup>>
rn = employee.rename({"LastName": "Family", "FirstName": "Given"})
return str(RelationOrg(rn))
    #+END_SRC

    #+RESULTS:
    #+begin_example
    |   EmployeeId | Family   | Given    | Title               | ReportsTo   | BirthDate   | HireDate   | Address                     | City       | State   | Country   | PostalCode   | Phone             | Fax               | Email                    |
    |--------------+----------+----------+---------------------+-------------+-------------+------------+-----------------------------+------------+---------+-----------+--------------+-------------------+-------------------+--------------------------|
    |            2 | Edwards  | Nancy    | Sales Manager       | 1           | 1958-12-08  | 2002-05-01 | 825 8 Ave SW                | Calgary    | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |
    |            5 | Johnson  | Steve    | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    |            3 | Peacock  | Jane     | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    |            8 | Callahan | Laura    | IT Staff            | 6           | 1968-01-09  | 2004-03-04 | 923 7 ST NW                 | Lethbridge | AB      | Canada    | T1H 1Y8      | +1 (403) 467-3351 | +1 (403) 467-8772 | laura@chinookcorp.com    |
    |            4 | Park     | Margaret | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    |            6 | Mitchell | Michael  | IT Manager          | 1           | 1973-07-01  | 2003-10-17 | 5827 Bowness Road NW        | Calgary    | AB      | Canada    | T3B 0C5      | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  |
    |            1 | Adams    | Andrew   | General Manager     | ---         | 1962-02-18  | 2002-08-14 | 11120 Jasper Ave NW         | Edmonton   | AB      | Canada    | T5K 2N1      | +1 (780) 428-9482 | +1 (780) 428-3457 | andrew@chinookcorp.com   |
    |            7 | King     | Robert   | IT Staff            | 6           | 1970-05-29  | 2004-01-02 | 590 Columbia Boulevard West | Lethbridge | AB      | Canada    | T1K 5N8      | +1 (403) 456-9986 | +1 (403) 456-8485 | robert@chinookcorp.com   |
    #+end_example

*** Product
    Performs a Cartesian product between two tables and returns a new
    table. The method takes a table as its argument, and applies its
    argument and it's object to the product operation. None of the columns
    names in one table can be equal to any column names in the other, so
    renaming may be necessary.

    #+BEGIN_SRC python :noweb yes :exports code :results org table
<<setup>>
prod = employee.product(media_type)
return str(RelationOrg(prod))
    #+END_SRC

    #+RESULTS:
    #+BEGIN_SRC org
    |   | EmployeeId | LastName | FirstName           | Title |  ReportsTo |  BirthDate | HireDate                    | Address    | City | State  | Country | PostalCode        | Phone             | Fax                      | Email | MediaTypeId                 | Name |
    |---+------------+----------+---------------------+-------+------------+------------+-----------------------------+------------+------+--------+---------+-------------------+-------------------+--------------------------+-------+-----------------------------+------|
    | 1 | Adams      | Andrew   | General Manager     |   --- | 1962-02-18 | 2002-08-14 | 11120 Jasper Ave NW         | Edmonton   | AB   | Canada | T5K 2N1 | +1 (780) 428-9482 | +1 (780) 428-3457 | andrew@chinookcorp.com   |     3 | Protected MPEG-4 video file |      |
    | 1 | Adams      | Andrew   | General Manager     |   --- | 1962-02-18 | 2002-08-14 | 11120 Jasper Ave NW         | Edmonton   | AB   | Canada | T5K 2N1 | +1 (780) 428-9482 | +1 (780) 428-3457 | andrew@chinookcorp.com   |     4 | Purchased AAC audio file    |      |
    | 1 | Adams      | Andrew   | General Manager     |   --- | 1962-02-18 | 2002-08-14 | 11120 Jasper Ave NW         | Edmonton   | AB   | Canada | T5K 2N1 | +1 (780) 428-9482 | +1 (780) 428-3457 | andrew@chinookcorp.com   |     2 | Protected AAC audio file    |      |
    | 1 | Adams      | Andrew   | General Manager     |   --- | 1962-02-18 | 2002-08-14 | 11120 Jasper Ave NW         | Edmonton   | AB   | Canada | T5K 2N1 | +1 (780) 428-9482 | +1 (780) 428-3457 | andrew@chinookcorp.com   |     1 | MPEG audio file             |      |
    | 1 | Adams      | Andrew   | General Manager     |   --- | 1962-02-18 | 2002-08-14 | 11120 Jasper Ave NW         | Edmonton   | AB   | Canada | T5K 2N1 | +1 (780) 428-9482 | +1 (780) 428-3457 | andrew@chinookcorp.com   |     5 | AAC audio file              |      |
    | 2 | Edwards    | Nancy    | Sales Manager       |     1 | 1958-12-08 | 2002-05-01 | 825 8 Ave SW                | Calgary    | AB   | Canada | T2P 2T3 | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |     1 | MPEG audio file             |      |
    | 2 | Edwards    | Nancy    | Sales Manager       |     1 | 1958-12-08 | 2002-05-01 | 825 8 Ave SW                | Calgary    | AB   | Canada | T2P 2T3 | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |     5 | AAC audio file              |      |
    | 2 | Edwards    | Nancy    | Sales Manager       |     1 | 1958-12-08 | 2002-05-01 | 825 8 Ave SW                | Calgary    | AB   | Canada | T2P 2T3 | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |     2 | Protected AAC audio file    |      |
    | 2 | Edwards    | Nancy    | Sales Manager       |     1 | 1958-12-08 | 2002-05-01 | 825 8 Ave SW                | Calgary    | AB   | Canada | T2P 2T3 | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |     4 | Purchased AAC audio file    |      |
    | 2 | Edwards    | Nancy    | Sales Manager       |     1 | 1958-12-08 | 2002-05-01 | 825 8 Ave SW                | Calgary    | AB   | Canada | T2P 2T3 | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |     3 | Protected MPEG-4 video file |      |
    | 3 | Peacock    | Jane     | Sales Support Agent |     2 | 1973-08-29 | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB   | Canada | T2P 5M5 | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |     3 | Protected MPEG-4 video file |      |
    | 3 | Peacock    | Jane     | Sales Support Agent |     2 | 1973-08-29 | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB   | Canada | T2P 5M5 | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |     2 | Protected AAC audio file    |      |
    | 3 | Peacock    | Jane     | Sales Support Agent |     2 | 1973-08-29 | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB   | Canada | T2P 5M5 | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |     5 | AAC audio file              |      |
    | 3 | Peacock    | Jane     | Sales Support Agent |     2 | 1973-08-29 | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB   | Canada | T2P 5M5 | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |     4 | Purchased AAC audio file    |      |
    | 3 | Peacock    | Jane     | Sales Support Agent |     2 | 1973-08-29 | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB   | Canada | T2P 5M5 | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |     1 | MPEG audio file             |      |
    | 4 | Park       | Margaret | Sales Support Agent |     2 | 1947-09-19 | 2003-05-03 | 683 10 Street SW            | Calgary    | AB   | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |     1 | MPEG audio file             |      |
    | 4 | Park       | Margaret | Sales Support Agent |     2 | 1947-09-19 | 2003-05-03 | 683 10 Street SW            | Calgary    | AB   | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |     5 | AAC audio file              |      |
    | 4 | Park       | Margaret | Sales Support Agent |     2 | 1947-09-19 | 2003-05-03 | 683 10 Street SW            | Calgary    | AB   | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |     3 | Protected MPEG-4 video file |      |
    | 4 | Park       | Margaret | Sales Support Agent |     2 | 1947-09-19 | 2003-05-03 | 683 10 Street SW            | Calgary    | AB   | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |     4 | Purchased AAC audio file    |      |
    | 4 | Park       | Margaret | Sales Support Agent |     2 | 1947-09-19 | 2003-05-03 | 683 10 Street SW            | Calgary    | AB   | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |     2 | Protected AAC audio file    |      |
    | 5 | Johnson    | Steve    | Sales Support Agent |     2 | 1965-03-03 | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB   | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |     3 | Protected MPEG-4 video file |      |
    | 5 | Johnson    | Steve    | Sales Support Agent |     2 | 1965-03-03 | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB   | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |     2 | Protected AAC audio file    |      |
    | 5 | Johnson    | Steve    | Sales Support Agent |     2 | 1965-03-03 | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB   | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |     5 | AAC audio file              |      |
    | 5 | Johnson    | Steve    | Sales Support Agent |     2 | 1965-03-03 | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB   | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |     4 | Purchased AAC audio file    |      |
    | 5 | Johnson    | Steve    | Sales Support Agent |     2 | 1965-03-03 | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB   | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |     1 | MPEG audio file             |      |
    | 6 | Mitchell   | Michael  | IT Manager          |     1 | 1973-07-01 | 2003-10-17 | 5827 Bowness Road NW        | Calgary    | AB   | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  |     5 | AAC audio file              |      |
    | 6 | Mitchell   | Michael  | IT Manager          |     1 | 1973-07-01 | 2003-10-17 | 5827 Bowness Road NW        | Calgary    | AB   | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  |     3 | Protected MPEG-4 video file |      |
    | 6 | Mitchell   | Michael  | IT Manager          |     1 | 1973-07-01 | 2003-10-17 | 5827 Bowness Road NW        | Calgary    | AB   | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  |     2 | Protected AAC audio file    |      |
    | 6 | Mitchell   | Michael  | IT Manager          |     1 | 1973-07-01 | 2003-10-17 | 5827 Bowness Road NW        | Calgary    | AB   | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  |     4 | Purchased AAC audio file    |      |
    | 6 | Mitchell   | Michael  | IT Manager          |     1 | 1973-07-01 | 2003-10-17 | 5827 Bowness Road NW        | Calgary    | AB   | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  |     1 | MPEG audio file             |      |
    | 7 | King       | Robert   | IT Staff            |     6 | 1970-05-29 | 2004-01-02 | 590 Columbia Boulevard West | Lethbridge | AB   | Canada | T1K 5N8 | +1 (403) 456-9986 | +1 (403) 456-8485 | robert@chinookcorp.com   |     2 | Protected AAC audio file    |      |
    | 7 | King       | Robert   | IT Staff            |     6 | 1970-05-29 | 2004-01-02 | 590 Columbia Boulevard West | Lethbridge | AB   | Canada | T1K 5N8 | +1 (403) 456-9986 | +1 (403) 456-8485 | robert@chinookcorp.com   |     4 | Purchased AAC audio file    |      |
    | 7 | King       | Robert   | IT Staff            |     6 | 1970-05-29 | 2004-01-02 | 590 Columbia Boulevard West | Lethbridge | AB   | Canada | T1K 5N8 | +1 (403) 456-9986 | +1 (403) 456-8485 | robert@chinookcorp.com   |     5 | AAC audio file              |      |
    | 7 | King       | Robert   | IT Staff            |     6 | 1970-05-29 | 2004-01-02 | 590 Columbia Boulevard West | Lethbridge | AB   | Canada | T1K 5N8 | +1 (403) 456-9986 | +1 (403) 456-8485 | robert@chinookcorp.com   |     1 | MPEG audio file             |      |
    | 7 | King       | Robert   | IT Staff            |     6 | 1970-05-29 | 2004-01-02 | 590 Columbia Boulevard West | Lethbridge | AB   | Canada | T1K 5N8 | +1 (403) 456-9986 | +1 (403) 456-8485 | robert@chinookcorp.com   |     3 | Protected MPEG-4 video file |      |
    | 8 | Callahan   | Laura    | IT Staff            |     6 | 1968-01-09 | 2004-03-04 | 923 7 ST NW                 | Lethbridge | AB   | Canada | T1H 1Y8 | +1 (403) 467-3351 | +1 (403) 467-8772 | laura@chinookcorp.com    |     3 | Protected MPEG-4 video file |      |
    | 8 | Callahan   | Laura    | IT Staff            |     6 | 1968-01-09 | 2004-03-04 | 923 7 ST NW                 | Lethbridge | AB   | Canada | T1H 1Y8 | +1 (403) 467-3351 | +1 (403) 467-8772 | laura@chinookcorp.com    |     1 | MPEG audio file             |      |
    | 8 | Callahan   | Laura    | IT Staff            |     6 | 1968-01-09 | 2004-03-04 | 923 7 ST NW                 | Lethbridge | AB   | Canada | T1H 1Y8 | +1 (403) 467-3351 | +1 (403) 467-8772 | laura@chinookcorp.com    |     5 | AAC audio file              |      |
    | 8 | Callahan   | Laura    | IT Staff            |     6 | 1968-01-09 | 2004-03-04 | 923 7 ST NW                 | Lethbridge | AB   | Canada | T1H 1Y8 | +1 (403) 467-3351 | +1 (403) 467-8772 | laura@chinookcorp.com    |     4 | Purchased AAC audio file    |      |
    | 8 | Callahan   | Laura    | IT Staff            |     6 | 1968-01-09 | 2004-03-04 | 923 7 ST NW                 | Lethbridge | AB   | Canada | T1H 1Y8 | +1 (403) 467-3351 | +1 (403) 467-8772 | laura@chinookcorp.com    |     2 | Protected AAC audio file    |      |
    #+END_SRC

    #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports none
SELECT DISTINCT * FROM Employee, MediaType;
    #+END_SRC

    #+RESULTS:
    | 1 | Adams    | Andrew   | General Manager     |   | 1962-02-18 00:00:00 | 2002-08-14 00:00:00 | 11120 Jasper Ave NW         | Edmonton   | AB | Canada | T5K 2N1 | +1 (780) 428-9482 | +1 (780) 428-3457 | andrew@chinookcorp.com   | 1 | MPEG audio file             |
    | 1 | Adams    | Andrew   | General Manager     |   | 1962-02-18 00:00:00 | 2002-08-14 00:00:00 | 11120 Jasper Ave NW         | Edmonton   | AB | Canada | T5K 2N1 | +1 (780) 428-9482 | +1 (780) 428-3457 | andrew@chinookcorp.com   | 2 | Protected AAC audio file    |
    | 1 | Adams    | Andrew   | General Manager     |   | 1962-02-18 00:00:00 | 2002-08-14 00:00:00 | 11120 Jasper Ave NW         | Edmonton   | AB | Canada | T5K 2N1 | +1 (780) 428-9482 | +1 (780) 428-3457 | andrew@chinookcorp.com   | 3 | Protected MPEG-4 video file |
    | 1 | Adams    | Andrew   | General Manager     |   | 1962-02-18 00:00:00 | 2002-08-14 00:00:00 | 11120 Jasper Ave NW         | Edmonton   | AB | Canada | T5K 2N1 | +1 (780) 428-9482 | +1 (780) 428-3457 | andrew@chinookcorp.com   | 4 | Purchased AAC audio file    |
    | 1 | Adams    | Andrew   | General Manager     |   | 1962-02-18 00:00:00 | 2002-08-14 00:00:00 | 11120 Jasper Ave NW         | Edmonton   | AB | Canada | T5K 2N1 | +1 (780) 428-9482 | +1 (780) 428-3457 | andrew@chinookcorp.com   | 5 | AAC audio file              |
    | 2 | Edwards  | Nancy    | Sales Manager       | 1 | 1958-12-08 00:00:00 | 2002-05-01 00:00:00 | 825 8 Ave SW                | Calgary    | AB | Canada | T2P 2T3 | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    | 1 | MPEG audio file             |
    | 2 | Edwards  | Nancy    | Sales Manager       | 1 | 1958-12-08 00:00:00 | 2002-05-01 00:00:00 | 825 8 Ave SW                | Calgary    | AB | Canada | T2P 2T3 | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    | 2 | Protected AAC audio file    |
    | 2 | Edwards  | Nancy    | Sales Manager       | 1 | 1958-12-08 00:00:00 | 2002-05-01 00:00:00 | 825 8 Ave SW                | Calgary    | AB | Canada | T2P 2T3 | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    | 3 | Protected MPEG-4 video file |
    | 2 | Edwards  | Nancy    | Sales Manager       | 1 | 1958-12-08 00:00:00 | 2002-05-01 00:00:00 | 825 8 Ave SW                | Calgary    | AB | Canada | T2P 2T3 | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    | 4 | Purchased AAC audio file    |
    | 2 | Edwards  | Nancy    | Sales Manager       | 1 | 1958-12-08 00:00:00 | 2002-05-01 00:00:00 | 825 8 Ave SW                | Calgary    | AB | Canada | T2P 2T3 | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    | 5 | AAC audio file              |
    | 3 | Peacock  | Jane     | Sales Support Agent | 2 | 1973-08-29 00:00:00 | 2002-04-01 00:00:00 | 1111 6 Ave SW               | Calgary    | AB | Canada | T2P 5M5 | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 1 | MPEG audio file             |
    | 3 | Peacock  | Jane     | Sales Support Agent | 2 | 1973-08-29 00:00:00 | 2002-04-01 00:00:00 | 1111 6 Ave SW               | Calgary    | AB | Canada | T2P 5M5 | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 2 | Protected AAC audio file    |
    | 3 | Peacock  | Jane     | Sales Support Agent | 2 | 1973-08-29 00:00:00 | 2002-04-01 00:00:00 | 1111 6 Ave SW               | Calgary    | AB | Canada | T2P 5M5 | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 3 | Protected MPEG-4 video file |
    | 3 | Peacock  | Jane     | Sales Support Agent | 2 | 1973-08-29 00:00:00 | 2002-04-01 00:00:00 | 1111 6 Ave SW               | Calgary    | AB | Canada | T2P 5M5 | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 4 | Purchased AAC audio file    |
    | 3 | Peacock  | Jane     | Sales Support Agent | 2 | 1973-08-29 00:00:00 | 2002-04-01 00:00:00 | 1111 6 Ave SW               | Calgary    | AB | Canada | T2P 5M5 | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 5 | AAC audio file              |
    | 4 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW            | Calgary    | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 1 | MPEG audio file             |
    | 4 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW            | Calgary    | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 2 | Protected AAC audio file    |
    | 4 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW            | Calgary    | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 3 | Protected MPEG-4 video file |
    | 4 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW            | Calgary    | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 4 | Purchased AAC audio file    |
    | 4 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW            | Calgary    | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 5 | AAC audio file              |
    | 5 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave                | Calgary    | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 1 | MPEG audio file             |
    | 5 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave                | Calgary    | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 2 | Protected AAC audio file    |
    | 5 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave                | Calgary    | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 3 | Protected MPEG-4 video file |
    | 5 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave                | Calgary    | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 4 | Purchased AAC audio file    |
    | 5 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave                | Calgary    | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 5 | AAC audio file              |
    | 6 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW        | Calgary    | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  | 1 | MPEG audio file             |
    | 6 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW        | Calgary    | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  | 2 | Protected AAC audio file    |
    | 6 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW        | Calgary    | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  | 3 | Protected MPEG-4 video file |
    | 6 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW        | Calgary    | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  | 4 | Purchased AAC audio file    |
    | 6 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW        | Calgary    | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  | 5 | AAC audio file              |
    | 7 | King     | Robert   | IT Staff            | 6 | 1970-05-29 00:00:00 | 2004-01-02 00:00:00 | 590 Columbia Boulevard West | Lethbridge | AB | Canada | T1K 5N8 | +1 (403) 456-9986 | +1 (403) 456-8485 | robert@chinookcorp.com   | 1 | MPEG audio file             |
    | 7 | King     | Robert   | IT Staff            | 6 | 1970-05-29 00:00:00 | 2004-01-02 00:00:00 | 590 Columbia Boulevard West | Lethbridge | AB | Canada | T1K 5N8 | +1 (403) 456-9986 | +1 (403) 456-8485 | robert@chinookcorp.com   | 2 | Protected AAC audio file    |
    | 7 | King     | Robert   | IT Staff            | 6 | 1970-05-29 00:00:00 | 2004-01-02 00:00:00 | 590 Columbia Boulevard West | Lethbridge | AB | Canada | T1K 5N8 | +1 (403) 456-9986 | +1 (403) 456-8485 | robert@chinookcorp.com   | 3 | Protected MPEG-4 video file |
    | 7 | King     | Robert   | IT Staff            | 6 | 1970-05-29 00:00:00 | 2004-01-02 00:00:00 | 590 Columbia Boulevard West | Lethbridge | AB | Canada | T1K 5N8 | +1 (403) 456-9986 | +1 (403) 456-8485 | robert@chinookcorp.com   | 4 | Purchased AAC audio file    |
    | 7 | King     | Robert   | IT Staff            | 6 | 1970-05-29 00:00:00 | 2004-01-02 00:00:00 | 590 Columbia Boulevard West | Lethbridge | AB | Canada | T1K 5N8 | +1 (403) 456-9986 | +1 (403) 456-8485 | robert@chinookcorp.com   | 5 | AAC audio file              |
    | 8 | Callahan | Laura    | IT Staff            | 6 | 1968-01-09 00:00:00 | 2004-03-04 00:00:00 | 923 7 ST NW                 | Lethbridge | AB | Canada | T1H 1Y8 | +1 (403) 467-3351 | +1 (403) 467-8772 | laura@chinookcorp.com    | 1 | MPEG audio file             |
    | 8 | Callahan | Laura    | IT Staff            | 6 | 1968-01-09 00:00:00 | 2004-03-04 00:00:00 | 923 7 ST NW                 | Lethbridge | AB | Canada | T1H 1Y8 | +1 (403) 467-3351 | +1 (403) 467-8772 | laura@chinookcorp.com    | 2 | Protected AAC audio file    |
    | 8 | Callahan | Laura    | IT Staff            | 6 | 1968-01-09 00:00:00 | 2004-03-04 00:00:00 | 923 7 ST NW                 | Lethbridge | AB | Canada | T1H 1Y8 | +1 (403) 467-3351 | +1 (403) 467-8772 | laura@chinookcorp.com    | 3 | Protected MPEG-4 video file |
    | 8 | Callahan | Laura    | IT Staff            | 6 | 1968-01-09 00:00:00 | 2004-03-04 00:00:00 | 923 7 ST NW                 | Lethbridge | AB | Canada | T1H 1Y8 | +1 (403) 467-3351 | +1 (403) 467-8772 | laura@chinookcorp.com    | 4 | Purchased AAC audio file    |
    | 8 | Callahan | Laura    | IT Staff            | 6 | 1968-01-09 00:00:00 | 2004-03-04 00:00:00 | 923 7 ST NW                 | Lethbridge | AB | Canada | T1H 1Y8 | +1 (403) 467-3351 | +1 (403) 467-8772 | laura@chinookcorp.com    | 5 | AAC audio file              |

*** Set Operations
    Relation provides three set operations; union, intersection, and difference.
    I added the symmetric difference operation. While symmetric difference
    is not strictly part of relational algebra, it is defined in terms of the
    other relational algebra set operators.  Each of the set methods require
    that both input tables have the same column names.

**** Union
    #+BEGIN_SRC python :noweb yes :exports code
<<setup>>
e_state = employee.projection("State")
c_state = customer.projection("State")
union = e_state.union(c_state)
return str(RelationOrg(union))
    #+END_SRC

    #+RESULTS:
    #+begin_example
    | State   |
    |---------|
    | RJ      |
    | FL      |
    | QC      |
    | DF      |
    | VV      |
    | NT      |
    | WA      |
    | WI      |
    | SP      |
    | NSW     |
    | ---     |
    | TX      |
    | MB      |
    | NV      |
    | AZ      |
    | CA      |
    | UT      |
    | NY      |
    | NS      |
    | IL      |
    | MA      |
    | Dublin  |
    | AB      |
    | BC      |
    | ON      |
    | RM      |
    #+end_example

    #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports none
SELECT DISTINCT state FROM Customer
UNION
SELECT DISTINCT state FROM Employee;
    #+END_SRC

    #+RESULTS:
    |        |
    | AB     |
    | AZ     |
    | BC     |
    | CA     |
    | DF     |
    | Dublin |
    | FL     |
    | IL     |
    | MA     |
    | MB     |
    | NS     |
    | NSW    |
    | NT     |
    | NV     |
    | NY     |
    | ON     |
    | QC     |
    | RJ     |
    | RM     |
    | SP     |
    | TX     |
    | UT     |
    | VV     |
    | WA     |
    | WI     |

**** Intersection
    #+BEGIN_SRC python :noweb yes :exports code
<<setup>>
e_state = employee.projection("State")
c_state = customer.projection("State")
inter = c_state.intersection(e_state)
return str(RelationOrg(inter))
    #+END_SRC

    #+RESULTS:
    : | State   |
    : |---------|
    : | AB      |

    #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports none
SELECT DISTINCT state FROM Customer
INTERSECT
SELECT DISTINCT state FROM Employee;
    #+END_SRC

    #+RESULTS:
    : AB

**** Difference
    #+BEGIN_SRC python :noweb yes :exports code
<<setup>>
e_state = employee.projection("State")
c_state = customer.projection("State")
diff = c_state.difference(e_state)
return str(RelationOrg(diff))
    #+END_SRC

    #+RESULTS:
    #+begin_example
    | State   |
    |---------|
    | QC      |
    | NT      |
    | NSW     |
    | IL      |
    | ---     |
    | BC      |
    | CA      |
    | TX      |
    | NS      |
    | UT      |
    | Dublin  |
    | FL      |
    | DF      |
    | ON      |
    | RM      |
    | AZ      |
    | RJ      |
    | NY      |
    | WI      |
    | NV      |
    | SP      |
    | VV      |
    | WA      |
    | MA      |
    | MB      |
    #+end_example

    #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports none
SELECT DISTINCT state FROM Customer
EXCEPT
SELECT DISTINCT state FROM Employee;
    #+END_SRC

    #+RESULTS:
    |        |
    | AZ     |
    | BC     |
    | CA     |
    | DF     |
    | Dublin |
    | FL     |
    | IL     |
    | MA     |
    | MB     |
    | NS     |
    | NSW    |
    | NT     |
    | NV     |
    | NY     |
    | ON     |
    | QC     |
    | RJ     |
    | RM     |
    | SP     |
    | TX     |
    | UT     |
    | VV     |
    | WA     |
    | WI     |

     The SQL equivalent to difference is the ~EXCEPT~ operator. Not all SQL
     engines have the ~EXCEPT~ operator, such as MySQL.  [[https://en.wikipedia.org/wiki/Set_operations_%28SQL%29#EXCEPT_operator][Wikipedia]] has an example
     of how to create an except, using left outer join.

**** Symmetric Difference, XOR
    #+BEGIN_SRC python :noweb yes :exports code
<<setup>>
e_state = employee.projection("State")
c_state = customer.projection("State")
sym = e_state.symmetric_diff(c_state)
return str(RelationOrg(sym))
    #+END_SRC

    #+RESULTS:
    #+begin_example
    | State   |
    |---------|
    | QC      |
    | CA      |
    | TX      |
    | Dublin  |
    | AZ      |
    | FL      |
    | WA      |
    | NV      |
    | MB      |
    | NT      |
    | NSW     |
    | MA      |
    | SP      |
    | ON      |
    | UT      |
    | IL      |
    | VV      |
    | NS      |
    | NY      |
    | RM      |
    | ---     |
    | BC      |
    | RJ      |
    | WI      |
    | DF      |
    #+end_example

    #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports none
SELECT * FROM
(SELECT DISTINCT state FROM Customer
UNION
SELECT DISTINCT state FROM Employee)
EXCEPT
SELECT * FROM
(SELECT DISTINCT state FROM Customer
INTERSECT
SELECT DISTINCT state FROM Employee);
    #+END_SRC

    #+RESULTS:
    |        |
    | AZ     |
    | BC     |
    | CA     |
    | DF     |
    | Dublin |
    | FL     |
    | IL     |
    | MA     |
    | MB     |
    | NS     |
    | NSW    |
    | NT     |
    | NV     |
    | NY     |
    | ON     |
    | QC     |
    | RJ     |
    | RM     |
    | SP     |
    | TX     |
    | UT     |
    | VV     |
    | WA     |
    | WI     |

*** Joins
    The Relational program comes with most of the relational algebra join
    operations including the extended relational algebra outer-join
    operations. I added ~semijoin_left~, ~semijoin_right~, and ~antijoin~.
    Also note that null values are considered equal.

**** Natural Join and Semijoin
     The natural join methods (~join~, ~semijoin_left~, and ~semijoin_right~)
     each take a table as an argument and join its table object to the argument
     table. Each join function returns a new table.  ~semijoin_left~ returns
     only those columns in the method's object, while ~semijoin_right~ returns
     only those columns in the table argument. The ~join~ method returns columns
     from both tables.  Tables are joined on columns with equivalent
     names. If there are no names in common, then the Cartesian product is
     returned.
***** Natural Join
     #+BEGIN_SRC python :noweb yes :exports code
<<setup>>
cn = customer.rename({"SupportRepId": "EmployeeId", "LastName": "cLastName",
                      "FirstName": "cFirstName", "Company": "cCompany",
                      "Address": "cAddress", "City": "cCity", "State": "cState",
                      "Country": "cCountry", "PostalCode": "cPostalCode",
                      "Phone": "cPhone", "Fax": "cFax", "Email": "cEmail"})
jn = employee.join(cn)
return str(RelationOrg(jn))
     #+END_SRC

     #+RESULTS:
     #+begin_example
     |   EmployeeId | LastName   | FirstName   | Title               |   ReportsTo | BirthDate   | HireDate   | Address          | City    | State   | Country   | PostalCode   | Phone             | Fax               | Email                    |   CustomerId | cFirstName   | cLastName    | cCompany                                         | cAddress                                 | cCity               | cState   | cCountry       | cPostalCode   | cPhone              | cFax               | cEmail                        |
     |--------------+------------+-------------+---------------------+-------------+-------------+------------+------------------+---------+---------+-----------+--------------+-------------------+-------------------+--------------------------+--------------+--------------+--------------+--------------------------------------------------+------------------------------------------+---------------------+----------+----------------+---------------+---------------------+--------------------+-------------------------------|
     |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           26 | Richard      | Cunningham   | ---                                              | 2211 W Berry Street                      | Fort Worth          | TX       | USA            | 76110         | +1 (817) 924-7272   | ---                | ricunningham@hotmail.com      |
     |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           55 | Mark         | Taylor       | ---                                              | 421 Bourke Street                        | Sidney              | NSW      | Australia      | 2010          | +61 (02) 9332 3633  | ---                | mark.taylor@yahoo.au          |
     |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           27 | Patrick      | Gray         | ---                                              | 1033 N Park Ave                          | Tucson              | AZ       | USA            | 85719         | +1 (520) 622-4200   | ---                | patrick.gray@aol.com          |
     |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |           50 | Enrique      | Muñoz        | ---                                              | C/ San Bernardo 85                       | Madrid              | ---      | Spain          | 28015         | +34 914 454 454     | ---                | enrique_munoz@yahoo.es        |
     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           15 | Jennifer     | Peterson     | Rogers Canada                                    | 700 W Pender Street                      | Vancouver           | BC       | Canada         | V6C 1G8       | +1 (604) 688-2255   | +1 (604) 688-8756  | jenniferp@rogers.ca           |
     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           12 | Roberto      | Almeida      | Riotur                                           | Praça Pio X, 119                         | Rio de Janeiro      | RJ       | Brazil         | 20040-020     | +55 (21) 2271-7000  | +55 (21) 2271-7070 | roberto.almeida@riotur.gov.br |
     |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           56 | Diego        | Gutiérrez    | ---                                              | 307 Macacha Güemes                       | Buenos Aires        | ---      | Argentina      | 1106          | +54 (0)11 4311 4333 | ---                | diego.gutierrez@yahoo.ar      |
     |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           49 | Stanisław    | Wójcik       | ---                                              | Ordynacka 10                             | Warsaw              | ---      | Poland         | 00-358        | +48 22 828 37 39    | ---                | stanisław.wójcik@wp.pl        |
     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           19 | Tim          | Goyer        | Apple Inc.                                       | 1 Infinite Loop                          | Cupertino           | CA       | USA            | 95014         | +1 (408) 996-1010   | +1 (408) 996-1011  | tgoyer@apple.com              |
     |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           22 | Heather      | Leacock      | ---                                              | 120 S Orange Ave                         | Orlando             | FL       | USA            | 32801         | +1 (407) 999-7788   | ---                | hleacock@gmail.com            |
     |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           10 | Eduardo      | Martins      | Woodstock Discos                                 | Rua Dr. Falcão Filho, 155                | São Paulo           | SP       | Brazil         | 01007-010     | +55 (11) 3033-5446  | +55 (11) 3033-4564 | eduardo@woodstock.com.br      |
     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           29 | Robert       | Brown        | ---                                              | 796 Dundas Street West                   | Toronto             | ON       | Canada         | M6J 1V1       | +1 (416) 363-8888   | ---                | robbrown@shaw.ca              |
     |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           20 | Dan          | Miller       | ---                                              | 541 Del Medio Avenue                     | Mountain View       | CA       | USA            | 94040-111     | +1 (650) 644-3358   | ---                | dmiller@comcast.com           |
     |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |           41 | Marc         | Dubois       | ---                                              | 11, Place Bellecour                      | Lyon                | ---      | France         | 69002         | +33 04 78 30 30 30  | ---                | marc.dubois@hotmail.com       |
     |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |           17 | Jack         | Smith        | Microsoft Corporation                            | 1 Microsoft Way                          | Redmond             | WA       | USA            | 98052-8300    | +1 (425) 882-8080   | +1 (425) 882-8081  | jacksmith@microsoft.com       |
     |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           23 | John         | Gordon       | ---                                              | 69 Salem Street                          | Boston              | MA       | USA            | 2113          | +1 (617) 522-1333   | ---                | johngordon22@yahoo.com        |
     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           44 | Terhi        | Hämäläinen   | ---                                              | Porthaninkatu 9                          | Helsinki            | ---      | Finland        | 00530         | +358 09 870 2000    | ---                | terhi.hamalainen@apple.fi     |
     |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           34 | João         | Fernandes    | ---                                              | Rua da Assunção 53                       | Lisbon              | ---      | Portugal       | ---           | +351 (213) 466-111  | ---                | jfernandes@yahoo.pt           |
     |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |           14 | Mark         | Philips      | Telus                                            | 8210 111 ST NW                           | Edmonton            | AB       | Canada         | T6G 2C7       | +1 (780) 434-4554   | +1 (780) 434-5565  | mphilips12@shaw.ca            |
     |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |           57 | Luis         | Rojas        | ---                                              | Calle Lira, 198                          | Santiago            | ---      | Chile          | ---           | +56 (0)2 635 4444   | ---                | luisrojas@yahoo.cl            |
     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           43 | Isabelle     | Mercier      | ---                                              | 68, Rue Jouvence                         | Dijon               | ---      | France         | 21000         | +33 03 80 73 66 99  | ---                | isabelle_mercier@apple.fr     |
     |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           40 | Dominique    | Lefebvre     | ---                                              | 8, Rue Hanovre                           | Paris               | ---      | France         | 75002         | +33 01 47 42 71 71  | ---                | dominiquelefebvre@gmail.com   |
     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           33 | Ellie        | Sullivan     | ---                                              | 5112 48 Street                           | Yellowknife         | NT       | Canada         | X1A 1N6       | +1 (867) 920-2233   | ---                | ellie.sullivan@shaw.ca        |
     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           45 | Ladislav     | Kovács       | ---                                              | Erzsébet krt. 58.                        | Budapest            | ---      | Hungary        | H-1073        | ---                 | ---                | ladislav_kovacs@apple.hu      |
     |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |           21 | Kathy        | Chase        | ---                                              | 801 W 4th Street                         | Reno                | NV       | USA            | 89503         | +1 (775) 223-7665   | ---                | kachase@hotmail.com           |
     |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           13 | Fernanda     | Ramos        | ---                                              | Qe 7 Bloco G                             | Brasília            | DF       | Brazil         | 71020-677     | +55 (61) 3363-5547  | +55 (61) 3363-7855 | fernadaramos4@uol.com.br      |
     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           30 | Edward       | Francis      | ---                                              | 230 Elgin Street                         | Ottawa              | ON       | Canada         | K2P 1L7       | +1 (613) 234-3322   | ---                | edfrancis@yachoo.ca           |
     |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |            9 | Kara         | Nielsen      | ---                                              | Sønder Boulevard 51                      | Copenhagen          | ---      | Denmark        | 1720          | +453 3331 9991      | ---                | kara.nielsen@jubii.dk         |
     |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |            2 | Leonie       | Köhler       | ---                                              | Theodor-Heuss-Straße 34                  | Stuttgart           | ---      | Germany        | 70174         | +49 0711 2842222    | ---                | leonekohler@surfeu.de         |
     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           38 | Niklas       | Schröder     | ---                                              | Barbarossastraße 19                      | Berlin              | ---      | Germany        | 10779         | +49 030 2141444     | ---                | nschroder@surfeu.de           |
     |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |           47 | Lucas        | Mancini      | ---                                              | Via Degli Scipioni, 43                   | Rome                | RM       | Italy          | 00192         | +39 06 39733434     | ---                | lucas.mancini@yahoo.it        |
     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           53 | Phil         | Hughes       | ---                                              | 113 Lupus St                             | London              | ---      | United Kingdom | SW1V 3EN      | +44 020 7976 5722   | ---                | phil.hughes@gmail.com         |
     |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |           54 | Steve        | Murray       | ---                                              | 110 Raeburn Pl                           | Edinburgh           | ---      | United Kingdom | EH4 1HH       | +44 0131 315 3300   | ---                | steve.murray@yahoo.uk         |
     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           58 | Manoj        | Pareek       | ---                                              | 12,Community Centre                      | Delhi               | ---      | India          | 110017        | +91 0124 39883988   | ---                | manoj.pareek@rediff.com       |
     |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |           36 | Hannah       | Schneider    | ---                                              | Tauentzienstraße 8                       | Berlin              | ---      | Germany        | 10789         | +49 030 26550280    | ---                | hannah.schneider@yahoo.de     |
     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           46 | Hugh         | O'Reilly     | ---                                              | 3 Chatham Street                         | Dublin              | Dublin   | Ireland        | ---           | +353 01 6792424     | ---                | hughoreilly@apple.ie          |
     |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |           48 | Johannes     | Van der Berg | ---                                              | Lijnbaansgracht 120bg                    | Amsterdam           | VV       | Netherlands    | 1016          | +31 020 6223130     | ---                | johavanderberg@yahoo.nl       |
     |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |           11 | Alexandre    | Rocha        | Banco do Brasil S.A.                             | Av. Paulista, 2022                       | São Paulo           | SP       | Brazil         | 01310-200     | +55 (11) 3055-3278  | +55 (11) 3055-8131 | alero@uol.com.br              |
     |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |           28 | Julia        | Barnett      | ---                                              | 302 S 700 E                              | Salt Lake City      | UT       | USA            | 84102         | +1 (801) 531-7272   | ---                | jubarnett@gmail.com           |
     |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |            6 | Helena       | Holý         | ---                                              | Rilská 3174/6                            | Prague              | ---      | Czech Republic | 14300         | +420 2 4177 0449    | ---                | hholy@gmail.com               |
     |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           39 | Camille      | Bernard      | ---                                              | 4, Rue Milton                            | Paris               | ---      | France         | 75009         | +33 01 49 70 65 65  | ---                | camille.bernard@yahoo.fr      |
     |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           16 | Frank        | Harris       | Google Inc.                                      | 1600 Amphitheatre Parkway                | Mountain View       | CA       | USA            | 94043-1351    | +1 (650) 253-0000   | +1 (650) 253-0000  | fharris@google.com            |
     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           24 | Frank        | Ralston      | ---                                              | 162 E Superior Street                    | Chicago             | IL       | USA            | 60611         | +1 (312) 332-3232   | ---                | fralston@gmail.com            |
     |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |            8 | Daan         | Peeters      | ---                                              | Grétrystraat 63                          | Brussels            | ---      | Belgium        | 1000          | +32 02 219 03 03    | ---                | daan_peeters@apple.be         |
     |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |           51 | Joakim       | Johansson    | ---                                              | Celsiusg. 9                              | Stockholm           | ---      | Sweden         | 11230         | +46 08-651 52 52    | ---                | joakim.johansson@yahoo.se     |
     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           42 | Wyatt        | Girard       | ---                                              | 9, Place Louis Barthou                   | Bordeaux            | ---      | France         | 33000         | +33 05 56 96 96 96  | ---                | wyatt.girard@yahoo.fr         |
     |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |            4 | Bjørn        | Hansen       | ---                                              | Ullevålsveien 14                         | Oslo                | ---      | Norway         | 0171          | +47 22 44 22 22     | ---                | bjorn.hansen@yahoo.no         |
     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           18 | Michelle     | Brooks       | ---                                              | 627 Broadway                             | New York            | NY       | USA            | 10012-2612    | +1 (212) 221-3546   | +1 (212) 221-4679  | michelleb@aol.com             |
     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           59 | Puja         | Srivastava   | ---                                              | 3,Raj Bhavan Road                        | Bangalore           | ---      | India          | 560001        | +91 080 22289999    | ---                | puja_srivastava@yahoo.in      |
     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           52 | Emma         | Jones        | ---                                              | 202 Hoxton Street                        | London              | ---      | United Kingdom | N1 5LH        | +44 020 7707 0707   | ---                | emma_jones@hotmail.com        |
     |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |           25 | Victor       | Stevens      | ---                                              | 319 N. Frances Street                    | Madison             | WI       | USA            | 53703         | +1 (608) 257-0597   | ---                | vstevens@yahoo.com            |
     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |            3 | François     | Tremblay     | ---                                              | 1498 rue Bélanger                        | Montréal            | QC       | Canada         | H2G 1A7       | +1 (514) 721-4711   | ---                | ftremblay@gmail.com           |
     |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |            5 | František    | Wichterlová  | JetBrains s.r.o.                                 | Klanova 9/506                            | Prague              | ---      | Czech Republic | 14700         | +420 2 4172 5555    | +420 2 4172 5555   | frantisekw@jetbrains.com      |
     |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           32 | Aaron        | Mitchell     | ---                                              | 696 Osborne Street                       | Winnipeg            | MB       | Canada         | R3L 2B9       | +1 (204) 452-6452   | ---                | aaronmitchell@yahoo.ca        |
     |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |           31 | Martha       | Silk         | ---                                              | 194A Chain Lake Drive                    | Halifax             | NS       | Canada         | B3S 1C5       | +1 (902) 450-0450   | ---                | marthasilk@gmail.com          |
     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           37 | Fynn         | Zimmermann   | ---                                              | Berger Straße 10                         | Frankfurt           | ---      | Germany        | 60316         | +49 069 40598889    | ---                | fzimmermann@yahoo.de          |
     |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           35 | Madalena     | Sampaio      | ---                                              | Rua dos Campeões Europeus de Viena, 4350 | Porto               | ---      | Portugal       | ---           | +351 (225) 022-448  | ---                | masampaio@sapo.pt             |
     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |            1 | Luís         | Gonçalves    | Embraer - Empresa Brasileira de Aeronáutica S.A. | Av. Brigadeiro Faria Lima, 2170          | São José dos Campos | SP       | Brazil         | 12227-000     | +55 (12) 3923-5555  | +55 (12) 3923-5566 | luisg@embraer.com.br          |
     |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |            7 | Astrid       | Gruber       | ---                                              | Rotenturmstraße 4, 1010 Innere Stadt     | Vienne              | ---      | Austria        | 1010          | +43 01 5134505      | ---                | astrid.gruber@apple.at        |
     #+end_example

     #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports none
SELECT DISTINCT EmployeeId,
       		Employee.LastName AS eLastName,
		Employee.FirstName AS eFirstName,
		Employee.Title AS eTitle,
		Employee.ReportsTo AS eReportsTo,
		Employee.BirthDate AS eBirthDate,
		Employee.HireDate AS eHireDate,
		Employee.Address AS eAddress,
		Employee.City AS eCity,
		Employee.State AS eState,
		Employee.Country AS eCountry,
		Employee.PostalCode AS ePostalCode,
		Employee.Phone AS ePhone,
		Employee.Fax AS eFax,
		Employee.Email AS eEmail,
		Customer.CustomerId AS cCustomerId,
		Customer.FirstName AS cFirstName,
		Customer.LastName AS cLastName,
		Customer.Company AS cCompany,
		Customer.Address AS cAddress,
		Customer.City AS cCity,
		Customer.State AS cState,
		Customer.Country AS cCountry,
		Customer.PostalCode AS cPostalCode,
		Customer.Phone AS cPhone,
		Customer.Fax AS cFax,
		Customer.Email AS cEmail
FROM Employee JOIN Customer
ON Employee.EmployeeId = Customer.SupportRepId;
     #+END_SRC
***** Semijoin Left
    #+BEGIN_SRC python :noweb yes :exports code
<<setup>>
cn = customer.rename({"SupportRepId": "EmployeeId", "LastName": "cLastName",
                      "FirstName": "cFirstName", "Company": "cCompany",
                      "Address": "cAddress", "City": "cCity", "State": "cState",
                      "Country": "cCountry", "PostalCode": "cPostalCode",
                      "Phone": "cPhone", "Fax": "cFax", "Email": "cEmail"})
jn = employee.semijoin_left(cn)
return str(RelationOrg(jn))
    #+END_SRC

    #+RESULTS:
    : |   EmployeeId | LastName   | FirstName   | Title               |   ReportsTo | BirthDate   | HireDate   | Address          | City    | State   | Country   | PostalCode   | Phone             | Fax               | Email                    |
    : |--------------+------------+-------------+---------------------+-------------+-------------+------------+------------------+---------+---------+-----------+--------------+-------------------+-------------------+--------------------------|
    : |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    : |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    : |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |

    #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports none
SELECT DISTINCT EmployeeId,
       		Employee.LastName AS eLastName,
		Employee.FirstName AS eFirstName,
		Employee.Title AS eTitle,
		Employee.ReportsTo AS eReportsTo,
		Employee.BirthDate AS eBirthDate,
		Employee.HireDate AS eHireDate,
		Employee.Address AS eAddress,
		Employee.City AS eCity,
		Employee.State AS eState,
		Employee.Country AS eCountry,
		Employee.PostalCode AS ePostalCode,
		Employee.Phone AS ePhone,
		Employee.Fax AS eFax,
		Employee.Email AS eEmail
FROM Employee JOIN Customer
ON Employee.EmployeeId = Customer.SupportRepId;
    #+END_SRC

    #+RESULTS:
    | 3 | Peacock | Jane     | Sales Support Agent | 2 | 1973-08-29 00:00:00 | 2002-04-01 00:00:00 | 1111 6 Ave SW    | Calgary | AB | Canada | T2P 5M5 | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    | 4 | Park    | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    | 5 | Johnson | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave     | Calgary | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |

***** Semijoin Right
    #+BEGIN_SRC python :noweb yes :exports code
<<setup>>
cn = customer.rename({"SupportRepId": "EmployeeId", "LastName": "cLastName",
                      "FirstName": "cFirstName", "Company": "cCompany",
                      "Address": "cAddress", "City": "cCity", "State": "cState",
                      "Country": "cCountry", "PostalCode": "cPostalCode",
                      "Phone": "cPhone", "Fax": "cFax", "Email": "cEmail"})
jn = employee.semijoin_right(cn)
return str(RelationOrg(jn))
    #+END_SRC

    #+RESULTS:
    #+begin_example
    |   CustomerId | cFirstName   | cLastName    | cCompany                                         | cAddress                                 | cCity               | cState   | cCountry       | cPostalCode   | cPhone              | cFax               | cEmail                        |   EmployeeId |
    |--------------+--------------+--------------+--------------------------------------------------+------------------------------------------+---------------------+----------+----------------+---------------+---------------------+--------------------+-------------------------------+--------------|
    |           33 | Ellie        | Sullivan     | ---                                              | 5112 48 Street                           | Yellowknife         | NT       | Canada         | X1A 1N6       | +1 (867) 920-2233   | ---                | ellie.sullivan@shaw.ca        |            3 |
    |           36 | Hannah       | Schneider    | ---                                              | Tauentzienstraße 8                       | Berlin              | ---      | Germany        | 10789         | +49 030 26550280    | ---                | hannah.schneider@yahoo.de     |            5 |
    |           56 | Diego        | Gutiérrez    | ---                                              | 307 Macacha Güemes                       | Buenos Aires        | ---      | Argentina      | 1106          | +54 (0)11 4311 4333 | ---                | diego.gutierrez@yahoo.ar      |            4 |
    |           14 | Mark         | Philips      | Telus                                            | 8210 111 ST NW                           | Edmonton            | AB       | Canada         | T6G 2C7       | +1 (780) 434-4554   | +1 (780) 434-5565  | mphilips12@shaw.ca            |            5 |
    |           17 | Jack         | Smith        | Microsoft Corporation                            | 1 Microsoft Way                          | Redmond             | WA       | USA            | 98052-8300    | +1 (425) 882-8080   | +1 (425) 882-8081  | jacksmith@microsoft.com       |            5 |
    |           20 | Dan          | Miller       | ---                                              | 541 Del Medio Avenue                     | Mountain View       | CA       | USA            | 94040-111     | +1 (650) 644-3358   | ---                | dmiller@comcast.com           |            4 |
    |           37 | Fynn         | Zimmermann   | ---                                              | Berger Straße 10                         | Frankfurt           | ---      | Germany        | 60316         | +49 069 40598889    | ---                | fzimmermann@yahoo.de          |            3 |
    |            1 | Luís         | Gonçalves    | Embraer - Empresa Brasileira de Aeronáutica S.A. | Av. Brigadeiro Faria Lima, 2170          | São José dos Campos | SP       | Brazil         | 12227-000     | +55 (12) 3923-5555  | +55 (12) 3923-5566 | luisg@embraer.com.br          |            3 |
    |           39 | Camille      | Bernard      | ---                                              | 4, Rue Milton                            | Paris               | ---      | France         | 75009         | +33 01 49 70 65 65  | ---                | camille.bernard@yahoo.fr      |            4 |
    |           12 | Roberto      | Almeida      | Riotur                                           | Praça Pio X, 119                         | Rio de Janeiro      | RJ       | Brazil         | 20040-020     | +55 (21) 2271-7000  | +55 (21) 2271-7070 | roberto.almeida@riotur.gov.br |            3 |
    |           51 | Joakim       | Johansson    | ---                                              | Celsiusg. 9                              | Stockholm           | ---      | Sweden         | 11230         | +46 08-651 52 52    | ---                | joakim.johansson@yahoo.se     |            5 |
    |           54 | Steve        | Murray       | ---                                              | 110 Raeburn Pl                           | Edinburgh           | ---      | United Kingdom | EH4 1HH       | +44 0131 315 3300   | ---                | steve.murray@yahoo.uk         |            5 |
    |           48 | Johannes     | Van der Berg | ---                                              | Lijnbaansgracht 120bg                    | Amsterdam           | VV       | Netherlands    | 1016          | +31 020 6223130     | ---                | johavanderberg@yahoo.nl       |            5 |
    |           46 | Hugh         | O'Reilly     | ---                                              | 3 Chatham Street                         | Dublin              | Dublin   | Ireland        | ---           | +353 01 6792424     | ---                | hughoreilly@apple.ie          |            3 |
    |           57 | Luis         | Rojas        | ---                                              | Calle Lira, 198                          | Santiago            | ---      | Chile          | ---           | +56 (0)2 635 4444   | ---                | luisrojas@yahoo.cl            |            5 |
    |            3 | François     | Tremblay     | ---                                              | 1498 rue Bélanger                        | Montréal            | QC       | Canada         | H2G 1A7       | +1 (514) 721-4711   | ---                | ftremblay@gmail.com           |            3 |
    |           28 | Julia        | Barnett      | ---                                              | 302 S 700 E                              | Salt Lake City      | UT       | USA            | 84102         | +1 (801) 531-7272   | ---                | jubarnett@gmail.com           |            5 |
    |           45 | Ladislav     | Kovács       | ---                                              | Erzsébet krt. 58.                        | Budapest            | ---      | Hungary        | H-1073        | ---                 | ---                | ladislav_kovacs@apple.hu      |            3 |
    |            4 | Bjørn        | Hansen       | ---                                              | Ullevålsveien 14                         | Oslo                | ---      | Norway         | 0171          | +47 22 44 22 22     | ---                | bjorn.hansen@yahoo.no         |            4 |
    |           30 | Edward       | Francis      | ---                                              | 230 Elgin Street                         | Ottawa              | ON       | Canada         | K2P 1L7       | +1 (613) 234-3322   | ---                | edfrancis@yachoo.ca           |            3 |
    |           11 | Alexandre    | Rocha        | Banco do Brasil S.A.                             | Av. Paulista, 2022                       | São Paulo           | SP       | Brazil         | 01310-200     | +55 (11) 3055-3278  | +55 (11) 3055-8131 | alero@uol.com.br              |            5 |
    |           50 | Enrique      | Muñoz        | ---                                              | C/ San Bernardo 85                       | Madrid              | ---      | Spain          | 28015         | +34 914 454 454     | ---                | enrique_munoz@yahoo.es        |            5 |
    |           22 | Heather      | Leacock      | ---                                              | 120 S Orange Ave                         | Orlando             | FL       | USA            | 32801         | +1 (407) 999-7788   | ---                | hleacock@gmail.com            |            4 |
    |            9 | Kara         | Nielsen      | ---                                              | Sønder Boulevard 51                      | Copenhagen          | ---      | Denmark        | 1720          | +453 3331 9991      | ---                | kara.nielsen@jubii.dk         |            4 |
    |           34 | João         | Fernandes    | ---                                              | Rua da Assunção 53                       | Lisbon              | ---      | Portugal       | ---           | +351 (213) 466-111  | ---                | jfernandes@yahoo.pt           |            4 |
    |           58 | Manoj        | Pareek       | ---                                              | 12,Community Centre                      | Delhi               | ---      | India          | 110017        | +91 0124 39883988   | ---                | manoj.pareek@rediff.com       |            3 |
    |           15 | Jennifer     | Peterson     | Rogers Canada                                    | 700 W Pender Street                      | Vancouver           | BC       | Canada         | V6C 1G8       | +1 (604) 688-2255   | +1 (604) 688-8756  | jenniferp@rogers.ca           |            3 |
    |           13 | Fernanda     | Ramos        | ---                                              | Qe 7 Bloco G                             | Brasília            | DF       | Brazil         | 71020-677     | +55 (61) 3363-5547  | +55 (61) 3363-7855 | fernadaramos4@uol.com.br      |            4 |
    |            2 | Leonie       | Köhler       | ---                                              | Theodor-Heuss-Straße 34                  | Stuttgart           | ---      | Germany        | 70174         | +49 0711 2842222    | ---                | leonekohler@surfeu.de         |            5 |
    |           47 | Lucas        | Mancini      | ---                                              | Via Degli Scipioni, 43                   | Rome                | RM       | Italy          | 00192         | +39 06 39733434     | ---                | lucas.mancini@yahoo.it        |            5 |
    |           18 | Michelle     | Brooks       | ---                                              | 627 Broadway                             | New York            | NY       | USA            | 10012-2612    | +1 (212) 221-3546   | +1 (212) 221-4679  | michelleb@aol.com             |            3 |
    |           31 | Martha       | Silk         | ---                                              | 194A Chain Lake Drive                    | Halifax             | NS       | Canada         | B3S 1C5       | +1 (902) 450-0450   | ---                | marthasilk@gmail.com          |            5 |
    |           29 | Robert       | Brown        | ---                                              | 796 Dundas Street West                   | Toronto             | ON       | Canada         | M6J 1V1       | +1 (416) 363-8888   | ---                | robbrown@shaw.ca              |            3 |
    |            6 | Helena       | Holý         | ---                                              | Rilská 3174/6                            | Prague              | ---      | Czech Republic | 14300         | +420 2 4177 0449    | ---                | hholy@gmail.com               |            5 |
    |           42 | Wyatt        | Girard       | ---                                              | 9, Place Louis Barthou                   | Bordeaux            | ---      | France         | 33000         | +33 05 56 96 96 96  | ---                | wyatt.girard@yahoo.fr         |            3 |
    |           52 | Emma         | Jones        | ---                                              | 202 Hoxton Street                        | London              | ---      | United Kingdom | N1 5LH        | +44 020 7707 0707   | ---                | emma_jones@hotmail.com        |            3 |
    |           49 | Stanisław    | Wójcik       | ---                                              | Ordynacka 10                             | Warsaw              | ---      | Poland         | 00-358        | +48 22 828 37 39    | ---                | stanisław.wójcik@wp.pl        |            4 |
    |           53 | Phil         | Hughes       | ---                                              | 113 Lupus St                             | London              | ---      | United Kingdom | SW1V 3EN      | +44 020 7976 5722   | ---                | phil.hughes@gmail.com         |            3 |
    |           27 | Patrick      | Gray         | ---                                              | 1033 N Park Ave                          | Tucson              | AZ       | USA            | 85719         | +1 (520) 622-4200   | ---                | patrick.gray@aol.com          |            4 |
    |           40 | Dominique    | Lefebvre     | ---                                              | 8, Rue Hanovre                           | Paris               | ---      | France         | 75002         | +33 01 47 42 71 71  | ---                | dominiquelefebvre@gmail.com   |            4 |
    |           16 | Frank        | Harris       | Google Inc.                                      | 1600 Amphitheatre Parkway                | Mountain View       | CA       | USA            | 94043-1351    | +1 (650) 253-0000   | +1 (650) 253-0000  | fharris@google.com            |            4 |
    |           24 | Frank        | Ralston      | ---                                              | 162 E Superior Street                    | Chicago             | IL       | USA            | 60611         | +1 (312) 332-3232   | ---                | fralston@gmail.com            |            3 |
    |           59 | Puja         | Srivastava   | ---                                              | 3,Raj Bhavan Road                        | Bangalore           | ---      | India          | 560001        | +91 080 22289999    | ---                | puja_srivastava@yahoo.in      |            3 |
    |           41 | Marc         | Dubois       | ---                                              | 11, Place Bellecour                      | Lyon                | ---      | France         | 69002         | +33 04 78 30 30 30  | ---                | marc.dubois@hotmail.com       |            5 |
    |           25 | Victor       | Stevens      | ---                                              | 319 N. Frances Street                    | Madison             | WI       | USA            | 53703         | +1 (608) 257-0597   | ---                | vstevens@yahoo.com            |            5 |
    |           44 | Terhi        | Hämäläinen   | ---                                              | Porthaninkatu 9                          | Helsinki            | ---      | Finland        | 00530         | +358 09 870 2000    | ---                | terhi.hamalainen@apple.fi     |            3 |
    |           35 | Madalena     | Sampaio      | ---                                              | Rua dos Campeões Europeus de Viena, 4350 | Porto               | ---      | Portugal       | ---           | +351 (225) 022-448  | ---                | masampaio@sapo.pt             |            4 |
    |           43 | Isabelle     | Mercier      | ---                                              | 68, Rue Jouvence                         | Dijon               | ---      | France         | 21000         | +33 03 80 73 66 99  | ---                | isabelle_mercier@apple.fr     |            3 |
    |           55 | Mark         | Taylor       | ---                                              | 421 Bourke Street                        | Sidney              | NSW      | Australia      | 2010          | +61 (02) 9332 3633  | ---                | mark.taylor@yahoo.au          |            4 |
    |           21 | Kathy        | Chase        | ---                                              | 801 W 4th Street                         | Reno                | NV       | USA            | 89503         | +1 (775) 223-7665   | ---                | kachase@hotmail.com           |            5 |
    |           23 | John         | Gordon       | ---                                              | 69 Salem Street                          | Boston              | MA       | USA            | 2113          | +1 (617) 522-1333   | ---                | johngordon22@yahoo.com        |            4 |
    |            7 | Astrid       | Gruber       | ---                                              | Rotenturmstraße 4, 1010 Innere Stadt     | Vienne              | ---      | Austria        | 1010          | +43 01 5134505      | ---                | astrid.gruber@apple.at        |            5 |
    |           32 | Aaron        | Mitchell     | ---                                              | 696 Osborne Street                       | Winnipeg            | MB       | Canada         | R3L 2B9       | +1 (204) 452-6452   | ---                | aaronmitchell@yahoo.ca        |            4 |
    |           26 | Richard      | Cunningham   | ---                                              | 2211 W Berry Street                      | Fort Worth          | TX       | USA            | 76110         | +1 (817) 924-7272   | ---                | ricunningham@hotmail.com      |            4 |
    |           19 | Tim          | Goyer        | Apple Inc.                                       | 1 Infinite Loop                          | Cupertino           | CA       | USA            | 95014         | +1 (408) 996-1010   | +1 (408) 996-1011  | tgoyer@apple.com              |            3 |
    |           38 | Niklas       | Schröder     | ---                                              | Barbarossastraße 19                      | Berlin              | ---      | Germany        | 10779         | +49 030 2141444     | ---                | nschroder@surfeu.de           |            3 |
    |            5 | František    | Wichterlová  | JetBrains s.r.o.                                 | Klanova 9/506                            | Prague              | ---      | Czech Republic | 14700         | +420 2 4172 5555    | +420 2 4172 5555   | frantisekw@jetbrains.com      |            4 |
    |            8 | Daan         | Peeters      | ---                                              | Grétrystraat 63                          | Brussels            | ---      | Belgium        | 1000          | +32 02 219 03 03    | ---                | daan_peeters@apple.be         |            4 |
    |           10 | Eduardo      | Martins      | Woodstock Discos                                 | Rua Dr. Falcão Filho, 155                | São Paulo           | SP       | Brazil         | 01007-010     | +55 (11) 3033-5446  | +55 (11) 3033-4564 | eduardo@woodstock.com.br      |            4 |
    #+end_example

    #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports none
SELECT DISTINCT EmployeeId,
		Customer.CustomerId AS cCustomerId,
		Customer.FirstName AS cFirstName,
		Customer.LastName AS cLastName,
		Customer.Company AS cCompany,
		Customer.Address AS cAddress,
		Customer.City AS cCity,
		Customer.State AS cState,
		Customer.Country AS cCountry,
		Customer.PostalCode AS cPostalCode,
		Customer.Phone AS cPhone,
		Customer.Fax AS cFax,
		Customer.Email AS cEmail
FROM Employee JOIN Customer
ON Employee.EmployeeId = Customer.SupportRepId;
    #+END_SRC

    #+RESULTS:
    | 3 |  1 | Luís      | Gonçalves    | Embraer - Empresa Brasileira de Aeronáutica S.A. | Av. Brigadeiro Faria Lima, 2170          | São José dos Campos | SP     | Brazil         |  12227-000 | +55 (12) 3923-5555  | +55 (12) 3923-5566 | luisg@embraer.com.br          |
    | 5 |  2 | Leonie    | Köhler       |                                                  | Theodor-Heuss-Straße 34                  | Stuttgart           |        | Germany        |      70174 | +49 0711 2842222    |                    | leonekohler@surfeu.de         |
    | 3 |  3 | François  | Tremblay     |                                                  | 1498 rue Bélanger                        | Montréal            | QC     | Canada         |    H2G 1A7 | +1 (514) 721-4711   |                    | ftremblay@gmail.com           |
    | 4 |  4 | Bjørn     | Hansen       |                                                  | Ullevålsveien 14                         | Oslo                |        | Norway         |        171 | +47 22 44 22 22     |                    | bjorn.hansen@yahoo.no         |
    | 4 |  5 | František | Wichterlová  | JetBrains s.r.o.                                 | Klanova 9/506                            | Prague              |        | Czech Republic |      14700 | +420 2 4172 5555    | +420 2 4172 5555   | frantisekw@jetbrains.com      |
    | 5 |  6 | Helena    | Holý         |                                                  | Rilská 3174/6                            | Prague              |        | Czech Republic |      14300 | +420 2 4177 0449    |                    | hholy@gmail.com               |
    | 5 |  7 | Astrid    | Gruber       |                                                  | Rotenturmstraße 4, 1010 Innere Stadt     | Vienne              |        | Austria        |       1010 | +43 01 5134505      |                    | astrid.gruber@apple.at        |
    | 4 |  8 | Daan      | Peeters      |                                                  | Grétrystraat 63                          | Brussels            |        | Belgium        |       1000 | +32 02 219 03 03    |                    | daan_peeters@apple.be         |
    | 4 |  9 | Kara      | Nielsen      |                                                  | Sønder Boulevard 51                      | Copenhagen          |        | Denmark        |       1720 | +453 3331 9991      |                    | kara.nielsen@jubii.dk         |
    | 4 | 10 | Eduardo   | Martins      | Woodstock Discos                                 | Rua Dr. Falcão Filho, 155                | São Paulo           | SP     | Brazil         |  01007-010 | +55 (11) 3033-5446  | +55 (11) 3033-4564 | eduardo@woodstock.com.br      |
    | 5 | 11 | Alexandre | Rocha        | Banco do Brasil S.A.                             | Av. Paulista, 2022                       | São Paulo           | SP     | Brazil         |  01310-200 | +55 (11) 3055-3278  | +55 (11) 3055-8131 | alero@uol.com.br              |
    | 3 | 12 | Roberto   | Almeida      | Riotur                                           | Praça Pio X, 119                         | Rio de Janeiro      | RJ     | Brazil         |  20040-020 | +55 (21) 2271-7000  | +55 (21) 2271-7070 | roberto.almeida@riotur.gov.br |
    | 4 | 13 | Fernanda  | Ramos        |                                                  | Qe 7 Bloco G                             | Brasília            | DF     | Brazil         |  71020-677 | +55 (61) 3363-5547  | +55 (61) 3363-7855 | fernadaramos4@uol.com.br      |
    | 5 | 14 | Mark      | Philips      | Telus                                            | 8210 111 ST NW                           | Edmonton            | AB     | Canada         |    T6G 2C7 | +1 (780) 434-4554   | +1 (780) 434-5565  | mphilips12@shaw.ca            |
    | 3 | 15 | Jennifer  | Peterson     | Rogers Canada                                    | 700 W Pender Street                      | Vancouver           | BC     | Canada         |    V6C 1G8 | +1 (604) 688-2255   | +1 (604) 688-8756  | jenniferp@rogers.ca           |
    | 4 | 16 | Frank     | Harris       | Google Inc.                                      | 1600 Amphitheatre Parkway                | Mountain View       | CA     | USA            | 94043-1351 | +1 (650) 253-0000   | +1 (650) 253-0000  | fharris@google.com            |
    | 5 | 17 | Jack      | Smith        | Microsoft Corporation                            | 1 Microsoft Way                          | Redmond             | WA     | USA            | 98052-8300 | +1 (425) 882-8080   | +1 (425) 882-8081  | jacksmith@microsoft.com       |
    | 3 | 18 | Michelle  | Brooks       |                                                  | 627 Broadway                             | New York            | NY     | USA            | 10012-2612 | +1 (212) 221-3546   | +1 (212) 221-4679  | michelleb@aol.com             |
    | 3 | 19 | Tim       | Goyer        | Apple Inc.                                       | 1 Infinite Loop                          | Cupertino           | CA     | USA            |      95014 | +1 (408) 996-1010   | +1 (408) 996-1011  | tgoyer@apple.com              |
    | 4 | 20 | Dan       | Miller       |                                                  | 541 Del Medio Avenue                     | Mountain View       | CA     | USA            |  94040-111 | +1 (650) 644-3358   |                    | dmiller@comcast.com           |
    | 5 | 21 | Kathy     | Chase        |                                                  | 801 W 4th Street                         | Reno                | NV     | USA            |      89503 | +1 (775) 223-7665   |                    | kachase@hotmail.com           |
    | 4 | 22 | Heather   | Leacock      |                                                  | 120 S Orange Ave                         | Orlando             | FL     | USA            |      32801 | +1 (407) 999-7788   |                    | hleacock@gmail.com            |
    | 4 | 23 | John      | Gordon       |                                                  | 69 Salem Street                          | Boston              | MA     | USA            |       2113 | +1 (617) 522-1333   |                    | johngordon22@yahoo.com        |
    | 3 | 24 | Frank     | Ralston      |                                                  | 162 E Superior Street                    | Chicago             | IL     | USA            |      60611 | +1 (312) 332-3232   |                    | fralston@gmail.com            |
    | 5 | 25 | Victor    | Stevens      |                                                  | 319 N. Frances Street                    | Madison             | WI     | USA            |      53703 | +1 (608) 257-0597   |                    | vstevens@yahoo.com            |
    | 4 | 26 | Richard   | Cunningham   |                                                  | 2211 W Berry Street                      | Fort Worth          | TX     | USA            |      76110 | +1 (817) 924-7272   |                    | ricunningham@hotmail.com      |
    | 4 | 27 | Patrick   | Gray         |                                                  | 1033 N Park Ave                          | Tucson              | AZ     | USA            |      85719 | +1 (520) 622-4200   |                    | patrick.gray@aol.com          |
    | 5 | 28 | Julia     | Barnett      |                                                  | 302 S 700 E                              | Salt Lake City      | UT     | USA            |      84102 | +1 (801) 531-7272   |                    | jubarnett@gmail.com           |
    | 3 | 29 | Robert    | Brown        |                                                  | 796 Dundas Street West                   | Toronto             | ON     | Canada         |    M6J 1V1 | +1 (416) 363-8888   |                    | robbrown@shaw.ca              |
    | 3 | 30 | Edward    | Francis      |                                                  | 230 Elgin Street                         | Ottawa              | ON     | Canada         |    K2P 1L7 | +1 (613) 234-3322   |                    | edfrancis@yachoo.ca           |
    | 5 | 31 | Martha    | Silk         |                                                  | 194A Chain Lake Drive                    | Halifax             | NS     | Canada         |    B3S 1C5 | +1 (902) 450-0450   |                    | marthasilk@gmail.com          |
    | 4 | 32 | Aaron     | Mitchell     |                                                  | 696 Osborne Street                       | Winnipeg            | MB     | Canada         |    R3L 2B9 | +1 (204) 452-6452   |                    | aaronmitchell@yahoo.ca        |
    | 3 | 33 | Ellie     | Sullivan     |                                                  | 5112 48 Street                           | Yellowknife         | NT     | Canada         |    X1A 1N6 | +1 (867) 920-2233   |                    | ellie.sullivan@shaw.ca        |
    | 4 | 34 | João      | Fernandes    |                                                  | Rua da Assunção 53                       | Lisbon              |        | Portugal       |            | +351 (213) 466-111  |                    | jfernandes@yahoo.pt           |
    | 4 | 35 | Madalena  | Sampaio      |                                                  | Rua dos Campeões Europeus de Viena, 4350 | Porto               |        | Portugal       |            | +351 (225) 022-448  |                    | masampaio@sapo.pt             |
    | 5 | 36 | Hannah    | Schneider    |                                                  | Tauentzienstraße 8                       | Berlin              |        | Germany        |      10789 | +49 030 26550280    |                    | hannah.schneider@yahoo.de     |
    | 3 | 37 | Fynn      | Zimmermann   |                                                  | Berger Straße 10                         | Frankfurt           |        | Germany        |      60316 | +49 069 40598889    |                    | fzimmermann@yahoo.de          |
    | 3 | 38 | Niklas    | Schröder     |                                                  | Barbarossastraße 19                      | Berlin              |        | Germany        |      10779 | +49 030 2141444     |                    | nschroder@surfeu.de           |
    | 4 | 39 | Camille   | Bernard      |                                                  | 4, Rue Milton                            | Paris               |        | France         |      75009 | +33 01 49 70 65 65  |                    | camille.bernard@yahoo.fr      |
    | 4 | 40 | Dominique | Lefebvre     |                                                  | 8, Rue Hanovre                           | Paris               |        | France         |      75002 | +33 01 47 42 71 71  |                    | dominiquelefebvre@gmail.com   |
    | 5 | 41 | Marc      | Dubois       |                                                  | 11, Place Bellecour                      | Lyon                |        | France         |      69002 | +33 04 78 30 30 30  |                    | marc.dubois@hotmail.com       |
    | 3 | 42 | Wyatt     | Girard       |                                                  | 9, Place Louis Barthou                   | Bordeaux            |        | France         |      33000 | +33 05 56 96 96 96  |                    | wyatt.girard@yahoo.fr         |
    | 3 | 43 | Isabelle  | Mercier      |                                                  | 68, Rue Jouvence                         | Dijon               |        | France         |      21000 | +33 03 80 73 66 99  |                    | isabelle_mercier@apple.fr     |
    | 3 | 44 | Terhi     | Hämäläinen   |                                                  | Porthaninkatu 9                          | Helsinki            |        | Finland        |        530 | +358 09 870 2000    |                    | terhi.hamalainen@apple.fi     |
    | 3 | 45 | Ladislav  | Kovács       |                                                  | Erzsébet krt. 58.                        | Budapest            |        | Hungary        |     H-1073 |                     |                    | ladislav_kovacs@apple.hu      |
    | 3 | 46 | Hugh      | O'Reilly     |                                                  | 3 Chatham Street                         | Dublin              | Dublin | Ireland        |            | +353 01 6792424     |                    | hughoreilly@apple.ie          |
    | 5 | 47 | Lucas     | Mancini      |                                                  | Via Degli Scipioni, 43                   | Rome                | RM     | Italy          |        192 | +39 06 39733434     |                    | lucas.mancini@yahoo.it        |
    | 5 | 48 | Johannes  | Van der Berg |                                                  | Lijnbaansgracht 120bg                    | Amsterdam           | VV     | Netherlands    |       1016 | +31 020 6223130     |                    | johavanderberg@yahoo.nl       |
    | 4 | 49 | Stanisław | Wójcik       |                                                  | Ordynacka 10                             | Warsaw              |        | Poland         |     00-358 | +48 22 828 37 39    |                    | stanisław.wójcik@wp.pl        |
    | 5 | 50 | Enrique   | Muñoz        |                                                  | C/ San Bernardo 85                       | Madrid              |        | Spain          |      28015 | +34 914 454 454     |                    | enrique_munoz@yahoo.es        |
    | 5 | 51 | Joakim    | Johansson    |                                                  | Celsiusg. 9                              | Stockholm           |        | Sweden         |      11230 | +46 08-651 52 52    |                    | joakim.johansson@yahoo.se     |
    | 3 | 52 | Emma      | Jones        |                                                  | 202 Hoxton Street                        | London              |        | United Kingdom |     N1 5LH | +44 020 7707 0707   |                    | emma_jones@hotmail.com        |
    | 3 | 53 | Phil      | Hughes       |                                                  | 113 Lupus St                             | London              |        | United Kingdom |   SW1V 3EN | +44 020 7976 5722   |                    | phil.hughes@gmail.com         |
    | 5 | 54 | Steve     | Murray       |                                                  | 110 Raeburn Pl                           | Edinburgh           |        | United Kingdom |    EH4 1HH | +44 0131 315 3300   |                    | steve.murray@yahoo.uk         |
    | 4 | 55 | Mark      | Taylor       |                                                  | 421 Bourke Street                        | Sidney              | NSW    | Australia      |       2010 | +61 (02) 9332 3633  |                    | mark.taylor@yahoo.au          |
    | 4 | 56 | Diego     | Gutiérrez    |                                                  | 307 Macacha Güemes                       | Buenos Aires        |        | Argentina      |       1106 | +54 (0)11 4311 4333 |                    | diego.gutierrez@yahoo.ar      |
    | 5 | 57 | Luis      | Rojas        |                                                  | Calle Lira, 198                          | Santiago            |        | Chile          |            | +56 (0)2 635 4444   |                    | luisrojas@yahoo.cl            |
    | 3 | 58 | Manoj     | Pareek       |                                                  | 12,Community Centre                      | Delhi               |        | India          |     110017 | +91 0124 39883988   |                    | manoj.pareek@rediff.com       |
    | 3 | 59 | Puja      | Srivastava   |                                                  | 3,Raj Bhavan Road                        | Bangalore           |        | India          |     560001 | +91 080 22289999    |                    | puja_srivastava@yahoo.in      |

**** Theta Join
     The thetajoin method requires two arguments; the table to join on and a
     selection argument. Internally, it performs the Cartesian product on
     the two tables and selects those rows from the resulting table satisfying
     the input expression. So all column names must be unique. Refer
     to the section on [[*Selection][Selection]] for details on the selection argument.

    #+BEGIN_SRC python :noweb yes :exports code
<<setup>>
cn = customer.rename({"LastName": "cLastName",
                      "FirstName": "cFirstName", "Company": "cCompany",
                      "Address": "cAddress", "City": "cCity", "State": "cState",
                      "Country": "cCountry", "PostalCode": "cPostalCode",
                      "Phone": "cPhone", "Fax": "cFax", "Email": "cEmail"})
jn = employee.thetajoin(cn, "SupportRepId == 1 + EmployeeId")
return str(RelationOrg(jn))
    #+END_SRC

    #+RESULTS:
    #+begin_example
    |   EmployeeId | LastName   | FirstName   | Title               |   ReportsTo | BirthDate   | HireDate   | Address          | City    | State   | Country   | PostalCode   | Phone             | Fax               | Email                    |   CustomerId | cFirstName   | cLastName    | cCompany                                         | cAddress                                 | cCity               | cState   | cCountry       | cPostalCode   | cPhone              | cFax               | cEmail                        |   SupportRepId |
    |--------------+------------+-------------+---------------------+-------------+-------------+------------+------------------+---------+---------+-----------+--------------+-------------------+-------------------+--------------------------+--------------+--------------+--------------+--------------------------------------------------+------------------------------------------+---------------------+----------+----------------+---------------+---------------------+--------------------+-------------------------------+----------------|
    |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           28 | Julia        | Barnett      | ---                                              | 302 S 700 E                              | Salt Lake City      | UT       | USA            | 84102         | +1 (801) 531-7272   | ---                | jubarnett@gmail.com           |              5 |
    |            2 | Edwards    | Nancy       | Sales Manager       |           1 | 1958-12-08  | 2002-05-01 | 825 8 Ave SW     | Calgary | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |           44 | Terhi        | Hämäläinen   | ---                                              | Porthaninkatu 9                          | Helsinki            | ---      | Finland        | 00530         | +358 09 870 2000    | ---                | terhi.hamalainen@apple.fi     |              3 |
    |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           48 | Johannes     | Van der Berg | ---                                              | Lijnbaansgracht 120bg                    | Amsterdam           | VV       | Netherlands    | 1016          | +31 020 6223130     | ---                | johavanderberg@yahoo.nl       |              5 |
    |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |            4 | Bjørn        | Hansen       | ---                                              | Ullevålsveien 14                         | Oslo                | ---      | Norway         | 0171          | +47 22 44 22 22     | ---                | bjorn.hansen@yahoo.no         |              4 |
    |            2 | Edwards    | Nancy       | Sales Manager       |           1 | 1958-12-08  | 2002-05-01 | 825 8 Ave SW     | Calgary | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |           24 | Frank        | Ralston      | ---                                              | 162 E Superior Street                    | Chicago             | IL       | USA            | 60611         | +1 (312) 332-3232   | ---                | fralston@gmail.com            |              3 |
    |            2 | Edwards    | Nancy       | Sales Manager       |           1 | 1958-12-08  | 2002-05-01 | 825 8 Ave SW     | Calgary | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |           30 | Edward       | Francis      | ---                                              | 230 Elgin Street                         | Ottawa              | ON       | Canada         | K2P 1L7       | +1 (613) 234-3322   | ---                | edfrancis@yachoo.ca           |              3 |
    |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           56 | Diego        | Gutiérrez    | ---                                              | 307 Macacha Güemes                       | Buenos Aires        | ---      | Argentina      | 1106          | +54 (0)11 4311 4333 | ---                | diego.gutierrez@yahoo.ar      |              4 |
    |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           49 | Stanisław    | Wójcik       | ---                                              | Ordynacka 10                             | Warsaw              | ---      | Poland         | 00-358        | +48 22 828 37 39    | ---                | stanisław.wójcik@wp.pl        |              4 |
    |            2 | Edwards    | Nancy       | Sales Manager       |           1 | 1958-12-08  | 2002-05-01 | 825 8 Ave SW     | Calgary | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |           37 | Fynn         | Zimmermann   | ---                                              | Berger Straße 10                         | Frankfurt           | ---      | Germany        | 60316         | +49 069 40598889    | ---                | fzimmermann@yahoo.de          |              3 |
    |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           41 | Marc         | Dubois       | ---                                              | 11, Place Bellecour                      | Lyon                | ---      | France         | 69002         | +33 04 78 30 30 30  | ---                | marc.dubois@hotmail.com       |              5 |
    |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           50 | Enrique      | Muñoz        | ---                                              | C/ San Bernardo 85                       | Madrid              | ---      | Spain          | 28015         | +34 914 454 454     | ---                | enrique_munoz@yahoo.es        |              5 |
    |            2 | Edwards    | Nancy       | Sales Manager       |           1 | 1958-12-08  | 2002-05-01 | 825 8 Ave SW     | Calgary | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |           12 | Roberto      | Almeida      | Riotur                                           | Praça Pio X, 119                         | Rio de Janeiro      | RJ       | Brazil         | 20040-020     | +55 (21) 2271-7000  | +55 (21) 2271-7070 | roberto.almeida@riotur.gov.br |              3 |
    |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           20 | Dan          | Miller       | ---                                              | 541 Del Medio Avenue                     | Mountain View       | CA       | USA            | 94040-111     | +1 (650) 644-3358   | ---                | dmiller@comcast.com           |              4 |
    |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           36 | Hannah       | Schneider    | ---                                              | Tauentzienstraße 8                       | Berlin              | ---      | Germany        | 10789         | +49 030 26550280    | ---                | hannah.schneider@yahoo.de     |              5 |
    |            2 | Edwards    | Nancy       | Sales Manager       |           1 | 1958-12-08  | 2002-05-01 | 825 8 Ave SW     | Calgary | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |           59 | Puja         | Srivastava   | ---                                              | 3,Raj Bhavan Road                        | Bangalore           | ---      | India          | 560001        | +91 080 22289999    | ---                | puja_srivastava@yahoo.in      |              3 |
    |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           57 | Luis         | Rojas        | ---                                              | Calle Lira, 198                          | Santiago            | ---      | Chile          | ---           | +56 (0)2 635 4444   | ---                | luisrojas@yahoo.cl            |              5 |
    |            2 | Edwards    | Nancy       | Sales Manager       |           1 | 1958-12-08  | 2002-05-01 | 825 8 Ave SW     | Calgary | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |           52 | Emma         | Jones        | ---                                              | 202 Hoxton Street                        | London              | ---      | United Kingdom | N1 5LH        | +44 020 7707 0707   | ---                | emma_jones@hotmail.com        |              3 |
    |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           22 | Heather      | Leacock      | ---                                              | 120 S Orange Ave                         | Orlando             | FL       | USA            | 32801         | +1 (407) 999-7788   | ---                | hleacock@gmail.com            |              4 |
    |            2 | Edwards    | Nancy       | Sales Manager       |           1 | 1958-12-08  | 2002-05-01 | 825 8 Ave SW     | Calgary | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |           58 | Manoj        | Pareek       | ---                                              | 12,Community Centre                      | Delhi               | ---      | India          | 110017        | +91 0124 39883988   | ---                | manoj.pareek@rediff.com       |              3 |
    |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           13 | Fernanda     | Ramos        | ---                                              | Qe 7 Bloco G                             | Brasília            | DF       | Brazil         | 71020-677     | +55 (61) 3363-5547  | +55 (61) 3363-7855 | fernadaramos4@uol.com.br      |              4 |
    |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           35 | Madalena     | Sampaio      | ---                                              | Rua dos Campeões Europeus de Viena, 4350 | Porto               | ---      | Portugal       | ---           | +351 (225) 022-448  | ---                | masampaio@sapo.pt             |              4 |
    |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           10 | Eduardo      | Martins      | Woodstock Discos                                 | Rua Dr. Falcão Filho, 155                | São Paulo           | SP       | Brazil         | 01007-010     | +55 (11) 3033-5446  | +55 (11) 3033-4564 | eduardo@woodstock.com.br      |              4 |
    |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           27 | Patrick      | Gray         | ---                                              | 1033 N Park Ave                          | Tucson              | AZ       | USA            | 85719         | +1 (520) 622-4200   | ---                | patrick.gray@aol.com          |              4 |
    |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           25 | Victor       | Stevens      | ---                                              | 319 N. Frances Street                    | Madison             | WI       | USA            | 53703         | +1 (608) 257-0597   | ---                | vstevens@yahoo.com            |              5 |
    |            2 | Edwards    | Nancy       | Sales Manager       |           1 | 1958-12-08  | 2002-05-01 | 825 8 Ave SW     | Calgary | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |           45 | Ladislav     | Kovács       | ---                                              | Erzsébet krt. 58.                        | Budapest            | ---      | Hungary        | H-1073        | ---                 | ---                | ladislav_kovacs@apple.hu      |              3 |
    |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           34 | João         | Fernandes    | ---                                              | Rua da Assunção 53                       | Lisbon              | ---      | Portugal       | ---           | +351 (213) 466-111  | ---                | jfernandes@yahoo.pt           |              4 |
    |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           31 | Martha       | Silk         | ---                                              | 194A Chain Lake Drive                    | Halifax             | NS       | Canada         | B3S 1C5       | +1 (902) 450-0450   | ---                | marthasilk@gmail.com          |              5 |
    |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           23 | John         | Gordon       | ---                                              | 69 Salem Street                          | Boston              | MA       | USA            | 2113          | +1 (617) 522-1333   | ---                | johngordon22@yahoo.com        |              4 |
    |            2 | Edwards    | Nancy       | Sales Manager       |           1 | 1958-12-08  | 2002-05-01 | 825 8 Ave SW     | Calgary | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |           42 | Wyatt        | Girard       | ---                                              | 9, Place Louis Barthou                   | Bordeaux            | ---      | France         | 33000         | +33 05 56 96 96 96  | ---                | wyatt.girard@yahoo.fr         |              3 |
    |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           39 | Camille      | Bernard      | ---                                              | 4, Rue Milton                            | Paris               | ---      | France         | 75009         | +33 01 49 70 65 65  | ---                | camille.bernard@yahoo.fr      |              4 |
    |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           26 | Richard      | Cunningham   | ---                                              | 2211 W Berry Street                      | Fort Worth          | TX       | USA            | 76110         | +1 (817) 924-7272   | ---                | ricunningham@hotmail.com      |              4 |
    |            2 | Edwards    | Nancy       | Sales Manager       |           1 | 1958-12-08  | 2002-05-01 | 825 8 Ave SW     | Calgary | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |           15 | Jennifer     | Peterson     | Rogers Canada                                    | 700 W Pender Street                      | Vancouver           | BC       | Canada         | V6C 1G8       | +1 (604) 688-2255   | +1 (604) 688-8756  | jenniferp@rogers.ca           |              3 |
    |            2 | Edwards    | Nancy       | Sales Manager       |           1 | 1958-12-08  | 2002-05-01 | 825 8 Ave SW     | Calgary | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |           18 | Michelle     | Brooks       | ---                                              | 627 Broadway                             | New York            | NY       | USA            | 10012-2612    | +1 (212) 221-3546   | +1 (212) 221-4679  | michelleb@aol.com             |              3 |
    |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           55 | Mark         | Taylor       | ---                                              | 421 Bourke Street                        | Sidney              | NSW      | Australia      | 2010          | +61 (02) 9332 3633  | ---                | mark.taylor@yahoo.au          |              4 |
    |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           47 | Lucas        | Mancini      | ---                                              | Via Degli Scipioni, 43                   | Rome                | RM       | Italy          | 00192         | +39 06 39733434     | ---                | lucas.mancini@yahoo.it        |              5 |
    |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           54 | Steve        | Murray       | ---                                              | 110 Raeburn Pl                           | Edinburgh           | ---      | United Kingdom | EH4 1HH       | +44 0131 315 3300   | ---                | steve.murray@yahoo.uk         |              5 |
    |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |            8 | Daan         | Peeters      | ---                                              | Grétrystraat 63                          | Brussels            | ---      | Belgium        | 1000          | +32 02 219 03 03    | ---                | daan_peeters@apple.be         |              4 |
    |            2 | Edwards    | Nancy       | Sales Manager       |           1 | 1958-12-08  | 2002-05-01 | 825 8 Ave SW     | Calgary | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |           29 | Robert       | Brown        | ---                                              | 796 Dundas Street West                   | Toronto             | ON       | Canada         | M6J 1V1       | +1 (416) 363-8888   | ---                | robbrown@shaw.ca              |              3 |
    |            2 | Edwards    | Nancy       | Sales Manager       |           1 | 1958-12-08  | 2002-05-01 | 825 8 Ave SW     | Calgary | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |            3 | François     | Tremblay     | ---                                              | 1498 rue Bélanger                        | Montréal            | QC       | Canada         | H2G 1A7       | +1 (514) 721-4711   | ---                | ftremblay@gmail.com           |              3 |
    |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |            9 | Kara         | Nielsen      | ---                                              | Sønder Boulevard 51                      | Copenhagen          | ---      | Denmark        | 1720          | +453 3331 9991      | ---                | kara.nielsen@jubii.dk         |              4 |
    |            2 | Edwards    | Nancy       | Sales Manager       |           1 | 1958-12-08  | 2002-05-01 | 825 8 Ave SW     | Calgary | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |           33 | Ellie        | Sullivan     | ---                                              | 5112 48 Street                           | Yellowknife         | NT       | Canada         | X1A 1N6       | +1 (867) 920-2233   | ---                | ellie.sullivan@shaw.ca        |              3 |
    |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |            5 | František    | Wichterlová  | JetBrains s.r.o.                                 | Klanova 9/506                            | Prague              | ---      | Czech Republic | 14700         | +420 2 4172 5555    | +420 2 4172 5555   | frantisekw@jetbrains.com      |              4 |
    |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           16 | Frank        | Harris       | Google Inc.                                      | 1600 Amphitheatre Parkway                | Mountain View       | CA       | USA            | 94043-1351    | +1 (650) 253-0000   | +1 (650) 253-0000  | fharris@google.com            |              4 |
    |            2 | Edwards    | Nancy       | Sales Manager       |           1 | 1958-12-08  | 2002-05-01 | 825 8 Ave SW     | Calgary | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |           46 | Hugh         | O'Reilly     | ---                                              | 3 Chatham Street                         | Dublin              | Dublin   | Ireland        | ---           | +353 01 6792424     | ---                | hughoreilly@apple.ie          |              3 |
    |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |            7 | Astrid       | Gruber       | ---                                              | Rotenturmstraße 4, 1010 Innere Stadt     | Vienne              | ---      | Austria        | 1010          | +43 01 5134505      | ---                | astrid.gruber@apple.at        |              5 |
    |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           14 | Mark         | Philips      | Telus                                            | 8210 111 ST NW                           | Edmonton            | AB       | Canada         | T6G 2C7       | +1 (780) 434-4554   | +1 (780) 434-5565  | mphilips12@shaw.ca            |              5 |
    |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           32 | Aaron        | Mitchell     | ---                                              | 696 Osborne Street                       | Winnipeg            | MB       | Canada         | R3L 2B9       | +1 (204) 452-6452   | ---                | aaronmitchell@yahoo.ca        |              4 |
    |            2 | Edwards    | Nancy       | Sales Manager       |           1 | 1958-12-08  | 2002-05-01 | 825 8 Ave SW     | Calgary | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |           38 | Niklas       | Schröder     | ---                                              | Barbarossastraße 19                      | Berlin              | ---      | Germany        | 10779         | +49 030 2141444     | ---                | nschroder@surfeu.de           |              3 |
    |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           17 | Jack         | Smith        | Microsoft Corporation                            | 1 Microsoft Way                          | Redmond             | WA       | USA            | 98052-8300    | +1 (425) 882-8080   | +1 (425) 882-8081  | jacksmith@microsoft.com       |              5 |
    |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           21 | Kathy        | Chase        | ---                                              | 801 W 4th Street                         | Reno                | NV       | USA            | 89503         | +1 (775) 223-7665   | ---                | kachase@hotmail.com           |              5 |
    |            2 | Edwards    | Nancy       | Sales Manager       |           1 | 1958-12-08  | 2002-05-01 | 825 8 Ave SW     | Calgary | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |            1 | Luís         | Gonçalves    | Embraer - Empresa Brasileira de Aeronáutica S.A. | Av. Brigadeiro Faria Lima, 2170          | São José dos Campos | SP       | Brazil         | 12227-000     | +55 (12) 3923-5555  | +55 (12) 3923-5566 | luisg@embraer.com.br          |              3 |
    |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           11 | Alexandre    | Rocha        | Banco do Brasil S.A.                             | Av. Paulista, 2022                       | São Paulo           | SP       | Brazil         | 01310-200     | +55 (11) 3055-3278  | +55 (11) 3055-8131 | alero@uol.com.br              |              5 |
    |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |           40 | Dominique    | Lefebvre     | ---                                              | 8, Rue Hanovre                           | Paris               | ---      | France         | 75002         | +33 01 47 42 71 71  | ---                | dominiquelefebvre@gmail.com   |              4 |
    |            2 | Edwards    | Nancy       | Sales Manager       |           1 | 1958-12-08  | 2002-05-01 | 825 8 Ave SW     | Calgary | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |           53 | Phil         | Hughes       | ---                                              | 113 Lupus St                             | London              | ---      | United Kingdom | SW1V 3EN      | +44 020 7976 5722   | ---                | phil.hughes@gmail.com         |              3 |
    |            2 | Edwards    | Nancy       | Sales Manager       |           1 | 1958-12-08  | 2002-05-01 | 825 8 Ave SW     | Calgary | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |           43 | Isabelle     | Mercier      | ---                                              | 68, Rue Jouvence                         | Dijon               | ---      | France         | 21000         | +33 03 80 73 66 99  | ---                | isabelle_mercier@apple.fr     |              3 |
    |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |           51 | Joakim       | Johansson    | ---                                              | Celsiusg. 9                              | Stockholm           | ---      | Sweden         | 11230         | +46 08-651 52 52    | ---                | joakim.johansson@yahoo.se     |              5 |
    |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |            2 | Leonie       | Köhler       | ---                                              | Theodor-Heuss-Straße 34                  | Stuttgart           | ---      | Germany        | 70174         | +49 0711 2842222    | ---                | leonekohler@surfeu.de         |              5 |
    |            2 | Edwards    | Nancy       | Sales Manager       |           1 | 1958-12-08  | 2002-05-01 | 825 8 Ave SW     | Calgary | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |           19 | Tim          | Goyer        | Apple Inc.                                       | 1 Infinite Loop                          | Cupertino           | CA       | USA            | 95014         | +1 (408) 996-1010   | +1 (408) 996-1011  | tgoyer@apple.com              |              3 |
    |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |            6 | Helena       | Holý         | ---                                              | Rilská 3174/6                            | Prague              | ---      | Czech Republic | 14300         | +420 2 4177 0449    | ---                | hholy@gmail.com               |              5 |
    #+end_example

    #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports code
SELECT DISTINCT EmployeeId,
                SupportRepId,
       		Employee.LastName AS eLastName,
		Employee.FirstName AS eFirstName,
		Employee.Title AS eTitle,
		Employee.ReportsTo AS eReportsTo,
		Employee.BirthDate AS eBirthDate,
		Employee.HireDate AS eHireDate,
		Employee.Address AS eAddress,
		Employee.City AS eCity,
		Employee.State AS eState,
		Employee.Country AS eCountry,
		Employee.PostalCode AS ePostalCode,
		Employee.Phone AS ePhone,
		Employee.Fax AS eFax,
		Employee.Email AS eEmail,
		Customer.CustomerId AS cCustomerId,
		Customer.FirstName AS cFirstName,
		Customer.LastName AS cLastName,
		Customer.Company AS cCompany,
		Customer.Address AS cAddress,
		Customer.City AS cCity,
		Customer.State AS cState,
		Customer.Country AS cCountry,
		Customer.PostalCode AS cPostalCode,
		Customer.Phone AS cPhone,
		Customer.Fax AS cFax,
		Customer.Email AS cEmail
FROM Employee JOIN Customer
ON Employee.EmployeeId = 1 + Customer.SupportRepId;
    #+END_SRC

    #+RESULTS:
    | 4 | 3 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW     | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |  1 | Luís      | Gonçalves    | Embraer - Empresa Brasileira de Aeronáutica S.A. | Av. Brigadeiro Faria Lima, 2170          | São José dos Campos | SP     | Brazil         |  12227-000 | +55 (12) 3923-5555  | +55 (12) 3923-5566 | luisg@embraer.com.br          |
    | 4 | 3 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW     | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |  3 | François  | Tremblay     |                                                  | 1498 rue Bélanger                        | Montréal            | QC     | Canada         |    H2G 1A7 | +1 (514) 721-4711   |                    | ftremblay@gmail.com           |
    | 4 | 3 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW     | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 12 | Roberto   | Almeida      | Riotur                                           | Praça Pio X, 119                         | Rio de Janeiro      | RJ     | Brazil         |  20040-020 | +55 (21) 2271-7000  | +55 (21) 2271-7070 | roberto.almeida@riotur.gov.br |
    | 4 | 3 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW     | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 15 | Jennifer  | Peterson     | Rogers Canada                                    | 700 W Pender Street                      | Vancouver           | BC     | Canada         |    V6C 1G8 | +1 (604) 688-2255   | +1 (604) 688-8756  | jenniferp@rogers.ca           |
    | 4 | 3 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW     | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 18 | Michelle  | Brooks       |                                                  | 627 Broadway                             | New York            | NY     | USA            | 10012-2612 | +1 (212) 221-3546   | +1 (212) 221-4679  | michelleb@aol.com             |
    | 4 | 3 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW     | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 19 | Tim       | Goyer        | Apple Inc.                                       | 1 Infinite Loop                          | Cupertino           | CA     | USA            |      95014 | +1 (408) 996-1010   | +1 (408) 996-1011  | tgoyer@apple.com              |
    | 4 | 3 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW     | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 24 | Frank     | Ralston      |                                                  | 162 E Superior Street                    | Chicago             | IL     | USA            |      60611 | +1 (312) 332-3232   |                    | fralston@gmail.com            |
    | 4 | 3 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW     | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 29 | Robert    | Brown        |                                                  | 796 Dundas Street West                   | Toronto             | ON     | Canada         |    M6J 1V1 | +1 (416) 363-8888   |                    | robbrown@shaw.ca              |
    | 4 | 3 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW     | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 30 | Edward    | Francis      |                                                  | 230 Elgin Street                         | Ottawa              | ON     | Canada         |    K2P 1L7 | +1 (613) 234-3322   |                    | edfrancis@yachoo.ca           |
    | 4 | 3 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW     | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 33 | Ellie     | Sullivan     |                                                  | 5112 48 Street                           | Yellowknife         | NT     | Canada         |    X1A 1N6 | +1 (867) 920-2233   |                    | ellie.sullivan@shaw.ca        |
    | 4 | 3 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW     | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 37 | Fynn      | Zimmermann   |                                                  | Berger Straße 10                         | Frankfurt           |        | Germany        |      60316 | +49 069 40598889    |                    | fzimmermann@yahoo.de          |
    | 4 | 3 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW     | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 38 | Niklas    | Schröder     |                                                  | Barbarossastraße 19                      | Berlin              |        | Germany        |      10779 | +49 030 2141444     |                    | nschroder@surfeu.de           |
    | 4 | 3 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW     | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 42 | Wyatt     | Girard       |                                                  | 9, Place Louis Barthou                   | Bordeaux            |        | France         |      33000 | +33 05 56 96 96 96  |                    | wyatt.girard@yahoo.fr         |
    | 4 | 3 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW     | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 43 | Isabelle  | Mercier      |                                                  | 68, Rue Jouvence                         | Dijon               |        | France         |      21000 | +33 03 80 73 66 99  |                    | isabelle_mercier@apple.fr     |
    | 4 | 3 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW     | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 44 | Terhi     | Hämäläinen   |                                                  | Porthaninkatu 9                          | Helsinki            |        | Finland        |        530 | +358 09 870 2000    |                    | terhi.hamalainen@apple.fi     |
    | 4 | 3 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW     | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 45 | Ladislav  | Kovács       |                                                  | Erzsébet krt. 58.                        | Budapest            |        | Hungary        |     H-1073 |                     |                    | ladislav_kovacs@apple.hu      |
    | 4 | 3 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW     | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 46 | Hugh      | O'Reilly     |                                                  | 3 Chatham Street                         | Dublin              | Dublin | Ireland        |            | +353 01 6792424     |                    | hughoreilly@apple.ie          |
    | 4 | 3 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW     | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 52 | Emma      | Jones        |                                                  | 202 Hoxton Street                        | London              |        | United Kingdom |     N1 5LH | +44 020 7707 0707   |                    | emma_jones@hotmail.com        |
    | 4 | 3 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW     | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 53 | Phil      | Hughes       |                                                  | 113 Lupus St                             | London              |        | United Kingdom |   SW1V 3EN | +44 020 7976 5722   |                    | phil.hughes@gmail.com         |
    | 4 | 3 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW     | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 58 | Manoj     | Pareek       |                                                  | 12,Community Centre                      | Delhi               |        | India          |     110017 | +91 0124 39883988   |                    | manoj.pareek@rediff.com       |
    | 4 | 3 | Park     | Margaret | Sales Support Agent | 2 | 1947-09-19 00:00:00 | 2003-05-03 00:00:00 | 683 10 Street SW     | Calgary | AB | Canada | T2P 5G3 | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 59 | Puja      | Srivastava   |                                                  | 3,Raj Bhavan Road                        | Bangalore           |        | India          |     560001 | +91 080 22289999    |                    | puja_srivastava@yahoo.in      |
    | 5 | 4 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave         | Calgary | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |  4 | Bjørn     | Hansen       |                                                  | Ullevålsveien 14                         | Oslo                |        | Norway         |        171 | +47 22 44 22 22     |                    | bjorn.hansen@yahoo.no         |
    | 5 | 4 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave         | Calgary | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |  5 | František | Wichterlová  | JetBrains s.r.o.                                 | Klanova 9/506                            | Prague              |        | Czech Republic |      14700 | +420 2 4172 5555    | +420 2 4172 5555   | frantisekw@jetbrains.com      |
    | 5 | 4 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave         | Calgary | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |  8 | Daan      | Peeters      |                                                  | Grétrystraat 63                          | Brussels            |        | Belgium        |       1000 | +32 02 219 03 03    |                    | daan_peeters@apple.be         |
    | 5 | 4 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave         | Calgary | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |  9 | Kara      | Nielsen      |                                                  | Sønder Boulevard 51                      | Copenhagen          |        | Denmark        |       1720 | +453 3331 9991      |                    | kara.nielsen@jubii.dk         |
    | 5 | 4 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave         | Calgary | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 10 | Eduardo   | Martins      | Woodstock Discos                                 | Rua Dr. Falcão Filho, 155                | São Paulo           | SP     | Brazil         |  01007-010 | +55 (11) 3033-5446  | +55 (11) 3033-4564 | eduardo@woodstock.com.br      |
    | 5 | 4 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave         | Calgary | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 13 | Fernanda  | Ramos        |                                                  | Qe 7 Bloco G                             | Brasília            | DF     | Brazil         |  71020-677 | +55 (61) 3363-5547  | +55 (61) 3363-7855 | fernadaramos4@uol.com.br      |
    | 5 | 4 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave         | Calgary | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 16 | Frank     | Harris       | Google Inc.                                      | 1600 Amphitheatre Parkway                | Mountain View       | CA     | USA            | 94043-1351 | +1 (650) 253-0000   | +1 (650) 253-0000  | fharris@google.com            |
    | 5 | 4 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave         | Calgary | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 20 | Dan       | Miller       |                                                  | 541 Del Medio Avenue                     | Mountain View       | CA     | USA            |  94040-111 | +1 (650) 644-3358   |                    | dmiller@comcast.com           |
    | 5 | 4 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave         | Calgary | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 22 | Heather   | Leacock      |                                                  | 120 S Orange Ave                         | Orlando             | FL     | USA            |      32801 | +1 (407) 999-7788   |                    | hleacock@gmail.com            |
    | 5 | 4 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave         | Calgary | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 23 | John      | Gordon       |                                                  | 69 Salem Street                          | Boston              | MA     | USA            |       2113 | +1 (617) 522-1333   |                    | johngordon22@yahoo.com        |
    | 5 | 4 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave         | Calgary | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 26 | Richard   | Cunningham   |                                                  | 2211 W Berry Street                      | Fort Worth          | TX     | USA            |      76110 | +1 (817) 924-7272   |                    | ricunningham@hotmail.com      |
    | 5 | 4 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave         | Calgary | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 27 | Patrick   | Gray         |                                                  | 1033 N Park Ave                          | Tucson              | AZ     | USA            |      85719 | +1 (520) 622-4200   |                    | patrick.gray@aol.com          |
    | 5 | 4 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave         | Calgary | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 32 | Aaron     | Mitchell     |                                                  | 696 Osborne Street                       | Winnipeg            | MB     | Canada         |    R3L 2B9 | +1 (204) 452-6452   |                    | aaronmitchell@yahoo.ca        |
    | 5 | 4 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave         | Calgary | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 34 | João      | Fernandes    |                                                  | Rua da Assunção 53                       | Lisbon              |        | Portugal       |            | +351 (213) 466-111  |                    | jfernandes@yahoo.pt           |
    | 5 | 4 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave         | Calgary | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 35 | Madalena  | Sampaio      |                                                  | Rua dos Campeões Europeus de Viena, 4350 | Porto               |        | Portugal       |            | +351 (225) 022-448  |                    | masampaio@sapo.pt             |
    | 5 | 4 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave         | Calgary | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 39 | Camille   | Bernard      |                                                  | 4, Rue Milton                            | Paris               |        | France         |      75009 | +33 01 49 70 65 65  |                    | camille.bernard@yahoo.fr      |
    | 5 | 4 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave         | Calgary | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 40 | Dominique | Lefebvre     |                                                  | 8, Rue Hanovre                           | Paris               |        | France         |      75002 | +33 01 47 42 71 71  |                    | dominiquelefebvre@gmail.com   |
    | 5 | 4 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave         | Calgary | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 49 | Stanisław | Wójcik       |                                                  | Ordynacka 10                             | Warsaw              |        | Poland         |     00-358 | +48 22 828 37 39    |                    | stanisław.wójcik@wp.pl        |
    | 5 | 4 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave         | Calgary | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 55 | Mark      | Taylor       |                                                  | 421 Bourke Street                        | Sidney              | NSW    | Australia      |       2010 | +61 (02) 9332 3633  |                    | mark.taylor@yahoo.au          |
    | 5 | 4 | Johnson  | Steve    | Sales Support Agent | 2 | 1965-03-03 00:00:00 | 2003-10-17 00:00:00 | 7727B 41 Ave         | Calgary | AB | Canada | T3B 1Y7 | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 56 | Diego     | Gutiérrez    |                                                  | 307 Macacha Güemes                       | Buenos Aires        |        | Argentina      |       1106 | +54 (0)11 4311 4333 |                    | diego.gutierrez@yahoo.ar      |
    | 6 | 5 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW | Calgary | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  |  2 | Leonie    | Köhler       |                                                  | Theodor-Heuss-Straße 34                  | Stuttgart           |        | Germany        |      70174 | +49 0711 2842222    |                    | leonekohler@surfeu.de         |
    | 6 | 5 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW | Calgary | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  |  6 | Helena    | Holý         |                                                  | Rilská 3174/6                            | Prague              |        | Czech Republic |      14300 | +420 2 4177 0449    |                    | hholy@gmail.com               |
    | 6 | 5 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW | Calgary | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  |  7 | Astrid    | Gruber       |                                                  | Rotenturmstraße 4, 1010 Innere Stadt     | Vienne              |        | Austria        |       1010 | +43 01 5134505      |                    | astrid.gruber@apple.at        |
    | 6 | 5 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW | Calgary | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  | 11 | Alexandre | Rocha        | Banco do Brasil S.A.                             | Av. Paulista, 2022                       | São Paulo           | SP     | Brazil         |  01310-200 | +55 (11) 3055-3278  | +55 (11) 3055-8131 | alero@uol.com.br              |
    | 6 | 5 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW | Calgary | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  | 14 | Mark      | Philips      | Telus                                            | 8210 111 ST NW                           | Edmonton            | AB     | Canada         |    T6G 2C7 | +1 (780) 434-4554   | +1 (780) 434-5565  | mphilips12@shaw.ca            |
    | 6 | 5 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW | Calgary | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  | 17 | Jack      | Smith        | Microsoft Corporation                            | 1 Microsoft Way                          | Redmond             | WA     | USA            | 98052-8300 | +1 (425) 882-8080   | +1 (425) 882-8081  | jacksmith@microsoft.com       |
    | 6 | 5 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW | Calgary | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  | 21 | Kathy     | Chase        |                                                  | 801 W 4th Street                         | Reno                | NV     | USA            |      89503 | +1 (775) 223-7665   |                    | kachase@hotmail.com           |
    | 6 | 5 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW | Calgary | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  | 25 | Victor    | Stevens      |                                                  | 319 N. Frances Street                    | Madison             | WI     | USA            |      53703 | +1 (608) 257-0597   |                    | vstevens@yahoo.com            |
    | 6 | 5 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW | Calgary | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  | 28 | Julia     | Barnett      |                                                  | 302 S 700 E                              | Salt Lake City      | UT     | USA            |      84102 | +1 (801) 531-7272   |                    | jubarnett@gmail.com           |
    | 6 | 5 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW | Calgary | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  | 31 | Martha    | Silk         |                                                  | 194A Chain Lake Drive                    | Halifax             | NS     | Canada         |    B3S 1C5 | +1 (902) 450-0450   |                    | marthasilk@gmail.com          |
    | 6 | 5 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW | Calgary | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  | 36 | Hannah    | Schneider    |                                                  | Tauentzienstraße 8                       | Berlin              |        | Germany        |      10789 | +49 030 26550280    |                    | hannah.schneider@yahoo.de     |
    | 6 | 5 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW | Calgary | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  | 41 | Marc      | Dubois       |                                                  | 11, Place Bellecour                      | Lyon                |        | France         |      69002 | +33 04 78 30 30 30  |                    | marc.dubois@hotmail.com       |
    | 6 | 5 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW | Calgary | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  | 47 | Lucas     | Mancini      |                                                  | Via Degli Scipioni, 43                   | Rome                | RM     | Italy          |        192 | +39 06 39733434     |                    | lucas.mancini@yahoo.it        |
    | 6 | 5 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW | Calgary | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  | 48 | Johannes  | Van der Berg |                                                  | Lijnbaansgracht 120bg                    | Amsterdam           | VV     | Netherlands    |       1016 | +31 020 6223130     |                    | johavanderberg@yahoo.nl       |
    | 6 | 5 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW | Calgary | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  | 50 | Enrique   | Muñoz        |                                                  | C/ San Bernardo 85                       | Madrid              |        | Spain          |      28015 | +34 914 454 454     |                    | enrique_munoz@yahoo.es        |
    | 6 | 5 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW | Calgary | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  | 51 | Joakim    | Johansson    |                                                  | Celsiusg. 9                              | Stockholm           |        | Sweden         |      11230 | +46 08-651 52 52    |                    | joakim.johansson@yahoo.se     |
    | 6 | 5 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW | Calgary | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  | 54 | Steve     | Murray       |                                                  | 110 Raeburn Pl                           | Edinburgh           |        | United Kingdom |    EH4 1HH | +44 0131 315 3300   |                    | steve.murray@yahoo.uk         |
    | 6 | 5 | Mitchell | Michael  | IT Manager          | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW | Calgary | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  | 57 | Luis      | Rojas        |                                                  | Calle Lira, 198                          | Santiago            |        | Chile          |            | +56 (0)2 635 4444   |                    | luisrojas@yahoo.cl            |


**** Outer Joins
     Relation provides full outer join (~outer~), outer join left (~outer_left~),
     and outer join right (~outer_right~). When printing the result of
     an outer join, null is represented by "---". Like the natural join
     methods, these methods take a single table argument and perform a join with
     the method's object.
***** Outer Left Join
    #+BEGIN_SRC python :noweb yes :exports code
<<setup>>
cn = customer.rename({"SupportRepId": "EmployeeId", "LastName": "cLastName",
                      "FirstName": "cFirstName", "Company": "cCompany",
                      "Address": "cAddress", "City": "cCity", "State": "cState",
                      "Country": "cCountry", "PostalCode": "cPostalCode",
                      "Phone": "cPhone", "Fax": "cFax", "Email": "cEmail"})
jn = employee.outer_left(cn)
return str(RelationOrg(jn))
    #+END_SRC

    #+RESULTS:
    #+begin_example
    |   EmployeeId | LastName   | FirstName   | Title               | ReportsTo   | BirthDate   | HireDate   | Address                     | City       | State   | Country   | PostalCode   | Phone             | Fax               | Email                    | CustomerId   | cFirstName   | cLastName    | cCompany                                         | cAddress                                 | cCity               | cState   | cCountry       | cPostalCode   | cPhone              | cFax               | cEmail                        |
    |--------------+------------+-------------+---------------------+-------------+-------------+------------+-----------------------------+------------+---------+-----------+--------------+-------------------+-------------------+--------------------------+--------------+--------------+--------------+--------------------------------------------------+------------------------------------------+---------------------+----------+----------------+---------------+---------------------+--------------------+-------------------------------|
    |            8 | Callahan   | Laura       | IT Staff            | 6           | 1968-01-09  | 2004-03-04 | 923 7 ST NW                 | Lethbridge | AB      | Canada    | T1H 1Y8      | +1 (403) 467-3351 | +1 (403) 467-8772 | laura@chinookcorp.com    | ---          | ---          | ---          | ---                                              | ---                                      | ---                 | ---      | ---            | ---           | ---                 | ---                | ---                           |
    |            2 | Edwards    | Nancy       | Sales Manager       | 1           | 1958-12-08  | 2002-05-01 | 825 8 Ave SW                | Calgary    | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    | ---          | ---          | ---          | ---                                              | ---                                      | ---                 | ---      | ---            | ---           | ---                 | ---                | ---                           |
    |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 34           | João         | Fernandes    | ---                                              | Rua da Assunção 53                       | Lisbon              | ---      | Portugal       | ---           | +351 (213) 466-111  | ---                | jfernandes@yahoo.pt           |
    |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 18           | Michelle     | Brooks       | ---                                              | 627 Broadway                             | New York            | NY       | USA            | 10012-2612    | +1 (212) 221-3546   | +1 (212) 221-4679  | michelleb@aol.com             |
    |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 37           | Fynn         | Zimmermann   | ---                                              | Berger Straße 10                         | Frankfurt           | ---      | Germany        | 60316         | +49 069 40598889    | ---                | fzimmermann@yahoo.de          |
    |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 9            | Kara         | Nielsen      | ---                                              | Sønder Boulevard 51                      | Copenhagen          | ---      | Denmark        | 1720          | +453 3331 9991      | ---                | kara.nielsen@jubii.dk         |
    |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 16           | Frank        | Harris       | Google Inc.                                      | 1600 Amphitheatre Parkway                | Mountain View       | CA       | USA            | 94043-1351    | +1 (650) 253-0000   | +1 (650) 253-0000  | fharris@google.com            |
    |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 10           | Eduardo      | Martins      | Woodstock Discos                                 | Rua Dr. Falcão Filho, 155                | São Paulo           | SP       | Brazil         | 01007-010     | +55 (11) 3033-5446  | +55 (11) 3033-4564 | eduardo@woodstock.com.br      |
    |            6 | Mitchell   | Michael     | IT Manager          | 1           | 1973-07-01  | 2003-10-17 | 5827 Bowness Road NW        | Calgary    | AB      | Canada    | T3B 0C5      | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  | ---          | ---          | ---          | ---                                              | ---                                      | ---                 | ---      | ---            | ---           | ---                 | ---                | ---                           |
    |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 45           | Ladislav     | Kovács       | ---                                              | Erzsébet krt. 58.                        | Budapest            | ---      | Hungary        | H-1073        | ---                 | ---                | ladislav_kovacs@apple.hu      |
    |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 24           | Frank        | Ralston      | ---                                              | 162 E Superior Street                    | Chicago             | IL       | USA            | 60611         | +1 (312) 332-3232   | ---                | fralston@gmail.com            |
    |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 13           | Fernanda     | Ramos        | ---                                              | Qe 7 Bloco G                             | Brasília            | DF       | Brazil         | 71020-677     | +55 (61) 3363-5547  | +55 (61) 3363-7855 | fernadaramos4@uol.com.br      |
    |            1 | Adams      | Andrew      | General Manager     | ---         | 1962-02-18  | 2002-08-14 | 11120 Jasper Ave NW         | Edmonton   | AB      | Canada    | T5K 2N1      | +1 (780) 428-9482 | +1 (780) 428-3457 | andrew@chinookcorp.com   | ---          | ---          | ---          | ---                                              | ---                                      | ---                 | ---      | ---            | ---           | ---                 | ---                | ---                           |
    |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 4            | Bjørn        | Hansen       | ---                                              | Ullevålsveien 14                         | Oslo                | ---      | Norway         | 0171          | +47 22 44 22 22     | ---                | bjorn.hansen@yahoo.no         |
    |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 57           | Luis         | Rojas        | ---                                              | Calle Lira, 198                          | Santiago            | ---      | Chile          | ---           | +56 (0)2 635 4444   | ---                | luisrojas@yahoo.cl            |
    |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 35           | Madalena     | Sampaio      | ---                                              | Rua dos Campeões Europeus de Viena, 4350 | Porto               | ---      | Portugal       | ---           | +351 (225) 022-448  | ---                | masampaio@sapo.pt             |
    |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 15           | Jennifer     | Peterson     | Rogers Canada                                    | 700 W Pender Street                      | Vancouver           | BC       | Canada         | V6C 1G8       | +1 (604) 688-2255   | +1 (604) 688-8756  | jenniferp@rogers.ca           |
    |            7 | King       | Robert      | IT Staff            | 6           | 1970-05-29  | 2004-01-02 | 590 Columbia Boulevard West | Lethbridge | AB      | Canada    | T1K 5N8      | +1 (403) 456-9986 | +1 (403) 456-8485 | robert@chinookcorp.com   | ---          | ---          | ---          | ---                                              | ---                                      | ---                 | ---      | ---            | ---           | ---                 | ---                | ---                           |
    |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 26           | Richard      | Cunningham   | ---                                              | 2211 W Berry Street                      | Fort Worth          | TX       | USA            | 76110         | +1 (817) 924-7272   | ---                | ricunningham@hotmail.com      |
    |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 1            | Luís         | Gonçalves    | Embraer - Empresa Brasileira de Aeronáutica S.A. | Av. Brigadeiro Faria Lima, 2170          | São José dos Campos | SP       | Brazil         | 12227-000     | +55 (12) 3923-5555  | +55 (12) 3923-5566 | luisg@embraer.com.br          |
    |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 59           | Puja         | Srivastava   | ---                                              | 3,Raj Bhavan Road                        | Bangalore           | ---      | India          | 560001        | +91 080 22289999    | ---                | puja_srivastava@yahoo.in      |
    |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 49           | Stanisław    | Wójcik       | ---                                              | Ordynacka 10                             | Warsaw              | ---      | Poland         | 00-358        | +48 22 828 37 39    | ---                | stanisław.wójcik@wp.pl        |
    |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 46           | Hugh         | O'Reilly     | ---                                              | 3 Chatham Street                         | Dublin              | Dublin   | Ireland        | ---           | +353 01 6792424     | ---                | hughoreilly@apple.ie          |
    |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 25           | Victor       | Stevens      | ---                                              | 319 N. Frances Street                    | Madison             | WI       | USA            | 53703         | +1 (608) 257-0597   | ---                | vstevens@yahoo.com            |
    |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 42           | Wyatt        | Girard       | ---                                              | 9, Place Louis Barthou                   | Bordeaux            | ---      | France         | 33000         | +33 05 56 96 96 96  | ---                | wyatt.girard@yahoo.fr         |
    |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 50           | Enrique      | Muñoz        | ---                                              | C/ San Bernardo 85                       | Madrid              | ---      | Spain          | 28015         | +34 914 454 454     | ---                | enrique_munoz@yahoo.es        |
    |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 43           | Isabelle     | Mercier      | ---                                              | 68, Rue Jouvence                         | Dijon               | ---      | France         | 21000         | +33 03 80 73 66 99  | ---                | isabelle_mercier@apple.fr     |
    |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 47           | Lucas        | Mancini      | ---                                              | Via Degli Scipioni, 43                   | Rome                | RM       | Italy          | 00192         | +39 06 39733434     | ---                | lucas.mancini@yahoo.it        |
    |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 55           | Mark         | Taylor       | ---                                              | 421 Bourke Street                        | Sidney              | NSW      | Australia      | 2010          | +61 (02) 9332 3633  | ---                | mark.taylor@yahoo.au          |
    |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 8            | Daan         | Peeters      | ---                                              | Grétrystraat 63                          | Brussels            | ---      | Belgium        | 1000          | +32 02 219 03 03    | ---                | daan_peeters@apple.be         |
    |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 28           | Julia        | Barnett      | ---                                              | 302 S 700 E                              | Salt Lake City      | UT       | USA            | 84102         | +1 (801) 531-7272   | ---                | jubarnett@gmail.com           |
    |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 21           | Kathy        | Chase        | ---                                              | 801 W 4th Street                         | Reno                | NV       | USA            | 89503         | +1 (775) 223-7665   | ---                | kachase@hotmail.com           |
    |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 3            | François     | Tremblay     | ---                                              | 1498 rue Bélanger                        | Montréal            | QC       | Canada         | H2G 1A7       | +1 (514) 721-4711   | ---                | ftremblay@gmail.com           |
    |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 32           | Aaron        | Mitchell     | ---                                              | 696 Osborne Street                       | Winnipeg            | MB       | Canada         | R3L 2B9       | +1 (204) 452-6452   | ---                | aaronmitchell@yahoo.ca        |
    |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 48           | Johannes     | Van der Berg | ---                                              | Lijnbaansgracht 120bg                    | Amsterdam           | VV       | Netherlands    | 1016          | +31 020 6223130     | ---                | johavanderberg@yahoo.nl       |
    |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 40           | Dominique    | Lefebvre     | ---                                              | 8, Rue Hanovre                           | Paris               | ---      | France         | 75002         | +33 01 47 42 71 71  | ---                | dominiquelefebvre@gmail.com   |
    |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 17           | Jack         | Smith        | Microsoft Corporation                            | 1 Microsoft Way                          | Redmond             | WA       | USA            | 98052-8300    | +1 (425) 882-8080   | +1 (425) 882-8081  | jacksmith@microsoft.com       |
    |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 51           | Joakim       | Johansson    | ---                                              | Celsiusg. 9                              | Stockholm           | ---      | Sweden         | 11230         | +46 08-651 52 52    | ---                | joakim.johansson@yahoo.se     |
    |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 52           | Emma         | Jones        | ---                                              | 202 Hoxton Street                        | London              | ---      | United Kingdom | N1 5LH        | +44 020 7707 0707   | ---                | emma_jones@hotmail.com        |
    |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 39           | Camille      | Bernard      | ---                                              | 4, Rue Milton                            | Paris               | ---      | France         | 75009         | +33 01 49 70 65 65  | ---                | camille.bernard@yahoo.fr      |
    |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 56           | Diego        | Gutiérrez    | ---                                              | 307 Macacha Güemes                       | Buenos Aires        | ---      | Argentina      | 1106          | +54 (0)11 4311 4333 | ---                | diego.gutierrez@yahoo.ar      |
    |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 58           | Manoj        | Pareek       | ---                                              | 12,Community Centre                      | Delhi               | ---      | India          | 110017        | +91 0124 39883988   | ---                | manoj.pareek@rediff.com       |
    |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 6            | Helena       | Holý         | ---                                              | Rilská 3174/6                            | Prague              | ---      | Czech Republic | 14300         | +420 2 4177 0449    | ---                | hholy@gmail.com               |
    |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 5            | František    | Wichterlová  | JetBrains s.r.o.                                 | Klanova 9/506                            | Prague              | ---      | Czech Republic | 14700         | +420 2 4172 5555    | +420 2 4172 5555   | frantisekw@jetbrains.com      |
    |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 23           | John         | Gordon       | ---                                              | 69 Salem Street                          | Boston              | MA       | USA            | 2113          | +1 (617) 522-1333   | ---                | johngordon22@yahoo.com        |
    |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 22           | Heather      | Leacock      | ---                                              | 120 S Orange Ave                         | Orlando             | FL       | USA            | 32801         | +1 (407) 999-7788   | ---                | hleacock@gmail.com            |
    |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 19           | Tim          | Goyer        | Apple Inc.                                       | 1 Infinite Loop                          | Cupertino           | CA       | USA            | 95014         | +1 (408) 996-1010   | +1 (408) 996-1011  | tgoyer@apple.com              |
    |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 7            | Astrid       | Gruber       | ---                                              | Rotenturmstraße 4, 1010 Innere Stadt     | Vienne              | ---      | Austria        | 1010          | +43 01 5134505      | ---                | astrid.gruber@apple.at        |
    |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 12           | Roberto      | Almeida      | Riotur                                           | Praça Pio X, 119                         | Rio de Janeiro      | RJ       | Brazil         | 20040-020     | +55 (21) 2271-7000  | +55 (21) 2271-7070 | roberto.almeida@riotur.gov.br |
    |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 27           | Patrick      | Gray         | ---                                              | 1033 N Park Ave                          | Tucson              | AZ       | USA            | 85719         | +1 (520) 622-4200   | ---                | patrick.gray@aol.com          |
    |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 53           | Phil         | Hughes       | ---                                              | 113 Lupus St                             | London              | ---      | United Kingdom | SW1V 3EN      | +44 020 7976 5722   | ---                | phil.hughes@gmail.com         |
    |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com | 20           | Dan          | Miller       | ---                                              | 541 Del Medio Avenue                     | Mountain View       | CA       | USA            | 94040-111     | +1 (650) 644-3358   | ---                | dmiller@comcast.com           |
    |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 44           | Terhi        | Hämäläinen   | ---                                              | Porthaninkatu 9                          | Helsinki            | ---      | Finland        | 00530         | +358 09 870 2000    | ---                | terhi.hamalainen@apple.fi     |
    |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 41           | Marc         | Dubois       | ---                                              | 11, Place Bellecour                      | Lyon                | ---      | France         | 69002         | +33 04 78 30 30 30  | ---                | marc.dubois@hotmail.com       |
    |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 38           | Niklas       | Schröder     | ---                                              | Barbarossastraße 19                      | Berlin              | ---      | Germany        | 10779         | +49 030 2141444     | ---                | nschroder@surfeu.de           |
    |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 11           | Alexandre    | Rocha        | Banco do Brasil S.A.                             | Av. Paulista, 2022                       | São Paulo           | SP       | Brazil         | 01310-200     | +55 (11) 3055-3278  | +55 (11) 3055-8131 | alero@uol.com.br              |
    |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 2            | Leonie       | Köhler       | ---                                              | Theodor-Heuss-Straße 34                  | Stuttgart           | ---      | Germany        | 70174         | +49 0711 2842222    | ---                | leonekohler@surfeu.de         |
    |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 54           | Steve        | Murray       | ---                                              | 110 Raeburn Pl                           | Edinburgh           | ---      | United Kingdom | EH4 1HH       | +44 0131 315 3300   | ---                | steve.murray@yahoo.uk         |
    |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 33           | Ellie        | Sullivan     | ---                                              | 5112 48 Street                           | Yellowknife         | NT       | Canada         | X1A 1N6       | +1 (867) 920-2233   | ---                | ellie.sullivan@shaw.ca        |
    |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 30           | Edward       | Francis      | ---                                              | 230 Elgin Street                         | Ottawa              | ON       | Canada         | K2P 1L7       | +1 (613) 234-3322   | ---                | edfrancis@yachoo.ca           |
    |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 31           | Martha       | Silk         | ---                                              | 194A Chain Lake Drive                    | Halifax             | NS       | Canada         | B3S 1C5       | +1 (902) 450-0450   | ---                | marthasilk@gmail.com          |
    |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     | 29           | Robert       | Brown        | ---                                              | 796 Dundas Street West                   | Toronto             | ON       | Canada         | M6J 1V1       | +1 (416) 363-8888   | ---                | robbrown@shaw.ca              |
    |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 36           | Hannah       | Schneider    | ---                                              | Tauentzienstraße 8                       | Berlin              | ---      | Germany        | 10789         | +49 030 26550280    | ---                | hannah.schneider@yahoo.de     |
    |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    | 14           | Mark         | Philips      | Telus                                            | 8210 111 ST NW                           | Edmonton            | AB       | Canada         | T6G 2C7       | +1 (780) 434-4554   | +1 (780) 434-5565  | mphilips12@shaw.ca            |
    #+end_example

    #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports none
SELECT DISTINCT EmployeeId,
       		Employee.LastName AS eLastName,
		Employee.FirstName AS eFirstName,
		Employee.Title AS eTitle,
		Employee.ReportsTo AS eReportsTo,
		Employee.BirthDate AS eBirthDate,
		Employee.HireDate AS eHireDate,
		Employee.Address AS eAddress,
		Employee.City AS eCity,
		Employee.State AS eState,
		Employee.Country AS eCountry,
		Employee.PostalCode AS ePostalCode,
		Employee.Phone AS ePhone,
		Employee.Fax AS eFax,
		Employee.Email AS eEmail,
		Customer.CustomerId AS cCustomerId,
		Customer.FirstName AS cFirstName,
		Customer.LastName AS cLastName,
		Customer.Company AS cCompany,
		Customer.Address AS cAddress,
		Customer.City AS cCity,
		Customer.State AS cState,
		Customer.Country AS cCountry,
		Customer.PostalCode AS cPostalCode,
		Customer.Phone AS cPhone,
		Customer.Fax AS cFax,
		Customer.Email AS cEmail
FROM Employee LEFT JOIN Customer
ON Employee.EmployeeId = Customer.SupportRepId;
    #+END_SRC
***** Outer Right Join
    #+BEGIN_SRC python :noweb yes :exports code
<<setup>>
cn = customer.rename({"SupportRepId": "EmployeeId", "LastName": "cLastName",
                      "FirstName": "cFirstName", "Company": "cCompany",
                      "Address": "cAddress", "City": "cCity", "State": "cState",
                      "Country": "cCountry", "PostalCode": "cPostalCode",
                      "Phone": "cPhone", "Fax": "cFax", "Email": "cEmail"})
jn = employee.outer_right(cn)
return str(RelationOrg(jn))
    #+END_SRC

    #+RESULTS:
    #+begin_example
    |   CustomerId | cFirstName   | cLastName    | cCompany                                         | cAddress                                 | cCity               | cState   | cCountry       | cPostalCode   | cPhone              | cFax               | cEmail                        |   EmployeeId | LastName   | FirstName   | Title               |   ReportsTo | BirthDate   | HireDate   | Address          | City    | State   | Country   | PostalCode   | Phone             | Fax               | Email                    |
    |--------------+--------------+--------------+--------------------------------------------------+------------------------------------------+---------------------+----------+----------------+---------------+---------------------+--------------------+-------------------------------+--------------+------------+-------------+---------------------+-------------+-------------+------------+------------------+---------+---------+-----------+--------------+-------------------+-------------------+--------------------------|
    |           50 | Enrique      | Muñoz        | ---                                              | C/ San Bernardo 85                       | Madrid              | ---      | Spain          | 28015         | +34 914 454 454     | ---                | enrique_munoz@yahoo.es        |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    |           39 | Camille      | Bernard      | ---                                              | 4, Rue Milton                            | Paris               | ---      | France         | 75009         | +33 01 49 70 65 65  | ---                | camille.bernard@yahoo.fr      |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    |           43 | Isabelle     | Mercier      | ---                                              | 68, Rue Jouvence                         | Dijon               | ---      | France         | 21000         | +33 03 80 73 66 99  | ---                | isabelle_mercier@apple.fr     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    |           38 | Niklas       | Schröder     | ---                                              | Barbarossastraße 19                      | Berlin              | ---      | Germany        | 10779         | +49 030 2141444     | ---                | nschroder@surfeu.de           |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    |           21 | Kathy        | Chase        | ---                                              | 801 W 4th Street                         | Reno                | NV       | USA            | 89503         | +1 (775) 223-7665   | ---                | kachase@hotmail.com           |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    |           33 | Ellie        | Sullivan     | ---                                              | 5112 48 Street                           | Yellowknife         | NT       | Canada         | X1A 1N6       | +1 (867) 920-2233   | ---                | ellie.sullivan@shaw.ca        |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    |           58 | Manoj        | Pareek       | ---                                              | 12,Community Centre                      | Delhi               | ---      | India          | 110017        | +91 0124 39883988   | ---                | manoj.pareek@rediff.com       |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    |           46 | Hugh         | O'Reilly     | ---                                              | 3 Chatham Street                         | Dublin              | Dublin   | Ireland        | ---           | +353 01 6792424     | ---                | hughoreilly@apple.ie          |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    |           41 | Marc         | Dubois       | ---                                              | 11, Place Bellecour                      | Lyon                | ---      | France         | 69002         | +33 04 78 30 30 30  | ---                | marc.dubois@hotmail.com       |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    |           57 | Luis         | Rojas        | ---                                              | Calle Lira, 198                          | Santiago            | ---      | Chile          | ---           | +56 (0)2 635 4444   | ---                | luisrojas@yahoo.cl            |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    |            6 | Helena       | Holý         | ---                                              | Rilská 3174/6                            | Prague              | ---      | Czech Republic | 14300         | +420 2 4177 0449    | ---                | hholy@gmail.com               |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    |           37 | Fynn         | Zimmermann   | ---                                              | Berger Straße 10                         | Frankfurt           | ---      | Germany        | 60316         | +49 069 40598889    | ---                | fzimmermann@yahoo.de          |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    |           42 | Wyatt        | Girard       | ---                                              | 9, Place Louis Barthou                   | Bordeaux            | ---      | France         | 33000         | +33 05 56 96 96 96  | ---                | wyatt.girard@yahoo.fr         |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    |           25 | Victor       | Stevens      | ---                                              | 319 N. Frances Street                    | Madison             | WI       | USA            | 53703         | +1 (608) 257-0597   | ---                | vstevens@yahoo.com            |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    |           13 | Fernanda     | Ramos        | ---                                              | Qe 7 Bloco G                             | Brasília            | DF       | Brazil         | 71020-677     | +55 (61) 3363-5547  | +55 (61) 3363-7855 | fernadaramos4@uol.com.br      |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    |            4 | Bjørn        | Hansen       | ---                                              | Ullevålsveien 14                         | Oslo                | ---      | Norway         | 0171          | +47 22 44 22 22     | ---                | bjorn.hansen@yahoo.no         |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    |           16 | Frank        | Harris       | Google Inc.                                      | 1600 Amphitheatre Parkway                | Mountain View       | CA       | USA            | 94043-1351    | +1 (650) 253-0000   | +1 (650) 253-0000  | fharris@google.com            |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    |            5 | František    | Wichterlová  | JetBrains s.r.o.                                 | Klanova 9/506                            | Prague              | ---      | Czech Republic | 14700         | +420 2 4172 5555    | +420 2 4172 5555   | frantisekw@jetbrains.com      |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    |           14 | Mark         | Philips      | Telus                                            | 8210 111 ST NW                           | Edmonton            | AB       | Canada         | T6G 2C7       | +1 (780) 434-4554   | +1 (780) 434-5565  | mphilips12@shaw.ca            |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    |           22 | Heather      | Leacock      | ---                                              | 120 S Orange Ave                         | Orlando             | FL       | USA            | 32801         | +1 (407) 999-7788   | ---                | hleacock@gmail.com            |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    |            3 | François     | Tremblay     | ---                                              | 1498 rue Bélanger                        | Montréal            | QC       | Canada         | H2G 1A7       | +1 (514) 721-4711   | ---                | ftremblay@gmail.com           |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    |           18 | Michelle     | Brooks       | ---                                              | 627 Broadway                             | New York            | NY       | USA            | 10012-2612    | +1 (212) 221-3546   | +1 (212) 221-4679  | michelleb@aol.com             |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    |           45 | Ladislav     | Kovács       | ---                                              | Erzsébet krt. 58.                        | Budapest            | ---      | Hungary        | H-1073        | ---                 | ---                | ladislav_kovacs@apple.hu      |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    |           52 | Emma         | Jones        | ---                                              | 202 Hoxton Street                        | London              | ---      | United Kingdom | N1 5LH        | +44 020 7707 0707   | ---                | emma_jones@hotmail.com        |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    |           26 | Richard      | Cunningham   | ---                                              | 2211 W Berry Street                      | Fort Worth          | TX       | USA            | 76110         | +1 (817) 924-7272   | ---                | ricunningham@hotmail.com      |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    |           44 | Terhi        | Hämäläinen   | ---                                              | Porthaninkatu 9                          | Helsinki            | ---      | Finland        | 00530         | +358 09 870 2000    | ---                | terhi.hamalainen@apple.fi     |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    |           15 | Jennifer     | Peterson     | Rogers Canada                                    | 700 W Pender Street                      | Vancouver           | BC       | Canada         | V6C 1G8       | +1 (604) 688-2255   | +1 (604) 688-8756  | jenniferp@rogers.ca           |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    |           54 | Steve        | Murray       | ---                                              | 110 Raeburn Pl                           | Edinburgh           | ---      | United Kingdom | EH4 1HH       | +44 0131 315 3300   | ---                | steve.murray@yahoo.uk         |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    |            9 | Kara         | Nielsen      | ---                                              | Sønder Boulevard 51                      | Copenhagen          | ---      | Denmark        | 1720          | +453 3331 9991      | ---                | kara.nielsen@jubii.dk         |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    |           30 | Edward       | Francis      | ---                                              | 230 Elgin Street                         | Ottawa              | ON       | Canada         | K2P 1L7       | +1 (613) 234-3322   | ---                | edfrancis@yachoo.ca           |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    |           17 | Jack         | Smith        | Microsoft Corporation                            | 1 Microsoft Way                          | Redmond             | WA       | USA            | 98052-8300    | +1 (425) 882-8080   | +1 (425) 882-8081  | jacksmith@microsoft.com       |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    |           35 | Madalena     | Sampaio      | ---                                              | Rua dos Campeões Europeus de Viena, 4350 | Porto               | ---      | Portugal       | ---           | +351 (225) 022-448  | ---                | masampaio@sapo.pt             |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    |           27 | Patrick      | Gray         | ---                                              | 1033 N Park Ave                          | Tucson              | AZ       | USA            | 85719         | +1 (520) 622-4200   | ---                | patrick.gray@aol.com          |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    |           40 | Dominique    | Lefebvre     | ---                                              | 8, Rue Hanovre                           | Paris               | ---      | France         | 75002         | +33 01 47 42 71 71  | ---                | dominiquelefebvre@gmail.com   |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    |            8 | Daan         | Peeters      | ---                                              | Grétrystraat 63                          | Brussels            | ---      | Belgium        | 1000          | +32 02 219 03 03    | ---                | daan_peeters@apple.be         |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    |           49 | Stanisław    | Wójcik       | ---                                              | Ordynacka 10                             | Warsaw              | ---      | Poland         | 00-358        | +48 22 828 37 39    | ---                | stanisław.wójcik@wp.pl        |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    |           12 | Roberto      | Almeida      | Riotur                                           | Praça Pio X, 119                         | Rio de Janeiro      | RJ       | Brazil         | 20040-020     | +55 (21) 2271-7000  | +55 (21) 2271-7070 | roberto.almeida@riotur.gov.br |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    |           53 | Phil         | Hughes       | ---                                              | 113 Lupus St                             | London              | ---      | United Kingdom | SW1V 3EN      | +44 020 7976 5722   | ---                | phil.hughes@gmail.com         |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    |            2 | Leonie       | Köhler       | ---                                              | Theodor-Heuss-Straße 34                  | Stuttgart           | ---      | Germany        | 70174         | +49 0711 2842222    | ---                | leonekohler@surfeu.de         |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    |           36 | Hannah       | Schneider    | ---                                              | Tauentzienstraße 8                       | Berlin              | ---      | Germany        | 10789         | +49 030 26550280    | ---                | hannah.schneider@yahoo.de     |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    |           19 | Tim          | Goyer        | Apple Inc.                                       | 1 Infinite Loop                          | Cupertino           | CA       | USA            | 95014         | +1 (408) 996-1010   | +1 (408) 996-1011  | tgoyer@apple.com              |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    |           56 | Diego        | Gutiérrez    | ---                                              | 307 Macacha Güemes                       | Buenos Aires        | ---      | Argentina      | 1106          | +54 (0)11 4311 4333 | ---                | diego.gutierrez@yahoo.ar      |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    |           29 | Robert       | Brown        | ---                                              | 796 Dundas Street West                   | Toronto             | ON       | Canada         | M6J 1V1       | +1 (416) 363-8888   | ---                | robbrown@shaw.ca              |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    |            7 | Astrid       | Gruber       | ---                                              | Rotenturmstraße 4, 1010 Innere Stadt     | Vienne              | ---      | Austria        | 1010          | +43 01 5134505      | ---                | astrid.gruber@apple.at        |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    |           23 | John         | Gordon       | ---                                              | 69 Salem Street                          | Boston              | MA       | USA            | 2113          | +1 (617) 522-1333   | ---                | johngordon22@yahoo.com        |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    |           48 | Johannes     | Van der Berg | ---                                              | Lijnbaansgracht 120bg                    | Amsterdam           | VV       | Netherlands    | 1016          | +31 020 6223130     | ---                | johavanderberg@yahoo.nl       |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    |           31 | Martha       | Silk         | ---                                              | 194A Chain Lake Drive                    | Halifax             | NS       | Canada         | B3S 1C5       | +1 (902) 450-0450   | ---                | marthasilk@gmail.com          |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    |           10 | Eduardo      | Martins      | Woodstock Discos                                 | Rua Dr. Falcão Filho, 155                | São Paulo           | SP       | Brazil         | 01007-010     | +55 (11) 3033-5446  | +55 (11) 3033-4564 | eduardo@woodstock.com.br      |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    |           24 | Frank        | Ralston      | ---                                              | 162 E Superior Street                    | Chicago             | IL       | USA            | 60611         | +1 (312) 332-3232   | ---                | fralston@gmail.com            |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    |            1 | Luís         | Gonçalves    | Embraer - Empresa Brasileira de Aeronáutica S.A. | Av. Brigadeiro Faria Lima, 2170          | São José dos Campos | SP       | Brazil         | 12227-000     | +55 (12) 3923-5555  | +55 (12) 3923-5566 | luisg@embraer.com.br          |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    |           20 | Dan          | Miller       | ---                                              | 541 Del Medio Avenue                     | Mountain View       | CA       | USA            | 94040-111     | +1 (650) 644-3358   | ---                | dmiller@comcast.com           |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    |           55 | Mark         | Taylor       | ---                                              | 421 Bourke Street                        | Sidney              | NSW      | Australia      | 2010          | +61 (02) 9332 3633  | ---                | mark.taylor@yahoo.au          |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    |           47 | Lucas        | Mancini      | ---                                              | Via Degli Scipioni, 43                   | Rome                | RM       | Italy          | 00192         | +39 06 39733434     | ---                | lucas.mancini@yahoo.it        |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    |           34 | João         | Fernandes    | ---                                              | Rua da Assunção 53                       | Lisbon              | ---      | Portugal       | ---           | +351 (213) 466-111  | ---                | jfernandes@yahoo.pt           |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    |           11 | Alexandre    | Rocha        | Banco do Brasil S.A.                             | Av. Paulista, 2022                       | São Paulo           | SP       | Brazil         | 01310-200     | +55 (11) 3055-3278  | +55 (11) 3055-8131 | alero@uol.com.br              |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    |           51 | Joakim       | Johansson    | ---                                              | Celsiusg. 9                              | Stockholm           | ---      | Sweden         | 11230         | +46 08-651 52 52    | ---                | joakim.johansson@yahoo.se     |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    |           28 | Julia        | Barnett      | ---                                              | 302 S 700 E                              | Salt Lake City      | UT       | USA            | 84102         | +1 (801) 531-7272   | ---                | jubarnett@gmail.com           |            5 | Johnson    | Steve       | Sales Support Agent |           2 | 1965-03-03  | 2003-10-17 | 7727B 41 Ave     | Calgary | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    |           32 | Aaron        | Mitchell     | ---                                              | 696 Osborne Street                       | Winnipeg            | MB       | Canada         | R3L 2B9       | +1 (204) 452-6452   | ---                | aaronmitchell@yahoo.ca        |            4 | Park       | Margaret    | Sales Support Agent |           2 | 1947-09-19  | 2003-05-03 | 683 10 Street SW | Calgary | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    |           59 | Puja         | Srivastava   | ---                                              | 3,Raj Bhavan Road                        | Bangalore           | ---      | India          | 560001        | +91 080 22289999    | ---                | puja_srivastava@yahoo.in      |            3 | Peacock    | Jane        | Sales Support Agent |           2 | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW    | Calgary | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    #+end_example

    #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports none
SELECT DISTINCT EmployeeId,
       		Employee.LastName AS eLastName,
		Employee.FirstName AS eFirstName,
		Employee.Title AS eTitle,
		Employee.ReportsTo AS eReportsTo,
		Employee.BirthDate AS eBirthDate,
		Employee.HireDate AS eHireDate,
		Employee.Address AS eAddress,
		Employee.City AS eCity,
		Employee.State AS eState,
		Employee.Country AS eCountry,
		Employee.PostalCode AS ePostalCode,
		Employee.Phone AS ePhone,
		Employee.Fax AS eFax,
		Employee.Email AS eEmail,
		Customer.CustomerId AS cCustomerId,
		Customer.FirstName AS cFirstName,
		Customer.LastName AS cLastName,
		Customer.Company AS cCompany,
		Customer.Address AS cAddress,
		Customer.City AS cCity,
		Customer.State AS cState,
		Customer.Country AS cCountry,
		Customer.PostalCode AS cPostalCode,
		Customer.Phone AS cPhone,
		Customer.Fax AS cFax,
		Customer.Email AS cEmail
FROM Customer LEFT JOIN Employee
ON Employee.EmployeeId = Customer.SupportRepId;
    #+END_SRC
***** Full Outer Join
    #+BEGIN_SRC python :noweb yes :exports code
<<setup>>
cn = customer.rename({"SupportRepId": "EmployeeId", "LastName": "cLastName",
                      "FirstName": "cFirstName", "Company": "cCompany",
                      "Address": "cAddress", "City": "cCity", "State": "cState",
                      "Country": "cCountry", "PostalCode": "cPostalCode",
                      "Phone": "cPhone", "Fax": "cFax", "Email": "cEmail"})
jn = employee.outer(cn)
return str(RelationOrg(jn))
    #+END_SRC

    #+RESULTS:
    #+begin_example
    | CustomerId   | cFirstName   | cLastName    | cCompany                                         | cAddress                                 | cCity               | cState   | cCountry       | cPostalCode   | cPhone              | cFax               | cEmail                        |   EmployeeId | LastName   | FirstName   | Title               | ReportsTo   | BirthDate   | HireDate   | Address                     | City       | State   | Country   | PostalCode   | Phone             | Fax               | Email                    |
    |--------------+--------------+--------------+--------------------------------------------------+------------------------------------------+---------------------+----------+----------------+---------------+---------------------+--------------------+-------------------------------+--------------+------------+-------------+---------------------+-------------+-------------+------------+-----------------------------+------------+---------+-----------+--------------+-------------------+-------------------+--------------------------|
    | 47           | Lucas        | Mancini      | ---                                              | Via Degli Scipioni, 43                   | Rome                | RM       | Italy          | 00192         | +39 06 39733434     | ---                | lucas.mancini@yahoo.it        |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    | ---          | ---          | ---          | ---                                              | ---                                      | ---                 | ---      | ---            | ---           | ---                 | ---                | ---                           |            6 | Mitchell   | Michael     | IT Manager          | 1           | 1973-07-01  | 2003-10-17 | 5827 Bowness Road NW        | Calgary    | AB      | Canada    | T3B 0C5      | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com  |
    | 34           | João         | Fernandes    | ---                                              | Rua da Assunção 53                       | Lisbon              | ---      | Portugal       | ---           | +351 (213) 466-111  | ---                | jfernandes@yahoo.pt           |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    | 23           | John         | Gordon       | ---                                              | 69 Salem Street                          | Boston              | MA       | USA            | 2113          | +1 (617) 522-1333   | ---                | johngordon22@yahoo.com        |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    | 32           | Aaron        | Mitchell     | ---                                              | 696 Osborne Street                       | Winnipeg            | MB       | Canada         | R3L 2B9       | +1 (204) 452-6452   | ---                | aaronmitchell@yahoo.ca        |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    | 54           | Steve        | Murray       | ---                                              | 110 Raeburn Pl                           | Edinburgh           | ---      | United Kingdom | EH4 1HH       | +44 0131 315 3300   | ---                | steve.murray@yahoo.uk         |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    | 40           | Dominique    | Lefebvre     | ---                                              | 8, Rue Hanovre                           | Paris               | ---      | France         | 75002         | +33 01 47 42 71 71  | ---                | dominiquelefebvre@gmail.com   |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    | 56           | Diego        | Gutiérrez    | ---                                              | 307 Macacha Güemes                       | Buenos Aires        | ---      | Argentina      | 1106          | +54 (0)11 4311 4333 | ---                | diego.gutierrez@yahoo.ar      |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    | 28           | Julia        | Barnett      | ---                                              | 302 S 700 E                              | Salt Lake City      | UT       | USA            | 84102         | +1 (801) 531-7272   | ---                | jubarnett@gmail.com           |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    | 12           | Roberto      | Almeida      | Riotur                                           | Praça Pio X, 119                         | Rio de Janeiro      | RJ       | Brazil         | 20040-020     | +55 (21) 2271-7000  | +55 (21) 2271-7070 | roberto.almeida@riotur.gov.br |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    | 51           | Joakim       | Johansson    | ---                                              | Celsiusg. 9                              | Stockholm           | ---      | Sweden         | 11230         | +46 08-651 52 52    | ---                | joakim.johansson@yahoo.se     |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    | 13           | Fernanda     | Ramos        | ---                                              | Qe 7 Bloco G                             | Brasília            | DF       | Brazil         | 71020-677     | +55 (61) 3363-5547  | +55 (61) 3363-7855 | fernadaramos4@uol.com.br      |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    | 3            | François     | Tremblay     | ---                                              | 1498 rue Bélanger                        | Montréal            | QC       | Canada         | H2G 1A7       | +1 (514) 721-4711   | ---                | ftremblay@gmail.com           |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    | 26           | Richard      | Cunningham   | ---                                              | 2211 W Berry Street                      | Fort Worth          | TX       | USA            | 76110         | +1 (817) 924-7272   | ---                | ricunningham@hotmail.com      |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    | 10           | Eduardo      | Martins      | Woodstock Discos                                 | Rua Dr. Falcão Filho, 155                | São Paulo           | SP       | Brazil         | 01007-010     | +55 (11) 3033-5446  | +55 (11) 3033-4564 | eduardo@woodstock.com.br      |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    | ---          | ---          | ---          | ---                                              | ---                                      | ---                 | ---      | ---            | ---           | ---                 | ---                | ---                           |            1 | Adams      | Andrew      | General Manager     | ---         | 1962-02-18  | 2002-08-14 | 11120 Jasper Ave NW         | Edmonton   | AB      | Canada    | T5K 2N1      | +1 (780) 428-9482 | +1 (780) 428-3457 | andrew@chinookcorp.com   |
    | 30           | Edward       | Francis      | ---                                              | 230 Elgin Street                         | Ottawa              | ON       | Canada         | K2P 1L7       | +1 (613) 234-3322   | ---                | edfrancis@yachoo.ca           |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    | 24           | Frank        | Ralston      | ---                                              | 162 E Superior Street                    | Chicago             | IL       | USA            | 60611         | +1 (312) 332-3232   | ---                | fralston@gmail.com            |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    | 49           | Stanisław    | Wójcik       | ---                                              | Ordynacka 10                             | Warsaw              | ---      | Poland         | 00-358        | +48 22 828 37 39    | ---                | stanisław.wójcik@wp.pl        |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    | 36           | Hannah       | Schneider    | ---                                              | Tauentzienstraße 8                       | Berlin              | ---      | Germany        | 10789         | +49 030 26550280    | ---                | hannah.schneider@yahoo.de     |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    | 41           | Marc         | Dubois       | ---                                              | 11, Place Bellecour                      | Lyon                | ---      | France         | 69002         | +33 04 78 30 30 30  | ---                | marc.dubois@hotmail.com       |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    | 33           | Ellie        | Sullivan     | ---                                              | 5112 48 Street                           | Yellowknife         | NT       | Canada         | X1A 1N6       | +1 (867) 920-2233   | ---                | ellie.sullivan@shaw.ca        |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    | 8            | Daan         | Peeters      | ---                                              | Grétrystraat 63                          | Brussels            | ---      | Belgium        | 1000          | +32 02 219 03 03    | ---                | daan_peeters@apple.be         |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    | 16           | Frank        | Harris       | Google Inc.                                      | 1600 Amphitheatre Parkway                | Mountain View       | CA       | USA            | 94043-1351    | +1 (650) 253-0000   | +1 (650) 253-0000  | fharris@google.com            |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    | ---          | ---          | ---          | ---                                              | ---                                      | ---                 | ---      | ---            | ---           | ---                 | ---                | ---                           |            8 | Callahan   | Laura       | IT Staff            | 6           | 1968-01-09  | 2004-03-04 | 923 7 ST NW                 | Lethbridge | AB      | Canada    | T1H 1Y8      | +1 (403) 467-3351 | +1 (403) 467-8772 | laura@chinookcorp.com    |
    | 29           | Robert       | Brown        | ---                                              | 796 Dundas Street West                   | Toronto             | ON       | Canada         | M6J 1V1       | +1 (416) 363-8888   | ---                | robbrown@shaw.ca              |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    | 44           | Terhi        | Hämäläinen   | ---                                              | Porthaninkatu 9                          | Helsinki            | ---      | Finland        | 00530         | +358 09 870 2000    | ---                | terhi.hamalainen@apple.fi     |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    | ---          | ---          | ---          | ---                                              | ---                                      | ---                 | ---      | ---            | ---           | ---                 | ---                | ---                           |            7 | King       | Robert      | IT Staff            | 6           | 1970-05-29  | 2004-01-02 | 590 Columbia Boulevard West | Lethbridge | AB      | Canada    | T1K 5N8      | +1 (403) 456-9986 | +1 (403) 456-8485 | robert@chinookcorp.com   |
    | 57           | Luis         | Rojas        | ---                                              | Calle Lira, 198                          | Santiago            | ---      | Chile          | ---           | +56 (0)2 635 4444   | ---                | luisrojas@yahoo.cl            |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    | 42           | Wyatt        | Girard       | ---                                              | 9, Place Louis Barthou                   | Bordeaux            | ---      | France         | 33000         | +33 05 56 96 96 96  | ---                | wyatt.girard@yahoo.fr         |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    | 31           | Martha       | Silk         | ---                                              | 194A Chain Lake Drive                    | Halifax             | NS       | Canada         | B3S 1C5       | +1 (902) 450-0450   | ---                | marthasilk@gmail.com          |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    | 14           | Mark         | Philips      | Telus                                            | 8210 111 ST NW                           | Edmonton            | AB       | Canada         | T6G 2C7       | +1 (780) 434-4554   | +1 (780) 434-5565  | mphilips12@shaw.ca            |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    | 21           | Kathy        | Chase        | ---                                              | 801 W 4th Street                         | Reno                | NV       | USA            | 89503         | +1 (775) 223-7665   | ---                | kachase@hotmail.com           |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    | 7            | Astrid       | Gruber       | ---                                              | Rotenturmstraße 4, 1010 Innere Stadt     | Vienne              | ---      | Austria        | 1010          | +43 01 5134505      | ---                | astrid.gruber@apple.at        |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    | 11           | Alexandre    | Rocha        | Banco do Brasil S.A.                             | Av. Paulista, 2022                       | São Paulo           | SP       | Brazil         | 01310-200     | +55 (11) 3055-3278  | +55 (11) 3055-8131 | alero@uol.com.br              |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    | 35           | Madalena     | Sampaio      | ---                                              | Rua dos Campeões Europeus de Viena, 4350 | Porto               | ---      | Portugal       | ---           | +351 (225) 022-448  | ---                | masampaio@sapo.pt             |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    | 1            | Luís         | Gonçalves    | Embraer - Empresa Brasileira de Aeronáutica S.A. | Av. Brigadeiro Faria Lima, 2170          | São José dos Campos | SP       | Brazil         | 12227-000     | +55 (12) 3923-5555  | +55 (12) 3923-5566 | luisg@embraer.com.br          |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    | 59           | Puja         | Srivastava   | ---                                              | 3,Raj Bhavan Road                        | Bangalore           | ---      | India          | 560001        | +91 080 22289999    | ---                | puja_srivastava@yahoo.in      |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    | 5            | František    | Wichterlová  | JetBrains s.r.o.                                 | Klanova 9/506                            | Prague              | ---      | Czech Republic | 14700         | +420 2 4172 5555    | +420 2 4172 5555   | frantisekw@jetbrains.com      |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    | 9            | Kara         | Nielsen      | ---                                              | Sønder Boulevard 51                      | Copenhagen          | ---      | Denmark        | 1720          | +453 3331 9991      | ---                | kara.nielsen@jubii.dk         |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    | 48           | Johannes     | Van der Berg | ---                                              | Lijnbaansgracht 120bg                    | Amsterdam           | VV       | Netherlands    | 1016          | +31 020 6223130     | ---                | johavanderberg@yahoo.nl       |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    | 22           | Heather      | Leacock      | ---                                              | 120 S Orange Ave                         | Orlando             | FL       | USA            | 32801         | +1 (407) 999-7788   | ---                | hleacock@gmail.com            |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    | 38           | Niklas       | Schröder     | ---                                              | Barbarossastraße 19                      | Berlin              | ---      | Germany        | 10779         | +49 030 2141444     | ---                | nschroder@surfeu.de           |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    | 53           | Phil         | Hughes       | ---                                              | 113 Lupus St                             | London              | ---      | United Kingdom | SW1V 3EN      | +44 020 7976 5722   | ---                | phil.hughes@gmail.com         |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    | 6            | Helena       | Holý         | ---                                              | Rilská 3174/6                            | Prague              | ---      | Czech Republic | 14300         | +420 2 4177 0449    | ---                | hholy@gmail.com               |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    | 17           | Jack         | Smith        | Microsoft Corporation                            | 1 Microsoft Way                          | Redmond             | WA       | USA            | 98052-8300    | +1 (425) 882-8080   | +1 (425) 882-8081  | jacksmith@microsoft.com       |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    | 46           | Hugh         | O'Reilly     | ---                                              | 3 Chatham Street                         | Dublin              | Dublin   | Ireland        | ---           | +353 01 6792424     | ---                | hughoreilly@apple.ie          |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    | 18           | Michelle     | Brooks       | ---                                              | 627 Broadway                             | New York            | NY       | USA            | 10012-2612    | +1 (212) 221-3546   | +1 (212) 221-4679  | michelleb@aol.com             |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    | 20           | Dan          | Miller       | ---                                              | 541 Del Medio Avenue                     | Mountain View       | CA       | USA            | 94040-111     | +1 (650) 644-3358   | ---                | dmiller@comcast.com           |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    | 50           | Enrique      | Muñoz        | ---                                              | C/ San Bernardo 85                       | Madrid              | ---      | Spain          | 28015         | +34 914 454 454     | ---                | enrique_munoz@yahoo.es        |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    | ---          | ---          | ---          | ---                                              | ---                                      | ---                 | ---      | ---            | ---           | ---                 | ---                | ---                           |            2 | Edwards    | Nancy       | Sales Manager       | 1           | 1958-12-08  | 2002-05-01 | 825 8 Ave SW                | Calgary    | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com    |
    | 58           | Manoj        | Pareek       | ---                                              | 12,Community Centre                      | Delhi               | ---      | India          | 110017        | +91 0124 39883988   | ---                | manoj.pareek@rediff.com       |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    | 25           | Victor       | Stevens      | ---                                              | 319 N. Frances Street                    | Madison             | WI       | USA            | 53703         | +1 (608) 257-0597   | ---                | vstevens@yahoo.com            |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    | 15           | Jennifer     | Peterson     | Rogers Canada                                    | 700 W Pender Street                      | Vancouver           | BC       | Canada         | V6C 1G8       | +1 (604) 688-2255   | +1 (604) 688-8756  | jenniferp@rogers.ca           |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    | 55           | Mark         | Taylor       | ---                                              | 421 Bourke Street                        | Sidney              | NSW      | Australia      | 2010          | +61 (02) 9332 3633  | ---                | mark.taylor@yahoo.au          |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    | 27           | Patrick      | Gray         | ---                                              | 1033 N Park Ave                          | Tucson              | AZ       | USA            | 85719         | +1 (520) 622-4200   | ---                | patrick.gray@aol.com          |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    | 4            | Bjørn        | Hansen       | ---                                              | Ullevålsveien 14                         | Oslo                | ---      | Norway         | 0171          | +47 22 44 22 22     | ---                | bjorn.hansen@yahoo.no         |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    | 37           | Fynn         | Zimmermann   | ---                                              | Berger Straße 10                         | Frankfurt           | ---      | Germany        | 60316         | +49 069 40598889    | ---                | fzimmermann@yahoo.de          |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    | 45           | Ladislav     | Kovács       | ---                                              | Erzsébet krt. 58.                        | Budapest            | ---      | Hungary        | H-1073        | ---                 | ---                | ladislav_kovacs@apple.hu      |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    | 39           | Camille      | Bernard      | ---                                              | 4, Rue Milton                            | Paris               | ---      | France         | 75009         | +33 01 49 70 65 65  | ---                | camille.bernard@yahoo.fr      |            4 | Park       | Margaret    | Sales Support Agent | 2           | 1947-09-19  | 2003-05-03 | 683 10 Street SW            | Calgary    | AB      | Canada    | T2P 5G3      | +1 (403) 263-4423 | +1 (403) 263-4289 | margaret@chinookcorp.com |
    | 43           | Isabelle     | Mercier      | ---                                              | 68, Rue Jouvence                         | Dijon               | ---      | France         | 21000         | +33 03 80 73 66 99  | ---                | isabelle_mercier@apple.fr     |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    | 19           | Tim          | Goyer        | Apple Inc.                                       | 1 Infinite Loop                          | Cupertino           | CA       | USA            | 95014         | +1 (408) 996-1010   | +1 (408) 996-1011  | tgoyer@apple.com              |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    | 2            | Leonie       | Köhler       | ---                                              | Theodor-Heuss-Straße 34                  | Stuttgart           | ---      | Germany        | 70174         | +49 0711 2842222    | ---                | leonekohler@surfeu.de         |            5 | Johnson    | Steve       | Sales Support Agent | 2           | 1965-03-03  | 2003-10-17 | 7727B 41 Ave                | Calgary    | AB      | Canada    | T3B 1Y7      | 1 (780) 836-9987  | 1 (780) 836-9543  | steve@chinookcorp.com    |
    | 52           | Emma         | Jones        | ---                                              | 202 Hoxton Street                        | London              | ---      | United Kingdom | N1 5LH        | +44 020 7707 0707   | ---                | emma_jones@hotmail.com        |            3 | Peacock    | Jane        | Sales Support Agent | 2           | 1973-08-29  | 2002-04-01 | 1111 6 Ave SW               | Calgary    | AB      | Canada    | T2P 5M5      | +1 (403) 262-3443 | +1 (403) 262-6712 | jane@chinookcorp.com     |
    #+end_example

    #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports none
SELECT DISTINCT EmployeeId,
       		Employee.LastName AS eLastName,
		Employee.FirstName AS eFirstName,
		Employee.Title AS eTitle,
		Employee.ReportsTo AS eReportsTo,
		Employee.BirthDate AS eBirthDate,
		Employee.HireDate AS eHireDate,
		Employee.Address AS eAddress,
		Employee.City AS eCity,
		Employee.State AS eState,
		Employee.Country AS eCountry,
		Employee.PostalCode AS ePostalCode,
		Employee.Phone AS ePhone,
		Employee.Fax AS eFax,
		Employee.Email AS eEmail,
		Customer.CustomerId AS cCustomerId,
		Customer.FirstName AS cFirstName,
		Customer.LastName AS cLastName,
		Customer.Company AS cCompany,
		Customer.Address AS cAddress,
		Customer.City AS cCity,
		Customer.State AS cState,
		Customer.Country AS cCountry,
		Customer.PostalCode AS cPostalCode,
		Customer.Phone AS cPhone,
		Customer.Fax AS cFax,
		Customer.Email AS cEmail
FROM Employee LEFT JOIN Customer
ON Employee.EmployeeId = Customer.SupportRepId
UNION
SELECT DISTINCT EmployeeId,
       		Employee.LastName AS eLastName,
		Employee.FirstName AS eFirstName,
		Employee.Title AS eTitle,
		Employee.ReportsTo AS eReportsTo,
		Employee.BirthDate AS eBirthDate,
		Employee.HireDate AS eHireDate,
		Employee.Address AS eAddress,
		Employee.City AS eCity,
		Employee.State AS eState,
		Employee.Country AS eCountry,
		Employee.PostalCode AS ePostalCode,
		Employee.Phone AS ePhone,
		Employee.Fax AS eFax,
		Employee.Email AS eEmail,
		Customer.CustomerId AS cCustomerId,
		Customer.FirstName AS cFirstName,
		Customer.LastName AS cLastName,
		Customer.Company AS cCompany,
		Customer.Address AS cAddress,
		Customer.City AS cCity,
		Customer.State AS cState,
		Customer.Country AS cCountry,
		Customer.PostalCode AS cPostalCode,
		Customer.Phone AS cPhone,
		Customer.Fax AS cFax,
		Customer.Email AS cEmail
FROM Customer LEFT JOIN Employee
ON Employee.EmployeeId = Customer.SupportRepId;
    #+END_SRC
**** Anti-Join
     Relational does not currently provide an anti-join operation.  Antijoin
     returns those entries in the first table that do not have a corresponding
     joining value in the second table.  I added the antijoin operation to
     Relational using the definition given on Wikipedia;
     #+BEGIN_SRC python :exports code :eval no
return self.difference(self.semijoin_left(other))
     #+END_SRC
     Like other methods in the ~Relational~ class, ~antijoin~ takes a single table
     class argument, anti-joins it onto the acting object, and returns a new
     table object.  In the following example, ~employee~ is antijoined with
     ~customer~, joining on ~EmployeeId~.  Equivalently named columns that are not
     joined on have to be renamed in one of the tables.

    #+BEGIN_SRC python :noweb yes :exports code
<<setup>>
cn = customer.rename({"SupportRepId": "EmployeeId", "LastName": "cLastName",
                      "FirstName": "cFirstName", "Company": "cCompany",
                      "Address": "cAddress", "City": "cCity", "State": "cState",
                      "Country": "cCountry", "PostalCode": "cPostalCode",
                      "Phone": "cPhone", "Fax": "cFax", "Email": "cEmail"})
jn = employee.antijoin(cn)
return str(RelationOrg(jn))
    #+END_SRC

    #+RESULTS:
    : |   EmployeeId | LastName   | FirstName   | Title           | ReportsTo   | BirthDate   | HireDate   | Address                     | City       | State   | Country   | PostalCode   | Phone             | Fax               | Email                   |
    : |--------------+------------+-------------+-----------------+-------------+-------------+------------+-----------------------------+------------+---------+-----------+--------------+-------------------+-------------------+-------------------------|
    : |            6 | Mitchell   | Michael     | IT Manager      | 1           | 1973-07-01  | 2003-10-17 | 5827 Bowness Road NW        | Calgary    | AB      | Canada    | T3B 0C5      | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com |
    : |            8 | Callahan   | Laura       | IT Staff        | 6           | 1968-01-09  | 2004-03-04 | 923 7 ST NW                 | Lethbridge | AB      | Canada    | T1H 1Y8      | +1 (403) 467-3351 | +1 (403) 467-8772 | laura@chinookcorp.com   |
    : |            1 | Adams      | Andrew      | General Manager | ---         | 1962-02-18  | 2002-08-14 | 11120 Jasper Ave NW         | Edmonton   | AB      | Canada    | T5K 2N1      | +1 (780) 428-9482 | +1 (780) 428-3457 | andrew@chinookcorp.com  |
    : |            7 | King       | Robert      | IT Staff        | 6           | 1970-05-29  | 2004-01-02 | 590 Columbia Boulevard West | Lethbridge | AB      | Canada    | T1K 5N8      | +1 (403) 456-9986 | +1 (403) 456-8485 | robert@chinookcorp.com  |
    : |            2 | Edwards    | Nancy       | Sales Manager   | 1           | 1958-12-08  | 2002-05-01 | 825 8 Ave SW                | Calgary    | AB      | Canada    | T2P 2T3      | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com   |

***** With Correlated Subqueries
      In SQL, the typical way of performing an antijoin is by using correlated
      subqueries.
      
      #+NAME: aj-corr-sq
      #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports code
SELECT DISTINCT EmployeeId,
       Employee.LastName,
       Employee.FirstName,
       Employee.Title,
       Employee.ReportsTo,
       Employee.BirthDate,
       Employee.HireDate,
       Employee.Address,
       Employee.City,
       Employee.State,
       Employee.Country,
       Employee.PostalCode,
       Employee.Phone,
       Employee.Fax,
       Employee.Email
FROM Employee WHERE NOT EXISTS
(SELECT * FROM Customer
WHERE Employee.EmployeeId = Customer.SupportRepId);
      #+END_SRC

      #+RESULTS: aj-corr-sq
      | 1 | Adams    | Andrew  | General Manager |   | 1962-02-18 00:00:00 | 2002-08-14 00:00:00 | 11120 Jasper Ave NW         | Edmonton   | AB | Canada | T5K 2N1 | +1 (780) 428-9482 | +1 (780) 428-3457 | andrew@chinookcorp.com  |
      | 2 | Edwards  | Nancy   | Sales Manager   | 1 | 1958-12-08 00:00:00 | 2002-05-01 00:00:00 | 825 8 Ave SW                | Calgary    | AB | Canada | T2P 2T3 | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com   |
      | 6 | Mitchell | Michael | IT Manager      | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW        | Calgary    | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com |
      | 7 | King     | Robert  | IT Staff        | 6 | 1970-05-29 00:00:00 | 2004-01-02 00:00:00 | 590 Columbia Boulevard West | Lethbridge | AB | Canada | T1K 5N8 | +1 (403) 456-9986 | +1 (403) 456-8485 | robert@chinookcorp.com  |
      | 8 | Callahan | Laura   | IT Staff        | 6 | 1968-01-09 00:00:00 | 2004-03-04 00:00:00 | 923 7 ST NW                 | Lethbridge | AB | Canada | T1H 1Y8 | +1 (403) 467-3351 | +1 (403) 467-8772 | laura@chinookcorp.com   |

      This query has the following plan in SQLite.

      #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports results :noweb yes
EXPLAIN QUERY PLAN
<<aj-corr-sq>>
      #+END_SRC

      #+RESULTS:
      | SCAN TABLE Employee                                                         |
      | EXECUTE CORRELATED SCALAR SUBQUERY 1                                        |
      | SEARCH TABLE Customer USING INDEX IFK_CustomerSupportRepId (SupportRepId=?) |

***** With the Relation Algebra Definition
      #+NAME: aj-ra-alg
      #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports code
SELECT DISTINCT * FROM Employee
EXCEPT
SELECT EmployeeId,
       Employee.LastName,
       Employee.FirstName,
       Employee.Title,
       Employee.ReportsTo,
       Employee.BirthDate,
       Employee.HireDate,
       Employee.Address,
       Employee.City,
       Employee.State,
       Employee.Country,
       Employee.PostalCode,
       Employee.Phone,
       Employee.Fax,
       Employee.Email
FROM Employee JOIN Customer
ON Employee.EmployeeId = Customer.SupportRepId;
      #+END_SRC

      #+RESULTS: aj-ra-alg
      | 1 | Adams    | Andrew  | General Manager |   | 1962-02-18 00:00:00 | 2002-08-14 00:00:00 | 11120 Jasper Ave NW         | Edmonton   | AB | Canada | T5K 2N1 | +1 (780) 428-9482 | +1 (780) 428-3457 | andrew@chinookcorp.com  |
      | 2 | Edwards  | Nancy   | Sales Manager   | 1 | 1958-12-08 00:00:00 | 2002-05-01 00:00:00 | 825 8 Ave SW                | Calgary    | AB | Canada | T2P 2T3 | +1 (403) 262-3443 | +1 (403) 262-3322 | nancy@chinookcorp.com   |
      | 6 | Mitchell | Michael | IT Manager      | 1 | 1973-07-01 00:00:00 | 2003-10-17 00:00:00 | 5827 Bowness Road NW        | Calgary    | AB | Canada | T3B 0C5 | +1 (403) 246-9887 | +1 (403) 246-9899 | michael@chinookcorp.com |
      | 7 | King     | Robert  | IT Staff        | 6 | 1970-05-29 00:00:00 | 2004-01-02 00:00:00 | 590 Columbia Boulevard West | Lethbridge | AB | Canada | T1K 5N8 | +1 (403) 456-9986 | +1 (403) 456-8485 | robert@chinookcorp.com  |
      | 8 | Callahan | Laura   | IT Staff        | 6 | 1968-01-09 00:00:00 | 2004-03-04 00:00:00 | 923 7 ST NW                 | Lethbridge | AB | Canada | T1H 1Y8 | +1 (403) 467-3351 | +1 (403) 467-8772 | laura@chinookcorp.com   |

      It has the following plan in SQLite.

      #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports results :noweb yes
EXPLAIN QUERY PLAN
<<aj-ra-alg>>
      #+END_SRC

      #+CAPTION: Query Plan
      | SCAN TABLE Employee                                               |
      | SCAN TABLE Customer USING COVERING INDEX IFK_CustomerSupportRepId |
      | SEARCH TABLE Employee USING INTEGER PRIMARY KEY (rowid=?)         |
      | COMPOUND SUBQUERIES 1 AND 2 USING TEMP B-TREE (EXCEPT)            |

      I prefer the relational algebra definition over the correlated subquery
      definition. In toolkits such as [[http://www.sqlalchemy.org/][SQLAlchemy]], it is difficult to code
      correlated subqueries. This anti-join might not produce the same results
      in all cases as the other due to null equality handling
      differences. ~EXCEPT~ treats them as equivalent. It may be possible to
      modify this query to treat nulls as not equal. This issue would only arise
      if nulls exist in the joining columns. Null columns could be added to the
      anti-join result by intersecting the projection of the two tables' joining
      columns, selecting those rows that contain nulls, select the corresponding
      rows in the first table, and unioning them to the antijoin result.

**** Division
     Division is an operation that is somewhat difficult to grasp, and the
     traditional correlated SQL query even more difficult. When dividing
     one table by another, columns unique to the first table are returned.
     The column names in the second table must be a subset of the first.
     Rows in the first table can be thought of as being grouped by values in the
     return columns. A group is returned only if, for every row in the
     second table, there exists a row in the group with values that exist in the
     second table.

     In Python, like the other Relational methods, division takes a single table
     argument and returns a relation table object.

    #+BEGIN_SRC python :noweb yes :exports code
<<setup>>
cp = customer.projection("CustomerId", "State")
ep = employee.projection("State")
div = cp.division(ep)
cust = customer.semijoin_left(div)
return str(RelationOrg(cust))
    #+END_SRC

    #+RESULTS:
    : |   CustomerId | FirstName   | LastName   | Company   | Address        | City     | State   | Country   | PostalCode   | Phone             | Fax               | Email              |   SupportRepId |
    : |--------------+-------------+------------+-----------+----------------+----------+---------+-----------+--------------+-------------------+-------------------+--------------------+----------------|
    : |           14 | Mark        | Philips    | Telus     | 8210 111 ST NW | Edmonton | AB      | Canada    | T6G 2C7      | +1 (780) 434-4554 | +1 (780) 434-5565 | mphilips12@shaw.ca |              5 |

***** Example
      In this example, columns A and B are common to the input tables and C and
      D are unique to the first. Only the group of rows with 0,0 in C,D
      have all of the A,B columns values existing in the second table.

      #+CAPTION: Dividend
      #+NAME: Dividend
      | A | B | C | D |
      | 0 | 1 | 0 | 0 |
      | 1 | 0 | 0 | 0 |
      | 1 | 1 | 0 | 0 |
      | 1 | 0 | 1 | 0 |
      | 1 | 1 | 3 | 1 |
  
      #+CAPTION: Divisor
      #+NAME: Divisor
      | A | B |
      | 1 | 0 |
      | 1 | 1 |
  
      #+BEGIN_SRC python :var in_table=Dividend other_table=Divisor :exports code
import sys
sys.path.append("/home/devin/projects/relational/")
from relational.relation_org import RelationOrg
rel1 = RelationOrg(in_table)
rel2 = RelationOrg(other_table)
prod = rel1.division(rel2)
return str(RelationOrg(prod))
      #+END_SRC

      #+CAPTION: Quotient
      | C | D |
      | 0 | 0 |

***** Relational Algebra Definition
      The Wikipedia page on relational algebra defines the division of table $R$ by table $S$ as:
      $R\div S = \pi_pR - V$; where $p$ is the set of columns unique to $R$.

      Substituting $V$:
      $R\div S = \pi_pR - \pi_pU$
      Substituting U:
      $R\div S = \pi_pR - \pi_p(T - R)$
      Substituting T:
      $R\div S = \pi_pR - \pi_p(\pi_pR\times S - R)$

      In Relational Python:
    #+BEGIN_SRC python :noweb yes :exports code
<<setup>>
R = customer.projection("CustomerId", "State")
S = employee.projection("State")
pi_R = R.projection("CustomerId")
cross = pi_R.product(S)
diff = cross.difference(R)
pi_diff = diff.projection("CustomerId")
div = pi_R.difference(pi_diff)
return str(RelationOrg(div))
    #+END_SRC

    #+RESULTS:
    : |   CustomerId |
    : |--------------|
    : |           14 |

***** With Correlated Subqueries
      The way division is traditionally performed in SQL textbooks is by using
      correlated subqueries.

      #+NAME: div-codd
      #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports both
SELECT DISTINCT Quotient.CustomerId
FROM Customer AS Quotient
WHERE NOT EXISTS
  (SELECT Dividend.state
   FROM Employee AS Dividend
   WHERE NOT EXISTS
     (SELECT Divisor.state
      FROM Customer AS Divisor
      WHERE Dividend.state = Divisor.state
      AND Quotient.CustomerId = Divisor.CustomerId));
      #+END_SRC

      #+RESULTS: div-codd
      : 14
  
      This query has the following plan in SQLite.
      #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports results :noweb yes
EXPLAIN QUERY PLAN
<<div-codd>>
      #+END_SRC
  
      #+CAPTION: Query Plan
      | SCAN TABLE Customer AS Quotient USING COVERING INDEX IFK_CustomerSupportRepId |
      | EXECUTE CORRELATED SCALAR SUBQUERY 1                                          |
      | SCAN TABLE Employee AS Dividend                                               |
      | EXECUTE CORRELATED SCALAR SUBQUERY 2                                          |
      | SEARCH TABLE Customer AS Divisor USING INTEGER PRIMARY KEY (rowid=?)          |

      #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports none :noweb yes
.timer on
<<div-codd>>
      #+END_SRC
  
      #+CAPTION: Result and Run Time
      |                                              14 |
      | Run Time: real 0.001 user 0.000000 sys 0.001000 |
  
***** With the Relation Algebra Definition
      #+NAME: ra-division-sqlite
      #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports code
SELECT DISTINCT CustomerId
FROM Customer
EXCEPT
SELECT CustomerID
FROM
  (SELECT Customer.CustomerId, Employee.state
   FROM Customer, Employee
   EXCEPT
   SELECT CustomerId, state FROM Customer);
      #+END_SRC

      #+RESULTS: ra-division-sqlite
      : 14

      #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports results :noweb yes
EXPLAIN QUERY PLAN
<<ra-division-sqlite>>
      #+END_SRC

      #+CAPTION: Query Plan
      | SCAN TABLE Customer USING COVERING INDEX IFK_CustomerSupportRepId |
      | SCAN TABLE Employee                                               |
      | SCAN TABLE Customer USING COVERING INDEX IFK_CustomerSupportRepId |
      | SCAN TABLE Customer                                               |
      | COMPOUND SUBQUERIES 4 AND 5 USING TEMP B-TREE (EXCEPT)            |
      | SCAN SUBQUERY 3                                                   |
      | COMPOUND SUBQUERIES 1 AND 2 USING TEMP B-TREE (EXCEPT)            |

      #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports none :noweb yes
.timer on
<<ra-division-sqlite>>
      #+END_SRC

      #+RESULTS:
      |                                              14 |
      | Run Time: real 0.000 user 0.000000 sys 0.000000 |

    This query plan is two steps longer than the correlated subquery version;
    however, I have found this version faster (more on that in the next
    section), and this version is more easily coded in toolkits like
    SQLAlchemy. With this version, null values are treated as equal.

** Complex Queries
   As I mentioned in the introduction, I find Relational useful for prototyping
   complex queries.  In this example, I will join a bunch of tables in the
   Chinook database and then increase the complexity in the next section by
   adding division.  You will likely find it easier to follow what is going on
   in the Relational version rather than the SQL version.  The SQL versions
   were coded after the Relational version was written.

*** Multiple Joins
    The following code joins the tables: artist, album, track, genre,
    playlist_track, and playlist; they are all joined together in order to find
    playlists that contain rock and list the artists on those playlists.

    #+BEGIN_SRC python :noweb yes :exports code
<<setup>>
artist_rn = artist.rename({"Name": "artist_name"})
track_rn = track.projection("TrackId", "AlbumId", "GenreId")
genre_rn = genre.selection("Name == 'Rock'").projection("GenreId")
playlist_rn = playlist.rename({"Name": "playlist_name"})
album_artist = artist_rn.join(album).projection("artist_name", "AlbumId")
a_a_track = album_artist.join(track_rn).projection("TrackId", "GenreId", "artist_name")
a_a_t_g = a_a_track.join(genre_rn).projection("TrackId", "artist_name")
a_a_t_g_pt = a_a_t_g.join(playlist_track)
result = a_a_t_g_pt.join(playlist_rn).projection("artist_name", "playlist_name")
return str(RelationOrg(result))
    #+END_SRC

    #+RESULTS:
    #+begin_example
    | artist_name                              | playlist_name       |
    |------------------------------------------+---------------------|
    | The Doors                                | Music               |
    | Lenny Kravitz                            | 90’s Music          |
    | Kiss                                     | 90’s Music          |
    | Nirvana                                  | 90’s Music          |
    | Pearl Jam                                | 90’s Music          |
    | R.E.M.                                   | Music               |
    | Aerosmith                                | Music               |
    | Alice In Chains                          | Grunge              |
    | Page & Plant                             | 90’s Music          |
    | Stone Temple Pilots                      | Music               |
    | The Rolling Stones                       | Music               |
    | Accept                                   | 90’s Music          |
    | U2                                       | Music               |
    | Joe Satriani                             | 90’s Music          |
    | Ozzy Osbourne                            | Heavy Metal Classic |
    | Soundgarden                              | 90’s Music          |
    | Nirvana                                  | Grunge              |
    | Jimi Hendrix                             | Music               |
    | Kiss                                     | Music               |
    | Skank                                    | 90’s Music          |
    | Scorpions                                | Music               |
    | Alice In Chains                          | 90’s Music          |
    | Ozzy Osbourne                            | 90’s Music          |
    | O Terço                                  | Music               |
    | AC/DC                                    | Heavy Metal Classic |
    | The Police                               | Music               |
    | Stone Temple Pilots                      | 90’s Music          |
    | Faith No More                            | 90’s Music          |
    | Marillion                                | Music               |
    | Soundgarden                              | Grunge              |
    | Iron Maiden                              | 90’s Music          |
    | The Cult                                 | Music               |
    | U2                                       | 90’s Music          |
    | Def Leppard                              | Music               |
    | Terry Bozzio, Tony Levin & Steve Stevens | 90’s Music          |
    | Frank Zappa & Captain Beefheart          | Music               |
    | Soundgarden                              | Music               |
    | Creedence Clearwater Revival             | Music               |
    | Guns N' Roses                            | Music               |
    | Dread Zeppelin                           | 90’s Music          |
    | Jamiroquai                               | 90’s Music          |
    | Led Zeppelin                             | 90’s Music          |
    | Deep Purple                              | 90’s Music          |
    | Red Hot Chili Peppers                    | 90’s Music          |
    | Foo Fighters                             | Music               |
    | Lenny Kravitz                            | Music               |
    | Ozzy Osbourne                            | Music               |
    | Audioslave                               | Music               |
    | Alanis Morissette                        | 90’s Music          |
    | R.E.M.                                   | 90’s Music          |
    | Rush                                     | Music               |
    | The Posies                               | Music               |
    | The Cult                                 | 90’s Music          |
    | Raul Seixas                              | Music               |
    | Santana                                  | Music               |
    | Joe Satriani                             | Music               |
    | Guns N' Roses                            | 90’s Music          |
    | Queen                                    | 90’s Music          |
    | Dread Zeppelin                           | Music               |
    | Jamiroquai                               | Music               |
    | Nirvana                                  | Music               |
    | Red Hot Chili Peppers                    | Music               |
    | Foo Fighters                             | 90’s Music          |
    | Van Halen                                | 90’s Music          |
    | David Coverdale                          | Music               |
    | Velvet Revolver                          | Music               |
    | Aerosmith                                | 90’s Music          |
    | Skank                                    | Music               |
    | AC/DC                                    | Music               |
    | Alice In Chains                          | Music               |
    | Page & Plant                             | Music               |
    | Paul D'Ianno                             | Music               |
    | Stone Temple Pilots                      | Grunge              |
    | The Police                               | 90’s Music          |
    | Pink Floyd                               | Music               |
    | The Who                                  | Music               |
    | Men At Work                              | Music               |
    | Faith No More                            | Music               |
    | Accept                                   | Heavy Metal Classic |
    | Santana                                  | 90’s Music          |
    | Terry Bozzio, Tony Levin & Steve Stevens | Music               |
    | Queen                                    | Music               |
    | Van Halen                                | Music               |
    | Led Zeppelin                             | Music               |
    | Deep Purple                              | Music               |
    | Pearl Jam                                | Music               |
    | Scorpions                                | Heavy Metal Classic |
    | Pearl Jam                                | Grunge              |
    | Alanis Morissette                        | Music               |
    | Iron Maiden                              | Music               |
    | Rush                                     | 90’s Music          |
    | The Rolling Stones                       | 90’s Music          |
    | Def Leppard                              | 90’s Music          |
    | Accept                                   | Music               |
    #+end_example

    In SQL, this translates to:
    #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports code
SELECT DISTINCT a_a_t_g_pt.Name, Playlist.Name
FROM Playlist JOIN
  (SELECT * FROM PlaylistTrack
  JOIN
    (SELECT TrackId, a_a_track.Name
    FROM Genre JOIN
      (SELECT TrackId, GenreId, album_artist.Name
      FROM Track JOIN
        (SELECT Artist.Name, AlbumId
        FROM Artist JOIN Album
        USING (ArtistId)) AS album_artist
      USING (AlbumId)) AS a_a_track
    USING (GenreId)
    WHERE Genre.Name = 'Rock')
  USING (TrackId)) AS a_a_t_g_pt
USING (PlaylistId);
    #+END_SRC

    #+RESULTS:
    | AC/DC                                    | Music               |
    | Accept                                   | Music               |
    | Aerosmith                                | Music               |
    | Alanis Morissette                        | Music               |
    | Alice In Chains                          | Music               |
    | Audioslave                               | Music               |
    | Creedence Clearwater Revival             | Music               |
    | The Cult                                 | Music               |
    | David Coverdale                          | Music               |
    | Deep Purple                              | Music               |
    | Def Leppard                              | Music               |
    | The Doors                                | Music               |
    | Dread Zeppelin                           | Music               |
    | Faith No More                            | Music               |
    | Foo Fighters                             | Music               |
    | Frank Zappa & Captain Beefheart          | Music               |
    | Guns N' Roses                            | Music               |
    | Iron Maiden                              | Music               |
    | Jamiroquai                               | Music               |
    | Jimi Hendrix                             | Music               |
    | Joe Satriani                             | Music               |
    | Kiss                                     | Music               |
    | Led Zeppelin                             | Music               |
    | Lenny Kravitz                            | Music               |
    | Marillion                                | Music               |
    | Men At Work                              | Music               |
    | Nirvana                                  | Music               |
    | O Terço                                  | Music               |
    | Ozzy Osbourne                            | Music               |
    | Page & Plant                             | Music               |
    | Paul D'Ianno                             | Music               |
    | Pearl Jam                                | Music               |
    | Pink Floyd                               | Music               |
    | The Police                               | Music               |
    | The Posies                               | Music               |
    | Queen                                    | Music               |
    | R.E.M.                                   | Music               |
    | Raul Seixas                              | Music               |
    | Red Hot Chili Peppers                    | Music               |
    | The Rolling Stones                       | Music               |
    | Rush                                     | Music               |
    | Santana                                  | Music               |
    | Scorpions                                | Music               |
    | Skank                                    | Music               |
    | Soundgarden                              | Music               |
    | Stone Temple Pilots                      | Music               |
    | Terry Bozzio, Tony Levin & Steve Stevens | Music               |
    | U2                                       | Music               |
    | Van Halen                                | Music               |
    | Velvet Revolver                          | Music               |
    | The Who                                  | Music               |
    | Alice In Chains                          | 90’s Music          |
    | Deep Purple                              | 90’s Music          |
    | Dread Zeppelin                           | 90’s Music          |
    | Soundgarden                              | 90’s Music          |
    | The Cult                                 | 90’s Music          |
    | Guns N' Roses                            | 90’s Music          |
    | Nirvana                                  | 90’s Music          |
    | Pearl Jam                                | 90’s Music          |
    | Queen                                    | 90’s Music          |
    | Santana                                  | 90’s Music          |
    | U2                                       | 90’s Music          |
    | Van Halen                                | 90’s Music          |
    | Iron Maiden                              | 90’s Music          |
    | Stone Temple Pilots                      | 90’s Music          |
    | Jamiroquai                               | 90’s Music          |
    | Aerosmith                                | 90’s Music          |
    | The Rolling Stones                       | 90’s Music          |
    | Accept                                   | 90’s Music          |
    | Alanis Morissette                        | 90’s Music          |
    | Def Leppard                              | 90’s Music          |
    | Faith No More                            | 90’s Music          |
    | Ozzy Osbourne                            | 90’s Music          |
    | Kiss                                     | 90’s Music          |
    | The Police                               | 90’s Music          |
    | R.E.M.                                   | 90’s Music          |
    | Lenny Kravitz                            | 90’s Music          |
    | Skank                                    | 90’s Music          |
    | Foo Fighters                             | 90’s Music          |
    | Led Zeppelin                             | 90’s Music          |
    | Rush                                     | 90’s Music          |
    | Terry Bozzio, Tony Levin & Steve Stevens | 90’s Music          |
    | Page & Plant                             | 90’s Music          |
    | Joe Satriani                             | 90’s Music          |
    | Red Hot Chili Peppers                    | 90’s Music          |
    | Alice In Chains                          | Grunge              |
    | Pearl Jam                                | Grunge              |
    | Soundgarden                              | Grunge              |
    | Stone Temple Pilots                      | Grunge              |
    | Nirvana                                  | Grunge              |
    | AC/DC                                    | Heavy Metal Classic |
    | Accept                                   | Heavy Metal Classic |
    | Ozzy Osbourne                            | Heavy Metal Classic |
    | Scorpions                                | Heavy Metal Classic |

    You will notice that the Relational version is sequential, while the SQL
    version is nested, five levels deep.  The SQL version could be made more
    sequential by using temporary tables or common table expressions (CTEs),
    depending on the SQL engine.  However, SQL still requires you to do a
    projection in every SQL query, so it is never going to be as succinct.
    Furthermore, if you are using tools such as SQLAlchemy, you are either
    forced to write plain SQL, hope that the tool supports whatever mechanism
    the database uses to create temporary tables, or use the nested
    version.

*** Adding Division
    To make the previous query more interesting, the selected playlists must now
    contain metal and heavy metal in addition to rock, and we also want to
    display the genres on the playlist. All of the same joins are made,
    but there are two tables derived from the genre table; one to join on and
    the other to divide with.  After doing all of the joins, the resulting table
    is divided by a projected genre table. The resulting table is joined with
    the table that was divided, getting back those columns that the division
    removed.  The genre table is also joined on to get the genre names.  We then
    project the columns we want.

    #+BEGIN_SRC python :noweb yes :exports code
<<setup>>
artist_rn = artist.rename({"Name": "artist_name"})
track_rn = track.projection("TrackId", "AlbumId", "GenreId")
genre_p = genre.projection("GenreId")
genre_div = genre.selection("Name == 'Metal' or Name == 'Heavy Metal' or Name == 'Rock'").projection("GenreId")
playlist_rn = playlist.rename({"Name": "playlist_name"})
album_artist = artist_rn.join(album).projection("artist_name", "AlbumId") # join on AristId
a_a_track = album_artist.join(track_rn).projection("TrackId", "GenreId", "artist_name") # join on AlbumId
a_a_t_g = a_a_track.join(genre_p).projection("TrackId", "artist_name", "GenreId") # join on GenreId
a_a_t_g_pt = a_a_t_g.join(playlist_track) # join on TrackId, columns: "TrackId", "artist_name", "GenreId", "PlaylistId"
a_a_t_g_pt_p = a_a_t_g_pt.join(playlist_rn) # join on PlaylistId, columns: "TrackId", "artist_name", "GenreId", "PlaylistId", "playlist_name"
quot = a_a_t_g_pt_p.projection("GenreId", "PlaylistId").division(genre_div) # resulting columns: "PlaylistId"
a_a_t_g_pt_p_q = a_a_t_g_pt_p.join(quot) # join on PlaylistId, columns: "TrackId", "artist_name", "GenreId", "PlaylistId", "playlist_name"
result = a_a_t_g_pt_p_q.join(genre).projection("artist_name", "playlist_name", "Name") # join on GenreId, "Name' is genre Name
return str(len(RelationOrg(result)))
    #+END_SRC

    #+RESULTS:
    : 232

    Expanding the division to its relational algebra definition results in:
    #+BEGIN_SRC python :noweb yes :exports code
<<setup>>
artist_rn = artist.rename({"Name": "artist_name"})
track_rn = track.projection("TrackId", "AlbumId", "GenreId")
genre_p = genre.projection("GenreId")
genre_div = genre.selection("Name == 'Metal' or Name == 'Heavy Metal' or Name == 'Rock'").projection("GenreId")
playlist_rn = playlist.rename({"Name": "playlist_name"})
album_artist = artist_rn.join(album).projection("artist_name", "AlbumId") # join on AristId
a_a_track = album_artist.join(track_rn).projection("TrackId", "GenreId", "artist_name") # join on AlbumId
a_a_t_g = a_a_track.join(genre_p).projection("TrackId", "artist_name", "GenreId") # join on GenreId
a_a_t_g_pt = a_a_t_g.join(playlist_track) # join on TrackId, columns: "TrackId", "artist_name", "GenreId", "PlaylistId"
a_a_t_g_pt_p = a_a_t_g_pt.join(playlist_rn) # join on PlaylistId, columns: "TrackId", "artist_name", "GenreId", "PlaylistId", "playlist_name"
dividend = a_a_t_g_pt_p.projection("GenreId", "PlaylistId")
dividend_p = dividend.projection("PlaylistId")
V = dividend_p.product(genre_div).difference(dividend).projection("PlaylistId")
quot = dividend_p.difference(V)
a_a_t_g_pt_p_q = a_a_t_g_pt_p.join(quot) # join on PlaylistId, columns: "TrackId", "artist_name", "GenreId", "PlaylistId", "playlist_name"
result = a_a_t_g_pt_p_q.join(genre).projection("artist_name", "playlist_name", "Name") # join on GenreId, "Name' is genre Name
return str(len(RelationOrg(result)))
    #+END_SRC

    #+RESULTS:
    : 232

*** With Correlated Subqueries
    SQL's CTE system is used to create three temporary tables; the table
    containing the result of joining multiple tables, a table to divide by, and
    the division.  A temporary table is required for the ~a_a_t_g_pt_p~ table
    (the table to be divided) because it is referenced twice.  The other tables
    could be in-lined.  Executing this query took almost 23 seconds!

    #+NAME: complex-query-cor-sq
    #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports code
WITH a_a_t_g_pt_p AS
(SELECT artist_name, a_a_t_g_pt.GenreId, Playlist.Name AS playlist_name, Playlist.PlaylistId, a_a_t_g_pt.TrackId
FROM Playlist JOIN
  (SELECT a_a_t_g.GenreId, PlaylistId, PlaylistTrack.TrackId, artist_name
  FROM PlaylistTrack JOIN
    (SELECT a_a_track.TrackId, artist_name, Genre.GenreId
    FROM Genre JOIN
      (SELECT Track.TrackId, Track.GenreId, artist_name
      FROM Track JOIN
        (SELECT Artist.Name AS artist_name, AlbumId
        FROM Artist JOIN Album
        USING (ArtistId)) AS album_artist
      USING (AlbumId)) AS a_a_track
    USING (GenreId)) AS a_a_t_g
  USING (TrackId)) AS a_a_t_g_pt
USING (PlaylistId)),

divisor AS
(SELECT GenreId FROM Genre
WHERE Name = 'Rock' OR Name = 'Metal' OR Name = 'Heavy Metal'),

quot AS
(SELECT PlaylistId
FROM a_a_t_g_pt_p AS Quotient
WHERE NOT EXISTS
  (SELECT divisor.GenreId
  FROM divisor
  WHERE NOT EXISTS
    (SELECT dividend.GenreId
    FROM a_a_t_g_pt_p AS dividend
    WHERE Quotient.PlaylistId = dividend.PlaylistId
	AND divisor.GenreId = dividend.GenreId)))

SELECT COUNT(*) FROM (
SELECT DISTINCT artist_name, playlist_name, Genre.Name
FROM Genre JOIN
  (SELECT quot.PlaylistId, TrackId, artist_name, GenreId, playlist_name
  FROM a_a_t_g_pt_p JOIN quot
  USING (PlaylistId)) AS a_a_t_g_pt_p_q
USING (GenreId));
    #+END_SRC

    #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports results :noweb yes
EXPLAIN QUERY PLAN
<<complex-query-cor-sq>>
    #+END_SRC

    #+CAPTION: Query Plan
    | SCAN TABLE PlaylistTrack                                                         |
    | SEARCH TABLE Track USING INTEGER PRIMARY KEY (rowid=?)                           |
    | SEARCH TABLE Playlist USING INTEGER PRIMARY KEY (rowid=?)                        |
    | EXECUTE CORRELATED SCALAR SUBQUERY 2                                             |
    | SCAN TABLE Genre                                                                 |
    | EXECUTE CORRELATED SCALAR SUBQUERY 3                                             |
    | SEARCH TABLE Genre USING COVERING INDEX IPK_Genre (GenreId=? AND rowid=?)        |
    | SEARCH TABLE Playlist USING INTEGER PRIMARY KEY (rowid=?)                        |
    | SEARCH TABLE PlaylistTrack USING COVERING INDEX IPK_PlaylistTrack (PlaylistId=?) |
    | SEARCH TABLE Track USING INTEGER PRIMARY KEY (rowid=?)                           |
    | SEARCH TABLE Album USING INTEGER PRIMARY KEY (rowid=?)                           |
    | SEARCH TABLE Artist USING INTEGER PRIMARY KEY (rowid=?)                          |
    | SEARCH TABLE Playlist USING INTEGER PRIMARY KEY (rowid=?)                        |
    | SEARCH TABLE Genre USING COVERING INDEX IPK_Genre (GenreId=? AND rowid=?)        |
    | SEARCH TABLE Genre USING INTEGER PRIMARY KEY (rowid=?)                           |
    | SEARCH TABLE Album USING INTEGER PRIMARY KEY (rowid=?)                           |
    | SEARCH TABLE Artist USING INTEGER PRIMARY KEY (rowid=?)                          |
    | SEARCH TABLE PlaylistTrack USING COVERING INDEX IPK_PlaylistTrack (PlaylistId=?) |
    | SEARCH TABLE Track USING INTEGER PRIMARY KEY (rowid=?)                           |
    | SEARCH TABLE Genre USING COVERING INDEX IPK_Genre (GenreId=? AND rowid=?)        |
    | SEARCH TABLE Album USING INTEGER PRIMARY KEY (rowid=?)                           |
    | SEARCH TABLE Artist USING INTEGER PRIMARY KEY (rowid=?)                          |
    | USE TEMP B-TREE FOR DISTINCT                                                     |
    | SCAN SUBQUERY 1                                                                  |

    #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports results :noweb yes
.timer on
<<complex-query-cor-sq>>
    #+END_SRC

    #+CAPTION: Result and Run Time
    |                                               232 |
    | Run Time: real 23.081 user 23.022000 sys 0.003000 |

*** With the Relation Algebra Definition
    The only difference between this version and the last is how division is
    executed, and here I did not remove the division from the main query. This
    query took just 0.06 seconds!
    #+NAME: complex-query-ra
    #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports code
WITH a_a_t_g_pt_p AS
(SELECT artist_name, a_a_t_g_pt.GenreId, Playlist.Name AS playlist_name, Playlist.PlaylistId, a_a_t_g_pt.TrackId
FROM Playlist JOIN
  (SELECT a_a_t_g.GenreId, PlaylistId, PlaylistTrack.TrackId, artist_name
  FROM PlaylistTrack JOIN
    (SELECT a_a_track.TrackId, artist_name, Genre.GenreId
    FROM Genre JOIN
      (SELECT Track.TrackId, Track.GenreId, artist_name
      FROM Track JOIN
        (SELECT Artist.Name AS artist_name, AlbumId
        FROM Artist JOIN Album
        USING (ArtistId)) AS album_artist
      USING (AlbumId)) AS a_a_track
    USING (GenreId)) AS a_a_t_g
  USING (TrackId)) AS a_a_t_g_pt
USING (PlaylistId)),

divisor AS
(SELECT GenreId FROM Genre
WHERE Name = 'Rock' OR Name = 'Metal' OR Name = 'Heavy Metal')

SELECT COUNT(*) FROM (
SELECT DISTINCT artist_name, playlist_name, Genre.Name
FROM Genre JOIN
  (SELECT quot.PlaylistId, TrackId, artist_name, GenreId, playlist_name
  FROM a_a_t_g_pt_p JOIN
  -- quot
    (SELECT PlaylistId
    FROM a_a_t_g_pt_p
    EXCEPT
    SELECT PlaylistId FROM
      (SELECT PlaylistId, divisor.GenreId
      FROM a_a_t_g_pt_p, divisor
      EXCEPT
      SELECT PlaylistId, GenreId FROM a_a_t_g_pt_p)) AS quot
  -- end quot
  USING (PlaylistId)) AS a_a_t_g_pt_p_q
USING (GenreId));
    #+END_SRC

    #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports results :noweb yes :results table
EXPLAIN QUERY PLAN
<<complex-query-ra>>
    #+END_SRC    

    #+CAPTION: Query Plan
    | SCAN TABLE PlaylistTrack                                                  |
    | SEARCH TABLE Playlist USING INTEGER PRIMARY KEY (rowid=?)                 |
    | SEARCH TABLE Track USING INTEGER PRIMARY KEY (rowid=?)                    |
    | SEARCH TABLE Genre USING COVERING INDEX IPK_Genre (GenreId=? AND rowid=?) |
    | SEARCH TABLE Album USING INTEGER PRIMARY KEY (rowid=?)                    |
    | SEARCH TABLE Artist USING INTEGER PRIMARY KEY (rowid=?)                   |
    | SCAN TABLE PlaylistTrack                                                  |
    | SEARCH TABLE Playlist USING INTEGER PRIMARY KEY (rowid=?)                 |
    | SEARCH TABLE Track USING INTEGER PRIMARY KEY (rowid=?)                    |
    | SEARCH TABLE Genre USING COVERING INDEX IPK_Genre (GenreId=? AND rowid=?) |
    | SEARCH TABLE Album USING INTEGER PRIMARY KEY (rowid=?)                    |
    | SEARCH TABLE Artist USING INTEGER PRIMARY KEY (rowid=?)                   |
    | SCAN TABLE Genre                                                          |
    | SCAN TABLE PlaylistTrack                                                  |
    | SEARCH TABLE Playlist USING INTEGER PRIMARY KEY (rowid=?)                 |
    | SEARCH TABLE Track USING INTEGER PRIMARY KEY (rowid=?)                    |
    | SEARCH TABLE Genre USING COVERING INDEX IPK_Genre (GenreId=? AND rowid=?) |
    | SEARCH TABLE Album USING INTEGER PRIMARY KEY (rowid=?)                    |
    | SEARCH TABLE Artist USING INTEGER PRIMARY KEY (rowid=?)                   |
    | COMPOUND SUBQUERIES 6 AND 7 USING TEMP B-TREE (EXCEPT)                    |
    | SCAN SUBQUERY 5                                                           |
    | COMPOUND SUBQUERIES 3 AND 4 USING TEMP B-TREE (EXCEPT)                    |
    | SCAN TABLE PlaylistTrack                                                  |
    | SEARCH TABLE Track USING INTEGER PRIMARY KEY (rowid=?)                    |
    | SEARCH TABLE Genre USING COVERING INDEX IPK_Genre (GenreId=? AND rowid=?) |
    | SEARCH TABLE Genre USING INTEGER PRIMARY KEY (rowid=?)                    |
    | SEARCH TABLE Playlist USING INTEGER PRIMARY KEY (rowid=?)                 |
    | SEARCH TABLE Album USING INTEGER PRIMARY KEY (rowid=?)                    |
    | SEARCH TABLE Artist USING INTEGER PRIMARY KEY (rowid=?)                   |
    | SEARCH SUBQUERY 2 AS quot USING AUTOMATIC COVERING INDEX (PlaylistId=?)   |
    | USE TEMP B-TREE FOR DISTINCT                                              |
    | SCAN SUBQUERY 1                                                           |

    #+BEGIN_SRC sqlite :db sql-relational-algebra/chinook/Chinook_Sqlite.sqlite :exports results :noweb yes
.timer on
<<complex-query-ra>>
    #+END_SRC

    #+CAPTION: Result and Run Time
    |                                             232 |
    | Run Time: real 0.062 user 0.060000 sys 0.002000 |

** Conclusion
   In the non-trivial queries, Python Relational was invaluable in crafting such
   queries.  The complex Relational query is entirely procedural and relatively
   easy to follow.  I had to make notes about what was being joined on and what
   columns were being returned.  Fortunately, it did not have SQL's nested
   structure.  SQL's nested structure makes it difficult to follow.  The results
   of inner queries are syntactically given aliases after they are referenced,
   requiring you to jump around the code a lot and keep track of what nesting
   level you are at in order to make procedural sense of what is happening.
   Unfortunately, nothting like Relational currently exists for relational
   databases. There was a query language developed at IBM, [[https://en.wikipedia.org/wiki/IBM_Business_System_12][IBM BS12]], that had
   such qualities. I think Relational can be useful as a guide in learning to
   query relational databases by practicing creating Relational queries along
   side database queries, understanding complex SQL queries by having the
   Relational version to refer back to, and prototyping new queries through
   sequential development. In database classes, learning relational algebra
   first and playing with it using Relational, before diving into SQL (or at
   least before doing anti-join and division in SQL), should help increase
   understanding.
*** Further Reading
    For going from SQL to Relational, there is a paper by Jan Van den Bussche and
    Stijn Vansummeren, [[http://cs.ulb.ac.be/public/_media/teaching/infoh417/sql2alg_eng.pdf][Translating SQL into the Relational Algebra]].
* converting chinook DSV to a CSV                                  :noexport:
  #+BEGIN_SRC bash
cd sql-relational-algebra/chinook/dsv/
fun(){
    sed -e 's/"/""/g' -e 's/|/","/g' -e 's/^.*$/"\0"/' ${1}.dsv > sql-relational-algebra/chinook/csv/${1}.csv
}
export -f fun
parallel 'fun {/.}' ::: *.dsv
  #+END_SRC

  #+BEGIN_SRC bash
cd /home/devin/programming/sql/movie-dsv/
fun(){
    sed -e 's/"/""/g' -e 's/|/","/g' -e 's/^.*$/"\0"/' ${1}.dsv > /home/devin/programming/sql/movie-csv/${1}.csv
}
export -f fun
parallel 'fun {/.}' ::: *.dsv
  #+END_SRC

  #+BEGIN_SRC bash
cd /home/devin/programming/sql/newcardeal-dsv/
fun(){
    sed -e 's/"/""/g' -e 's/|/","/g' -e 's/^.*$/"\0"/' ${1}.dsv > /home/devin/programming/sql/newcardeal-csv/${1}.csv
}
export -f fun
parallel 'fun {/.}' ::: *.dsv
  #+END_SRC
